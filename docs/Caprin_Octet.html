<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Octet and ITC data analysis of Ty1:RBD interaction</title>
  <meta name="description" content="Analysis of ITC/Octet data associated with the ms: An alpaca nanobody neutralizes SARS-CoV-2 by blocking receptor interaction" />
  <meta name="generator" content="bookdown 0.18 and GitBook 2.6.7" />

  <meta property="og:title" content="Octet and ITC data analysis of Ty1:RBD interaction" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://www.biorxiv.org/content/10.1101/2020.06.02.130161v1" />
  
  <meta property="og:description" content="Analysis of ITC/Octet data associated with the ms: An alpaca nanobody neutralizes SARS-CoV-2 by blocking receptor interaction" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Octet and ITC data analysis of Ty1:RBD interaction" />
  
  <meta name="twitter:description" content="Analysis of ITC/Octet data associated with the ms: An alpaca nanobody neutralizes SARS-CoV-2 by blocking receptor interaction" />
  

<meta name="author" content="[Tim Schulte]" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  


<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />










<script>
/* ========================================================================
 * Bootstrap: transition.js v3.3.7
 * http://getbootstrap.com/javascript/#transitions
 * ========================================================================
 * Copyright 2011-2016 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */


+function ($) {
  'use strict';

  // CSS TRANSITION SUPPORT (Shoutout: http://www.modernizr.com/)
  // ============================================================

  function transitionEnd() {
    var el = document.createElement('bootstrap')

    var transEndEventNames = {
      WebkitTransition : 'webkitTransitionEnd',
      MozTransition    : 'transitionend',
      OTransition      : 'oTransitionEnd otransitionend',
      transition       : 'transitionend'
    }

    for (var name in transEndEventNames) {
      if (el.style[name] !== undefined) {
        return { end: transEndEventNames[name] }
      }
    }

    return false // explicit for ie8 (  ._.)
  }

  // http://blog.alexmaccaw.com/css-transitions
  $.fn.emulateTransitionEnd = function (duration) {
    var called = false
    var $el = this
    $(this).one('bsTransitionEnd', function () { called = true })
    var callback = function () { if (!called) $($el).trigger($.support.transition.end) }
    setTimeout(callback, duration)
    return this
  }

  $(function () {
    $.support.transition = transitionEnd()

    if (!$.support.transition) return

    $.event.special.bsTransitionEnd = {
      bindType: $.support.transition.end,
      delegateType: $.support.transition.end,
      handle: function (e) {
        if ($(e.target).is(this)) return e.handleObj.handler.apply(this, arguments)
      }
    }
  })

}(jQuery);
</script>
<script>
/* ========================================================================
 * Bootstrap: collapse.js v3.3.7
 * http://getbootstrap.com/javascript/#collapse
 * ========================================================================
 * Copyright 2011-2016 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */

/* jshint latedef: false */

+function ($) {
  'use strict';

  // COLLAPSE PUBLIC CLASS DEFINITION
  // ================================

  var Collapse = function (element, options) {
    this.$element      = $(element)
    this.options       = $.extend({}, Collapse.DEFAULTS, options)
    this.$trigger      = $('[data-toggle="collapse"][href="#' + element.id + '"],' +
                           '[data-toggle="collapse"][data-target="#' + element.id + '"]')
    this.transitioning = null

    if (this.options.parent) {
      this.$parent = this.getParent()
    } else {
      this.addAriaAndCollapsedClass(this.$element, this.$trigger)
    }

    if (this.options.toggle) this.toggle()
  }

  Collapse.VERSION  = '3.3.7'

  Collapse.TRANSITION_DURATION = 350

  Collapse.DEFAULTS = {
    toggle: true
  }

  Collapse.prototype.dimension = function () {
    var hasWidth = this.$element.hasClass('width')
    return hasWidth ? 'width' : 'height'
  }

  Collapse.prototype.show = function () {
    if (this.transitioning || this.$element.hasClass('in')) return

    var activesData
    var actives = this.$parent && this.$parent.children('.panel').children('.in, .collapsing')

    if (actives && actives.length) {
      activesData = actives.data('bs.collapse')
      if (activesData && activesData.transitioning) return
    }

    var startEvent = $.Event('show.bs.collapse')
    this.$element.trigger(startEvent)
    if (startEvent.isDefaultPrevented()) return

    if (actives && actives.length) {
      Plugin.call(actives, 'hide')
      activesData || actives.data('bs.collapse', null)
    }

    var dimension = this.dimension()

    this.$element
      .removeClass('collapse')
      .addClass('collapsing')[dimension](0)
      .attr('aria-expanded', true)

    this.$trigger
      .removeClass('collapsed')
      .attr('aria-expanded', true)

    this.transitioning = 1

    var complete = function () {
      this.$element
        .removeClass('collapsing')
        .addClass('collapse in')[dimension]('')
      this.transitioning = 0
      this.$element
        .trigger('shown.bs.collapse')
    }

    if (!$.support.transition) return complete.call(this)

    var scrollSize = $.camelCase(['scroll', dimension].join('-'))

    this.$element
      .one('bsTransitionEnd', $.proxy(complete, this))
      .emulateTransitionEnd(Collapse.TRANSITION_DURATION)[dimension](this.$element[0][scrollSize])
  }

  Collapse.prototype.hide = function () {
    if (this.transitioning || !this.$element.hasClass('in')) return

    var startEvent = $.Event('hide.bs.collapse')
    this.$element.trigger(startEvent)
    if (startEvent.isDefaultPrevented()) return

    var dimension = this.dimension()

    this.$element[dimension](this.$element[dimension]())[0].offsetHeight

    this.$element
      .addClass('collapsing')
      .removeClass('collapse in')
      .attr('aria-expanded', false)

    this.$trigger
      .addClass('collapsed')
      .attr('aria-expanded', false)

    this.transitioning = 1

    var complete = function () {
      this.transitioning = 0
      this.$element
        .removeClass('collapsing')
        .addClass('collapse')
        .trigger('hidden.bs.collapse')
    }

    if (!$.support.transition) return complete.call(this)

    this.$element
      [dimension](0)
      .one('bsTransitionEnd', $.proxy(complete, this))
      .emulateTransitionEnd(Collapse.TRANSITION_DURATION)
  }

  Collapse.prototype.toggle = function () {
    this[this.$element.hasClass('in') ? 'hide' : 'show']()
  }

  Collapse.prototype.getParent = function () {
    return $(this.options.parent)
      .find('[data-toggle="collapse"][data-parent="' + this.options.parent + '"]')
      .each($.proxy(function (i, element) {
        var $element = $(element)
        this.addAriaAndCollapsedClass(getTargetFromTrigger($element), $element)
      }, this))
      .end()
  }

  Collapse.prototype.addAriaAndCollapsedClass = function ($element, $trigger) {
    var isOpen = $element.hasClass('in')

    $element.attr('aria-expanded', isOpen)
    $trigger
      .toggleClass('collapsed', !isOpen)
      .attr('aria-expanded', isOpen)
  }

  function getTargetFromTrigger($trigger) {
    var href
    var target = $trigger.attr('data-target')
      || (href = $trigger.attr('href')) && href.replace(/.*(?=#[^\s]+$)/, '') // strip for ie7

    return $(target)
  }


  // COLLAPSE PLUGIN DEFINITION
  // ==========================

  function Plugin(option) {
    return this.each(function () {
      var $this   = $(this)
      var data    = $this.data('bs.collapse')
      var options = $.extend({}, Collapse.DEFAULTS, $this.data(), typeof option == 'object' && option)

      if (!data && options.toggle && /show|hide/.test(option)) options.toggle = false
      if (!data) $this.data('bs.collapse', (data = new Collapse(this, options)))
      if (typeof option == 'string') data[option]()
    })
  }

  var old = $.fn.collapse

  $.fn.collapse             = Plugin
  $.fn.collapse.Constructor = Collapse


  // COLLAPSE NO CONFLICT
  // ====================

  $.fn.collapse.noConflict = function () {
    $.fn.collapse = old
    return this
  }


  // COLLAPSE DATA-API
  // =================

  $(document).on('click.bs.collapse.data-api', '[data-toggle="collapse"]', function (e) {
    var $this   = $(this)

    if (!$this.attr('data-target')) e.preventDefault()

    var $target = getTargetFromTrigger($this)
    var data    = $target.data('bs.collapse')
    var option  = data ? 'toggle' : $this.data()

    Plugin.call($target, option)
  })

}(jQuery);
</script>
<script>
window.initializeCodeFolding = function(show) {

  // handlers for show-all and hide all
  $("#rmd-show-all-code").click(function() {
    // close the dropdown menu when an option is clicked
    $("#allCodeButton").dropdown("toggle");
    $('div.r-code-collapse').each(function() {
      $(this).collapse('show');
    });
  });
  $("#rmd-hide-all-code").click(function() {
    // close the dropdown menu when an option is clicked
    $("#allCodeButton").dropdown("toggle");
    $('div.r-code-collapse').each(function() {
      $(this).collapse('hide');
    });
  });

  // index for unique code element ids
  var currentIndex = 1;

  // select all R code blocks
  var rCodeBlocks = $('pre.sourceCode, pre.r, pre.python, pre.bash, pre.sql, pre.cpp, pre.stan');
  rCodeBlocks.each(function() {

    // create a collapsable div to wrap the code in
    var div = $('<div class="collapse r-code-collapse"></div>');
    if (show)
      div.addClass('in');
    var id = 'rcode-643E0F36' + currentIndex++;
    div.attr('id', id);
    $(this).before(div);
    $(this).detach().appendTo(div);

    // add a show code button right above
    var showCodeText = $('<span>' + (show ? 'Hide' : 'Code') + '</span>');
    var showCodeButton = $('<button type="button" class="btn btn-default btn-xs code-folding-btn pull-right"></button>');
    showCodeButton.append(showCodeText);
    showCodeButton
        .attr('data-toggle', 'collapse')
        .attr('data-target', '#' + id)
        .attr('aria-expanded', show)
        .attr('aria-controls', id);

    var buttonRow = $('<div class="row"></div>');
    var buttonCol = $('<div class="col-md-12"></div>');

    buttonCol.append(showCodeButton);
    buttonRow.append(buttonCol);

    div.before(buttonRow);

    // update state of button on show/hide
    div.on('hidden.bs.collapse', function () {
      showCodeText.text('Code');
    });
    div.on('show.bs.collapse', function () {
      showCodeText.text('Hide');
    });
  });

}
</script>
<script>
/* ========================================================================
 * Bootstrap: dropdown.js v3.3.7
 * http://getbootstrap.com/javascript/#dropdowns
 * ========================================================================
 * Copyright 2011-2016 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */


+function ($) {
  'use strict';

  // DROPDOWN CLASS DEFINITION
  // =========================

  var backdrop = '.dropdown-backdrop'
  var toggle   = '[data-toggle="dropdown"]'
  var Dropdown = function (element) {
    $(element).on('click.bs.dropdown', this.toggle)
  }

  Dropdown.VERSION = '3.3.7'

  function getParent($this) {
    var selector = $this.attr('data-target')

    if (!selector) {
      selector = $this.attr('href')
      selector = selector && /#[A-Za-z]/.test(selector) && selector.replace(/.*(?=#[^\s]*$)/, '') // strip for ie7
    }

    var $parent = selector && $(selector)

    return $parent && $parent.length ? $parent : $this.parent()
  }

  function clearMenus(e) {
    if (e && e.which === 3) return
    $(backdrop).remove()
    $(toggle).each(function () {
      var $this         = $(this)
      var $parent       = getParent($this)
      var relatedTarget = { relatedTarget: this }

      if (!$parent.hasClass('open')) return

      if (e && e.type == 'click' && /input|textarea/i.test(e.target.tagName) && $.contains($parent[0], e.target)) return

      $parent.trigger(e = $.Event('hide.bs.dropdown', relatedTarget))

      if (e.isDefaultPrevented()) return

      $this.attr('aria-expanded', 'false')
      $parent.removeClass('open').trigger($.Event('hidden.bs.dropdown', relatedTarget))
    })
  }

  Dropdown.prototype.toggle = function (e) {
    var $this = $(this)

    if ($this.is('.disabled, :disabled')) return

    var $parent  = getParent($this)
    var isActive = $parent.hasClass('open')

    clearMenus()

    if (!isActive) {
      if ('ontouchstart' in document.documentElement && !$parent.closest('.navbar-nav').length) {
        // if mobile we use a backdrop because click events don't delegate
        $(document.createElement('div'))
          .addClass('dropdown-backdrop')
          .insertAfter($(this))
          .on('click', clearMenus)
      }

      var relatedTarget = { relatedTarget: this }
      $parent.trigger(e = $.Event('show.bs.dropdown', relatedTarget))

      if (e.isDefaultPrevented()) return

      $this
        .trigger('focus')
        .attr('aria-expanded', 'true')

      $parent
        .toggleClass('open')
        .trigger($.Event('shown.bs.dropdown', relatedTarget))
    }

    return false
  }

  Dropdown.prototype.keydown = function (e) {
    if (!/(38|40|27|32)/.test(e.which) || /input|textarea/i.test(e.target.tagName)) return

    var $this = $(this)

    e.preventDefault()
    e.stopPropagation()

    if ($this.is('.disabled, :disabled')) return

    var $parent  = getParent($this)
    var isActive = $parent.hasClass('open')

    if (!isActive && e.which != 27 || isActive && e.which == 27) {
      if (e.which == 27) $parent.find(toggle).trigger('focus')
      return $this.trigger('click')
    }

    var desc = ' li:not(.disabled):visible a'
    var $items = $parent.find('.dropdown-menu' + desc)

    if (!$items.length) return

    var index = $items.index(e.target)

    if (e.which == 38 && index > 0)                 index--         // up
    if (e.which == 40 && index < $items.length - 1) index++         // down
    if (!~index)                                    index = 0

    $items.eq(index).trigger('focus')
  }


  // DROPDOWN PLUGIN DEFINITION
  // ==========================

  function Plugin(option) {
    return this.each(function () {
      var $this = $(this)
      var data  = $this.data('bs.dropdown')

      if (!data) $this.data('bs.dropdown', (data = new Dropdown(this)))
      if (typeof option == 'string') data[option].call($this)
    })
  }

  var old = $.fn.dropdown

  $.fn.dropdown             = Plugin
  $.fn.dropdown.Constructor = Dropdown


  // DROPDOWN NO CONFLICT
  // ====================

  $.fn.dropdown.noConflict = function () {
    $.fn.dropdown = old
    return this
  }


  // APPLY TO STANDARD DROPDOWN ELEMENTS
  // ===================================

  $(document)
    .on('click.bs.dropdown.data-api', clearMenus)
    .on('click.bs.dropdown.data-api', '.dropdown form', function (e) { e.stopPropagation() })
    .on('click.bs.dropdown.data-api', toggle, Dropdown.prototype.toggle)
    .on('keydown.bs.dropdown.data-api', toggle, Dropdown.prototype.keydown)
    .on('keydown.bs.dropdown.data-api', '.dropdown-menu', Dropdown.prototype.keydown)

}(jQuery);
</script>
<style type="text/css">
.code-folding-btn {
  margin-bottom: 4px;
}

.row { display: flex; }
.collapse { display: none; }
.in { display:block }
.pull-right > .dropdown-menu {
    right: 0;
    left: auto;
}

.dropdown-menu {
    position: absolute;
    top: 100%;
    left: 0;
    z-index: 1000;
    display: none;
    float: left;
    min-width: 160px;
    padding: 5px 0;
    margin: 2px 0 0;
    font-size: 14px;
    text-align: left;
    list-style: none;
    background-color: #fff;
    -webkit-background-clip: padding-box;
    background-clip: padding-box;
    border: 1px solid #ccc;
    border: 1px solid rgba(0,0,0,.15);
    border-radius: 4px;
    -webkit-box-shadow: 0 6px 12px rgba(0,0,0,.175);
    box-shadow: 0 6px 12px rgba(0,0,0,.175);
}

.open > .dropdown-menu {
    display: block;
    color: #ffffff;
    background-color: #ffffff;
    background-image: none;
    border-color: #92897e;
}

.dropdown-menu > li > a {
  display: block;
  padding: 3px 20px;
  clear: both;
  font-weight: 400;
  line-height: 1.42857143;
  color: #000000;
  white-space: nowrap;
}

.dropdown-menu > li > a:hover,
.dropdown-menu > li > a:focus {
  color: #ffffff;
  text-decoration: none;
  background-color: #e95420;
}

.dropdown-menu > .active > a,
.dropdown-menu > .active > a:hover,
.dropdown-menu > .active > a:focus {
  color: #ffffff;
  text-decoration: none;
  background-color: #e95420;
  outline: 0;
}
.dropdown-menu > .disabled > a,
.dropdown-menu > .disabled > a:hover,
.dropdown-menu > .disabled > a:focus {
  color: #aea79f;
}

.dropdown-menu > .disabled > a:hover,
.dropdown-menu > .disabled > a:focus {
  text-decoration: none;
  cursor: not-allowed;
  background-color: transparent;
  background-image: none;
  filter: progid:DXImageTransform.Microsoft.gradient(enabled = false);
}

.btn {
  display: inline-block;
  margin-bottom: 1;
  font-weight: normal;
  text-align: center;
  white-space: nowrap;
  vertical-align: middle;
  -ms-touch-action: manipulation;
      touch-action: manipulation;
  cursor: pointer;
  background-image: none;
  border: 1px solid transparent;
  padding: 4px 8px;
  font-size: 14px;
  line-height: 1.42857143;
  border-radius: 4px;
  -webkit-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
}

.btn:focus,
.btn:active:focus,
.btn.active:focus,
.btn.focus,
.btn:active.focus,
.btn.active.focus {
  outline: 5px auto -webkit-focus-ring-color;
  outline-offset: -2px;
}
.btn:hover,
.btn:focus,
.btn.focus {
  color: #ffffff;
  text-decoration: none;
}
.btn:active,
.btn.active {
  background-image: none;
  outline: 0;
  box-shadow: inset 0 3px 5px rgba(0, 0, 0, 0.125);
}
.btn.disabled,
.btn[disabled],
fieldset[disabled] .btn {
  cursor: not-allowed;
  filter: alpha(opacity=65);
  opacity: 0.65;
  box-shadow: none;
}
a.btn.disabled,
fieldset[disabled] a.btn {
  pointer-events: none;
}
.btn-default {
  color: #ffffff;
  background-color: #aea79f; #important
  border-color: #aea79f;
}

.btn-default:focus,
.btn-default.focus {
  color: #ffffff;
  background-color: #978e83;
  border-color: #6f675e;
}

.btn-default:hover {
  color: #ffffff;
  background-color: #978e83;
  border-color: #92897e;
}
.btn-default:active,
.btn-default.active,
.btn-group > .btn:not(:first-child):not(:last-child):not(.dropdown-toggle) {
  border-radius: 0;
}
.btn-group > .btn:first-child {
  margin-left: 0;
}
.btn-group > .btn:first-child:not(:last-child):not(.dropdown-toggle) {
  border-top-right-radius: 0;
  border-bottom-right-radius: 0;
}
.btn-group > .btn:last-child:not(:first-child),
.btn-group > .dropdown-toggle:not(:first-child) {
  border-top-left-radius: 0;
  border-bottom-left-radius: 0;
}
.btn-group > .btn-group {
  float: left;
}
.btn-group > .btn-group:not(:first-child):not(:last-child) > .btn {
  border-radius: 0;
}
.btn-group > .btn-group:first-child:not(:last-child) > .btn:last-child,
.btn-group > .btn-group:first-child:not(:last-child) > .dropdown-toggle {
  border-top-right-radius: 0;
  border-bottom-right-radius: 0;
}
.btn-group > .btn-group:last-child:not(:first-child) > .btn:first-child {
  border-top-left-radius: 0;
  border-bottom-left-radius: 0;
}
.btn-group .dropdown-toggle:active,
.btn-group.open .dropdown-toggle {
  outline: 0;
}
.btn-group > .btn + .dropdown-toggle {
  padding-right: 8px;
  padding-left: 8px;
}
.btn-group > .btn-lg + .dropdown-toggle {
  padding-right: 12px;
  padding-left: 12px;
}
.btn-group.open .dropdown-toggle {
  box-shadow: inset 0 3px 5px rgba(0, 0, 0, 0.125);
}
.btn-group.open .dropdown-toggle.btn-link {
  box-shadow: none;
}

</style>
<script>
var str = '<div class="btn-group pull-right" style="position: fixed; right: 50px; top: 10px; z-index: 200"><button type="button" class="btn btn-default btn-xs dropdown-toggle" id="allCodeButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true" data-_extension-text-contrast=""><span>Code</span> <span class="caret"></span></button><ul class="dropdown-menu" style="min-width: 50px;"><li><a id="rmd-show-all-code" href="#">Show All Code</a></li><li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li></ul></div>';
document.write(str);
</script>
<script>
$(document).ready(function () {
  window.initializeCodeFolding("show" === "hide");
});
</script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  { background-color: #f8f8f8; }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Octet data analysis</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path=""><a href="#octet-data-analysis-and-visualization"><i class="fa fa-check"></i><b>1</b> Octet data analysis and visualization</a><ul>
<li class="chapter" data-level="1.1" data-path=""><a href="#data-import"><i class="fa fa-check"></i><b>1.1</b> Data import</a></li>
<li class="chapter" data-level="1.2" data-path=""><a href="#initial-plot-of-the-titration-data-as-a-preview"><i class="fa fa-check"></i><b>1.2</b> Initial plot of the titration data as a preview</a></li>
<li class="chapter" data-level="1.3" data-path=""><a href="#initial-pseudo-equilibrium-plot-to-preview-the-extracted-data"><i class="fa fa-check"></i><b>1.3</b> Initial pseudo-equilibrium plot to preview the extracted data</a></li>
<li class="chapter" data-level="1.4" data-path=""><a href="#raw-data-plots-to-compare-ligands-and-sensor-surfaces"><i class="fa fa-check"></i><b>1.4</b> Raw data plots to compare ligands and sensor surfaces</a></li>
<li class="chapter" data-level="1.5" data-path=""><a href="#analysis-and-plotting-of-sensor-ligand-loads"><i class="fa fa-check"></i><b>1.5</b> Analysis and plotting of sensor ligand loads</a></li>
<li class="chapter" data-level="1.6" data-path=""><a href="#fitting-and-plotting-pseudo-equilibrium-data"><i class="fa fa-check"></i><b>1.6</b> Fitting and plotting pseudo-equilibrium data</a></li>
<li class="chapter" data-level="1.7" data-path=""><a href="#fits-of-the-sensorgrams-using-11-local-fit-as-implemented-in-fortebio-software"><i class="fa fa-check"></i><b>1.7</b> Fits of the sensorgrams using 1:1 local fit as implemented in ForteBio software</a></li>
<li class="chapter" data-level="1.8" data-path=""><a href="#tidying-data-for-evilfit-analysis-and-combined-plots-of-local-11-fits-vs.global-bayesian-11-fits-forte-vs.evilfit"><i class="fa fa-check"></i><b>1.8</b> Tidying data for evilfit analysis and combined plots of local 1:1 fits vs. global bayesian 1:1 fits (Forte vs. Evilfit)</a></li>
<li class="chapter" data-level="1.9" data-path=""><a href="#combining-the-local-fits-with-bayesian-analysis-in-a-single-plot"><i class="fa fa-check"></i><b>1.9</b> Combining the local fits with bayesian analysis in a single plot</a></li>
<li class="chapter" data-level="1.10" data-path=""><a href="#assembling-figures-for-manuscript"><i class="fa fa-check"></i><b>1.10</b> Assembling figures for manuscript</a></li>
<li class="chapter" data-level="1.11" data-path=""><a href="#loooking-at-expected-maximum-responses-bases-on-ligandanalyte-mw-ratios"><i class="fa fa-check"></i><b>1.11</b> Loooking at expected maximum responses bases on ligand/analyte MW ratios</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path=""><a href="#analysis-of-itc-data"><i class="fa fa-check"></i><b>2</b> Analysis of ITC data</a><ul>
<li class="chapter" data-level="2.1" data-path=""><a href="#importing-itc-data"><i class="fa fa-check"></i><b>2.1</b> importing ITC data</a></li>
<li class="chapter" data-level="2.2" data-path=""><a href="#itc-primary-plots"><i class="fa fa-check"></i><b>2.2</b> ITC primary plots</a></li>
<li class="chapter" data-level="2.3" data-path=""><a href="#itc-binding-isotherms-and-thermodynamic-signatures"><i class="fa fa-check"></i><b>2.3</b> ITC binding isotherms and thermodynamic signatures</a></li>
<li class="chapter" data-level="2.4" data-path=""><a href="#itc-raw-data-plots"><i class="fa fa-check"></i><b>2.4</b> ITC raw data plots</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path=""><a href="#references"><i class="fa fa-check"></i><b>3</b> References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Octet and ITC data analysis of Ty1:RBD interaction</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="header">
<h1 class="title">Octet and ITC data analysis of Ty1:RBD interaction</h1>
<p class="author"><em>[Tim Schulte]</em></p>
</div>
<p>Data are associated with the <a href="https://www.biorxiv.org/content/10.1101/2020.06.02.130161v1">manuscript</a> <strong>An alpaca nanobody neutralizes SARS-CoV-2 by blocking receptor interaction</strong> led by my colleague Leo Hanke within the group of Gerry <a href="https://ki.se/en/mtc/gerald-mcinerney-group">mcinerney</a>. The ms just got accepted for publication in <a href="link">Nature Communications</a>. The bookdown document was created based on <a href="https://bookdown.org/yihui/bookdown/">bookdown</a>, and <a href="https://github.com/bblodfon/rtemps">rtemps</a>.</p>
<p>If you find this material useful in your own research or want to re-use some of the code, please cite the main research paper.</p>
<div id="octet-data-analysis-and-visualization" class="section level1">
<h1><span class="header-section-number">1</span> Octet data analysis and visualization</h1>
<div id="data-import" class="section level2">
<h2><span class="header-section-number">1.1</span> Data import</h2>
<p>Octet data were collected as described in the methods section of the <a href="https://www.biorxiv.org/content/10.1101/2020.06.02.130161v1">associated manuscript</a>. Data were pre-processed and analyzed using the ForteBio <a href="https://www.fortebio.com/products/octet-systems-software">software</a>. Raw and processed data were exported and imported into R using the script below. This pipeline was mainly used to tidy the data for plotting and fitting purposes. Final figures as shown in the manuscript were assembled in Adobe Illustrator.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw">library</span>(ggplot2)</a>
<a class="sourceLine" id="cb1-2" data-line-number="2"><span class="kw">library</span>(tidyverse)</a>
<a class="sourceLine" id="cb1-3" data-line-number="3"><span class="kw">library</span>(plyr)</a>
<a class="sourceLine" id="cb1-4" data-line-number="4"><span class="kw">library</span>(tidyr)</a>
<a class="sourceLine" id="cb1-5" data-line-number="5"><span class="kw">library</span>(readr)</a>
<a class="sourceLine" id="cb1-6" data-line-number="6"><span class="kw">library</span>(readxl)</a>
<a class="sourceLine" id="cb1-7" data-line-number="7"><span class="kw">library</span>(knitr)</a>
<a class="sourceLine" id="cb1-8" data-line-number="8"><span class="co">#library(nls)</span></a>
<a class="sourceLine" id="cb1-9" data-line-number="9"><span class="kw">library</span>(nlstools)</a>
<a class="sourceLine" id="cb1-10" data-line-number="10"><span class="kw">library</span>(nlshelper)</a>
<a class="sourceLine" id="cb1-11" data-line-number="11"><span class="kw">library</span>(minpack.lm)</a>
<a class="sourceLine" id="cb1-12" data-line-number="12"><span class="kw">library</span>(broom)</a>
<a class="sourceLine" id="cb1-13" data-line-number="13"><span class="kw">library</span>(nls.multstart)</a>
<a class="sourceLine" id="cb1-14" data-line-number="14"><span class="kw">library</span>(purrr)</a>
<a class="sourceLine" id="cb1-15" data-line-number="15"><span class="co">#library(gnm)</span></a>
<a class="sourceLine" id="cb1-16" data-line-number="16"><span class="co">#library(visreg)</span></a>
<a class="sourceLine" id="cb1-17" data-line-number="17"><span class="co">#library(KRLS)</span></a>
<a class="sourceLine" id="cb1-18" data-line-number="18"><span class="co">#library(glmnet)</span></a>
<a class="sourceLine" id="cb1-19" data-line-number="19"><span class="co">#library(glmnetUtils)</span></a>
<a class="sourceLine" id="cb1-20" data-line-number="20"><span class="kw">library</span>(magrittr)</a>
<a class="sourceLine" id="cb1-21" data-line-number="21"><span class="kw">library</span>(forcats)</a>
<a class="sourceLine" id="cb1-22" data-line-number="22"><span class="kw">library</span>(emmeans)</a>
<a class="sourceLine" id="cb1-23" data-line-number="23"><span class="co">#library(modelr)</span></a>
<a class="sourceLine" id="cb1-24" data-line-number="24"><span class="co">#library(cowplot)</span></a>
<a class="sourceLine" id="cb1-25" data-line-number="25"><span class="co">#library(ggridges)</span></a>
<a class="sourceLine" id="cb1-26" data-line-number="26"><span class="co">#library(ggrepel)</span></a>
<a class="sourceLine" id="cb1-27" data-line-number="27"><span class="co">#library(ggforce)</span></a>
<a class="sourceLine" id="cb1-28" data-line-number="28"><span class="co">#library(fitdistrplus)</span></a>
<a class="sourceLine" id="cb1-29" data-line-number="29"><span class="co">#library(MASS)</span></a>
<a class="sourceLine" id="cb1-30" data-line-number="30"><span class="co">#library(hexbin)</span></a>
<a class="sourceLine" id="cb1-31" data-line-number="31"><span class="co">#library(dMod)</span></a>
<a class="sourceLine" id="cb1-32" data-line-number="32"><span class="co">#library(kimisc)</span></a>
<a class="sourceLine" id="cb1-33" data-line-number="33"><span class="kw">library</span>(ggsci)</a>
<a class="sourceLine" id="cb1-34" data-line-number="34"><span class="kw">library</span>(bookdown)</a>
<a class="sourceLine" id="cb1-35" data-line-number="35"><span class="kw">library</span>(tinytex)</a>
<a class="sourceLine" id="cb1-36" data-line-number="36"><span class="kw">library</span>(kableExtra)</a>
<a class="sourceLine" id="cb1-37" data-line-number="37"><span class="kw">library</span>(DT)</a>
<a class="sourceLine" id="cb1-38" data-line-number="38"><span class="kw">library</span>(xfun)</a>
<a class="sourceLine" id="cb1-39" data-line-number="39"><span class="kw">library</span>(rmatio)</a>
<a class="sourceLine" id="cb1-40" data-line-number="40"><span class="kw">library</span>(reshape2)</a>
<a class="sourceLine" id="cb1-41" data-line-number="41"><span class="kw">library</span>(latticeExtra)</a>
<a class="sourceLine" id="cb1-42" data-line-number="42"><span class="kw">library</span>(viridisLite)</a>
<a class="sourceLine" id="cb1-43" data-line-number="43"><span class="kw">library</span>(reticulate)</a>
<a class="sourceLine" id="cb1-44" data-line-number="44"></a>
<a class="sourceLine" id="cb1-45" data-line-number="45"></a>
<a class="sourceLine" id="cb1-46" data-line-number="46"></a>
<a class="sourceLine" id="cb1-47" data-line-number="47"><span class="co">###from stackoverflow</span></a>
<a class="sourceLine" id="cb1-48" data-line-number="48"><span class="co">#&#39; @title pr_mutate_when</span></a>
<a class="sourceLine" id="cb1-49" data-line-number="49"><span class="co">#&#39; @description mutate a column within a dplyr pype only on a subset of rows</span></a>
<a class="sourceLine" id="cb1-50" data-line-number="50"><span class="co">#&#39;   specified by a condition</span></a>
<a class="sourceLine" id="cb1-51" data-line-number="51"><span class="co">#&#39;   Retrieved from a StackOverflow answer (https://stackoverflow.com/a/34170176/6871135)</span></a>
<a class="sourceLine" id="cb1-52" data-line-number="52"><span class="co">#&#39; @param data a `data.frame` (or `tibble` or `data.table`)</span></a>
<a class="sourceLine" id="cb1-53" data-line-number="53"><span class="co">#&#39; @param ... expression to be evaluated to filter on rows</span></a>
<a class="sourceLine" id="cb1-54" data-line-number="54"><span class="co">#&#39; @return `data frame`</span></a>
<a class="sourceLine" id="cb1-55" data-line-number="55"><span class="co">#&#39; @details DETAILS</span></a>
<a class="sourceLine" id="cb1-56" data-line-number="56"><span class="co">#&#39; @examples</span></a>
<a class="sourceLine" id="cb1-57" data-line-number="57"><span class="co">#&#39; \dontrun{</span></a>
<a class="sourceLine" id="cb1-58" data-line-number="58"><span class="co">#&#39;  library(magrittr)</span></a>
<a class="sourceLine" id="cb1-59" data-line-number="59"><span class="co">#&#39;  mtcars %&gt;% mutate_when(</span></a>
<a class="sourceLine" id="cb1-60" data-line-number="60"><span class="co">#&#39;             mpg &gt; 22,    list(cyl = 100),</span></a>
<a class="sourceLine" id="cb1-61" data-line-number="61"><span class="co">#&#39;             disp == 160, list(cyl = 200))</span></a>
<a class="sourceLine" id="cb1-62" data-line-number="62"><span class="co">#&#39;</span></a>
<a class="sourceLine" id="cb1-63" data-line-number="63"><span class="co">#&#39; }</span></a>
<a class="sourceLine" id="cb1-64" data-line-number="64"><span class="co">#&#39; @rdname pr_mutate_when</span></a>
<a class="sourceLine" id="cb1-65" data-line-number="65"><span class="co">#&#39; @export</span></a>
<a class="sourceLine" id="cb1-66" data-line-number="66"><span class="co">#&#39; @author Kevin Ushey</span></a>
<a class="sourceLine" id="cb1-67" data-line-number="67"></a>
<a class="sourceLine" id="cb1-68" data-line-number="68">pr_mutate_when &lt;-<span class="st"> </span><span class="cf">function</span>(data, ...) {</a>
<a class="sourceLine" id="cb1-69" data-line-number="69">  dots &lt;-<span class="st"> </span><span class="kw">eval</span>(<span class="kw">substitute</span>(<span class="kw">alist</span>(...)))</a>
<a class="sourceLine" id="cb1-70" data-line-number="70">  <span class="cf">for</span> (i <span class="cf">in</span> <span class="kw">seq</span>(<span class="dv">1</span>, <span class="kw">length</span>(dots), <span class="dt">by =</span> <span class="dv">2</span>)) {</a>
<a class="sourceLine" id="cb1-71" data-line-number="71">    condition &lt;-<span class="st"> </span><span class="kw">eval</span>(dots[[i]], <span class="dt">envir =</span> data)</a>
<a class="sourceLine" id="cb1-72" data-line-number="72">    mutations &lt;-<span class="st"> </span><span class="kw">eval</span>(dots[[i <span class="op">+</span><span class="st"> </span><span class="dv">1</span>]], <span class="dt">envir =</span> data[condition, , <span class="dt">drop =</span> <span class="ot">FALSE</span>])</a>
<a class="sourceLine" id="cb1-73" data-line-number="73">    data[condition, <span class="kw">names</span>(mutations)] &lt;-<span class="st"> </span>mutations</a>
<a class="sourceLine" id="cb1-74" data-line-number="74">  }</a>
<a class="sourceLine" id="cb1-75" data-line-number="75">  data</a>
<a class="sourceLine" id="cb1-76" data-line-number="76">}</a></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="co">##</span></a>
<a class="sourceLine" id="cb2-2" data-line-number="2"><span class="co">###</span></a>
<a class="sourceLine" id="cb2-3" data-line-number="3">data_overview_tib &lt;-<span class="st"> </span><span class="kw">tribble</span>(<span class="op">~</span>rec, <span class="op">~</span>exprun_digit, <span class="op">~</span>meas_type, <span class="op">~</span>meas_driftcorr, <span class="op">~</span>meas_salt, <span class="op">~</span>filterme,</a>
<a class="sourceLine" id="cb2-4" data-line-number="4">                                   <span class="st">&quot;BOTH&quot;</span>, <span class="dv">501</span>, <span class="st">&quot;COMP&quot;</span>, <span class="st">&quot;ref&quot;</span>, <span class="st">&quot;norm&quot;</span>, <span class="st">&quot;11&quot;</span>,</a>
<a class="sourceLine" id="cb2-5" data-line-number="5">                                    <span class="st">&quot;nbTy1&quot;</span>, <span class="dv">901</span>, <span class="st">&quot;TIT&quot;</span>, <span class="st">&quot;ref&quot;</span>, <span class="st">&quot;norm&quot;</span>, <span class="st">&quot;11&quot;</span>,</a>
<a class="sourceLine" id="cb2-6" data-line-number="6">                                    <span class="st">&quot;nbTy1&quot;</span>, <span class="dv">1001</span>, <span class="st">&quot;TIT&quot;</span>, <span class="st">&quot;ref&quot;</span>, <span class="st">&quot;high&quot;</span>, <span class="st">&quot;11&quot;</span> )</a>
<a class="sourceLine" id="cb2-7" data-line-number="7"></a>
<a class="sourceLine" id="cb2-8" data-line-number="8"><span class="co">### find all relevant files using a filename pattern.</span></a>
<a class="sourceLine" id="cb2-9" data-line-number="9">data_dir_all &lt;-<span class="st"> </span><span class="kw">enframe</span>(<span class="kw">list.dirs</span>(<span class="dt">path =</span> <span class="st">&quot;./data_octet&quot;</span>, <span class="dt">full.names =</span> <span class="ot">TRUE</span>, <span class="dt">recursive=</span><span class="ot">FALSE</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">filterme =</span> <span class="kw">str_detect</span>(value,<span class="st">&quot;RBD&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">subset</span>(filterme <span class="op">==</span><span class="st"> &quot;TRUE&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>filterme,<span class="op">-</span>name) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">dirname=</span><span class="kw">paste</span>(value,<span class="st">&quot;/&quot;</span>,<span class="dt">sep=</span><span class="st">&quot;&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">fileslist =</span> purrr<span class="op">::</span><span class="kw">map</span>(dirname, <span class="op">~</span><span class="kw">list.files</span>(<span class="dt">path =</span> ., <span class="dt">pattern =</span> <span class="st">&quot;*.xls&quot;</span>,<span class="dt">recursive =</span> <span class="ot">FALSE</span>))) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">unnest</span>() <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">sample_temp=</span><span class="kw">str_extract</span>(value,<span class="dt">pattern=</span><span class="st">&quot;[:digit:]{6}xSAXxNBxRBDHisxCOMPx[:digit:]{4}|[:digit:]{6}xSAXxNB1AxRBDHisxTITx[:digit:]{4}&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">sample=</span><span class="kw">str_extract</span>(sample_temp,<span class="dt">pattern=</span><span class="st">&quot;SAXxNBxRBDHisxCOMPx[:digit:]{4}|[:digit:]{6}xSAXxNB1AxRBDHisxTITx[:digit:]{4}&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">expnumber =</span> <span class="kw">str_extract</span>(sample,<span class="dt">pattern=</span><span class="st">&quot;x[:digit:]{4}&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(., <span class="dt">sample_test =</span> <span class="kw">str_extract</span>(sample, <span class="st">&quot;NB1A|NB&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(., <span class="dt">rec =</span> <span class="kw">case_when</span>(sample_test <span class="op">==</span><span class="st"> &quot;NB&quot;</span> <span class="op">~</span><span class="st"> &quot;BOTH&quot;</span>,sample_test <span class="op">==</span><span class="st"> &quot;NB1A&quot;</span> <span class="op">~</span><span class="st"> &quot;nbTy1&quot;</span>, <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> &quot;STH&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(., <span class="dt">exprun =</span> <span class="kw">str_extract</span>(expnumber, <span class="dt">pattern =</span> <span class="st">&quot;[:digit:]{4}&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(., <span class="dt">exprun_digit =</span> <span class="kw">as.numeric</span>(exprun))  <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>sample_temp, <span class="op">-</span>exprun) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">left_join</span>(., data_overview_tib)</a>
<a class="sourceLine" id="cb2-10" data-line-number="10"><span class="co">#</span></a>
<a class="sourceLine" id="cb2-11" data-line-number="11"><span class="co">### filter sensor titration data</span></a>
<a class="sourceLine" id="cb2-12" data-line-number="12">data_dir_sensors &lt;-<span class="st"> </span>data_dir_all <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">fileslist_filtered =</span> <span class="kw">str_detect</span>(fileslist,<span class="dt">pattern=</span><span class="st">&quot;^[:alnum:][:digit:]{1,2}.xls&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">subset</span>(fileslist_filtered <span class="op">==</span><span class="st"> &quot;TRUE&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">unite</span>(.,<span class="st">&quot;readme&quot;</span>, <span class="kw">c</span>(<span class="st">&quot;dirname&quot;</span>, <span class="st">&quot;fileslist&quot;</span>),<span class="dt">sep=</span><span class="st">&quot;&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>fileslist_filtered,<span class="op">-</span>value, <span class="op">-</span>expnumber, <span class="op">-</span>sample_test) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">sensorid=</span><span class="kw">str_extract</span>(readme,<span class="dt">pattern=</span><span class="st">&quot;[A-H][:digit:]{1,2}.xls&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">sensorid=</span><span class="kw">str_extract</span>(sensorid,<span class="dt">pattern=</span><span class="st">&quot;[A-H][:digit:]{1,2}&quot;</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb2-13" data-line-number="13"><span class="kw">mutate</span>(<span class="dt">sensor=</span><span class="kw">str_extract</span>(sensorid,<span class="dt">pattern=</span><span class="st">&quot;[A-H]&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">unite</span>(., <span class="dt">col =</span> <span class="st">&quot;sampleid&quot;</span>, <span class="kw">c</span>(<span class="st">&quot;sample&quot;</span>, <span class="st">&quot;sensorid&quot;</span>), <span class="dt">sep =</span> <span class="st">&quot;_&quot;</span>, <span class="dt">remove =</span> <span class="ot">FALSE</span>) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(., readme, sampleid, rec, exprun_digit, meas_type, sensorid, sensor)</a>
<a class="sourceLine" id="cb2-14" data-line-number="14"></a>
<a class="sourceLine" id="cb2-15" data-line-number="15">report_colname_list &lt;-<span class="st"> </span><span class="kw">tribble</span>(<span class="op">~</span>report_type, <span class="op">~</span>repres_colnames, <span class="op">~</span>repres_range, <span class="op">~</span>repres_sheet, <span class="op">~</span>senstray_colnames, <span class="op">~</span>senstray_range, <span class="op">~</span>senstray_sheet,</a>
<a class="sourceLine" id="cb2-16" data-line-number="16">                                <span class="st">&quot;11&quot;</span>, <span class="kw">c</span>(<span class="st">&quot;selected&quot;</span>, <span class="st">&quot;include&quot;</span>, <span class="st">&quot;index&quot;</span>, <span class="st">&quot;color&quot;</span>, <span class="st">&quot;sensor_loc&quot;</span>, <span class="st">&quot;sensor_type&quot;</span>, <span class="st">&quot;sensor_info&quot;</span>, <span class="st">&quot;replicate_group&quot;</span>, <span class="st">&quot;baseline_loc&quot;</span>, <span class="st">&quot;assoc_sample&quot;</span>, <span class="st">&quot;sample_id&quot;</span>, <span class="st">&quot;diss_loc&quot;</span>, <span class="st">&quot;load_well&quot;</span>, <span class="st">&quot;load_sample&quot;</span>, <span class="st">&quot;cycle&quot;</span>, <span class="st">&quot;conc&quot;</span>, <span class="st">&quot;response&quot;</span>, <span class="st">&quot;KD_M&quot;</span>, <span class="st">&quot;kon_Ms_inv&quot;</span>,<span class="st">&quot;km_err&quot;</span>,<span class="st">&quot;kdis_s_inv&quot;</span>,<span class="st">&quot;kdir_err&quot;</span>,<span class="st">&quot;Rmax&quot;</span>,<span class="st">&quot;kobs_s_inv&quot;</span>,<span class="st">&quot;kobs_err&quot;</span>,<span class="st">&quot;Req&quot;</span>,<span class="st">&quot;Req_err&quot;</span>,<span class="st">&quot;Req_Rmax_fr&quot;</span>,<span class="st">&quot;ass_X2&quot;</span>,<span class="st">&quot;ass_R2&quot;</span>,<span class="st">&quot;SSG_kd&quot;</span>,<span class="st">&quot;SSG_Rmax&quot;</span>,<span class="st">&quot;SSG_R2&quot;</span>), <span class="st">&quot;A2:AG9&quot;</span>, <span class="st">&quot;Result Table&quot;</span>, <span class="kw">c</span>(<span class="st">&quot;step_id&quot;</span>, <span class="st">&quot;step_name&quot;</span>, <span class="st">&quot;step_type&quot;</span>, <span class="st">&quot;step_time&quot;</span>), <span class="st">&quot;A22:D35&quot;</span>, <span class="st">&quot;Sensor Tray&quot;</span>,</a>
<a class="sourceLine" id="cb2-17" data-line-number="17">                               <span class="st">&quot;21&quot;</span>, <span class="kw">c</span>(<span class="st">&quot;selected&quot;</span>, <span class="st">&quot;include&quot;</span>, <span class="st">&quot;index&quot;</span>, <span class="st">&quot;color&quot;</span>, <span class="st">&quot;sensor_loc&quot;</span>, <span class="st">&quot;sensor_type&quot;</span>, <span class="st">&quot;sensor_info&quot;</span>, <span class="st">&quot;replicate_group&quot;</span>, <span class="st">&quot;baseline_loc&quot;</span>, <span class="st">&quot;assoc_sample&quot;</span>, <span class="st">&quot;sample_id&quot;</span>, <span class="st">&quot;diss_loc&quot;</span>, <span class="st">&quot;load_well&quot;</span>, <span class="st">&quot;load_sample&quot;</span>, <span class="st">&quot;cycle&quot;</span>, <span class="st">&quot;conc&quot;</span>, <span class="st">&quot;response&quot;</span>, <span class="st">&quot;KD2_M&quot;</span>, <span class="st">&quot;KD_err&quot;</span>,<span class="st">&quot;KD2_err&quot;</span>,<span class="st">&quot;kon_Ms_inv&quot;</span>,<span class="st">&quot;km&quot;</span>,<span class="st">&quot;kon2&quot;</span>,<span class="st">&quot;kon_err&quot;</span>,<span class="st">&quot;km_err&quot;</span>,<span class="st">&quot;kon2_err&quot;</span>,<span class="st">&quot;kdis_s_inv&quot;</span>,<span class="st">&quot;kdis2&quot;</span>,<span class="st">&quot;kdis_err&quot;</span>,<span class="st">&quot;kdis2_err&quot;</span>,<span class="st">&quot;Rmax&quot;</span>,<span class="st">&quot;Rmax2&quot;</span>,<span class="st">&quot;Rmax2_err&quot;</span>,<span class="st">&quot;kobs_s_inv&quot;</span>, <span class="st">&quot;kobs2&quot;</span>, <span class="st">&quot;kobs_err&quot;</span>, <span class="st">&quot;kobs2_err&quot;</span>, <span class="st">&quot;Req&quot;</span>, <span class="st">&quot;Req2&quot;</span>, <span class="st">&quot;Req_err&quot;</span>, <span class="st">&quot;Req2_err&quot;</span>,<span class="st">&quot;Req_Rmax_fr&quot;</span>, <span class="st">&quot;Req2_Rmax_fr&quot;</span>, <span class="st">&quot;ass_X2&quot;</span>,<span class="st">&quot;ass_R2&quot;</span>,<span class="st">&quot;SSG_kd&quot;</span>,<span class="st">&quot;SSG_Rmax&quot;</span>,<span class="st">&quot;SSG_R2&quot;</span>,<span class="st">&quot;KD_perc&quot;</span>, <span class="st">&quot;KD2_perc&quot;</span>),<span class="st">&quot;A2:AX9&quot;</span>,<span class="st">&quot;Result Table&quot;</span>, <span class="kw">c</span>(<span class="st">&quot;step_id&quot;</span>, <span class="st">&quot;step_name&quot;</span>, <span class="st">&quot;step_type&quot;</span>, <span class="st">&quot;step_time&quot;</span>),<span class="st">&quot;A22:D35&quot;</span>, <span class="st">&quot;Sensor Tray&quot;</span>)</a>
<a class="sourceLine" id="cb2-18" data-line-number="18"></a>
<a class="sourceLine" id="cb2-19" data-line-number="19"><span class="co">### filter sensor parameters (sensors, ligand, concentration): IMPORTANT: modify the results page of the xls report file; and save as tab del file (txt format); then rename to xls</span></a>
<a class="sourceLine" id="cb2-20" data-line-number="20">data_dir_all_pars &lt;-<span class="st"> </span>data_dir_all <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">fileslist_filtered =</span> <span class="kw">str_detect</span>(fileslist,<span class="dt">pattern=</span><span class="st">&quot;^[:alnum:][:digit:]{1,2}.xls&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(fileslist_filtered<span class="op">==</span><span class="st">&quot;FALSE&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">filtername =</span> <span class="kw">str_detect</span>(fileslist,<span class="st">&quot;ExcelReport&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">subset</span>(filtername <span class="op">==</span><span class="st"> &quot;TRUE&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>fileslist_filtered,<span class="op">-</span>filtername) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">unite</span>(.,<span class="st">&quot;readme&quot;</span>, <span class="kw">c</span>(<span class="st">&quot;dirname&quot;</span>, <span class="st">&quot;fileslist&quot;</span>),<span class="dt">sep=</span><span class="st">&quot;&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>value) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(., <span class="dt">report_name =</span> <span class="kw">str_extract</span>(readme, <span class="st">&quot;ExcelReport_kd[:digit:][:digit:]&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(., <span class="dt">report_type =</span> <span class="kw">str_extract</span>(report_name, <span class="st">&quot;[:digit:][:digit:]&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">left_join</span>(., report_colname_list) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">parameters =</span> purrr<span class="op">::</span><span class="kw">pmap</span>(<span class="kw">list</span>(readme, repres_sheet, repres_range, repres_colnames), read_xls)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">senstray =</span> purrr<span class="op">::</span><span class="kw">pmap</span>(<span class="kw">list</span>(readme, senstray_sheet, senstray_range, senstray_colnames), read_xls)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">parameters_sel =</span> purrr<span class="op">::</span><span class="kw">map</span>(parameters, <span class="op">~</span>dplyr<span class="op">::</span><span class="kw">select</span>(.,<span class="dt">sensorid=</span>sensor_loc,<span class="dt">ligand =</span> sample_id, <span class="dt">conc_nM =</span> conc)))  </a>
<a class="sourceLine" id="cb2-21" data-line-number="21"></a>
<a class="sourceLine" id="cb2-22" data-line-number="22">data_dir_all_selpars &lt;-<span class="st"> </span>data_dir_all_pars <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(., report_type <span class="op">==</span><span class="st"> </span>filterme) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(sample, parameters_sel, <span class="kw">contains</span>(<span class="st">&quot;meas&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">unnest</span>(., <span class="dt">cols =</span> <span class="kw">c</span>(<span class="st">&quot;parameters_sel&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">unite</span>(., <span class="dt">col =</span> <span class="st">&quot;sampleid&quot;</span>, <span class="kw">c</span>(<span class="st">&quot;sample&quot;</span>, <span class="st">&quot;sensorid&quot;</span>), <span class="dt">sep =</span> <span class="st">&quot;_&quot;</span>, <span class="dt">remove =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb2-23" data-line-number="23"></a>
<a class="sourceLine" id="cb2-24" data-line-number="24">data_dir_all_sensors_pars &lt;-<span class="st"> </span>data_dir_sensors <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(., sampleid, readme, rec, exprun_digit, meas_type, sensorid, sensor) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">summarize</span>() <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">right_join</span>(., data_dir_all_selpars) </a>
<a class="sourceLine" id="cb2-25" data-line-number="25"></a>
<a class="sourceLine" id="cb2-26" data-line-number="26">data_dir_all_pars_mod &lt;-<span class="st"> </span>data_dir_all_pars <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(., <span class="dt">senstray_acc =</span> purrr<span class="op">::</span><span class="kw">map</span>(senstray, <span class="op">~</span>dplyr<span class="op">::</span><span class="kw">mutate</span>(., <span class="dt">step_time_acc =</span> purrr<span class="op">::</span><span class="kw">map_dbl</span>(<span class="kw">seq_along</span>(step_time), <span class="op">~</span><span class="kw">sum</span>(step_time[<span class="dv">1</span><span class="op">:</span>.x])) )))</a>
<a class="sourceLine" id="cb2-27" data-line-number="27"></a>
<a class="sourceLine" id="cb2-28" data-line-number="28"><span class="co">###combine parameters with sensor data</span></a>
<a class="sourceLine" id="cb2-29" data-line-number="29">data_dir_all_csv &lt;-<span class="st"> </span>data_dir_all_sensors_pars <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">drop_na</span>(., readme) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">csv =</span> purrr<span class="op">::</span><span class="kw">map</span>(readme,<span class="op">~</span><span class="kw">read_tsv</span>(.,<span class="dt">skip=</span><span class="dv">5</span>, <span class="dt">col_names =</span> <span class="kw">c</span>(<span class="st">&quot;time&quot;</span>,<span class="st">&quot;octet&quot;</span>,<span class="st">&quot;simulated&quot;</span>))) ) </a>
<a class="sourceLine" id="cb2-30" data-line-number="30"></a>
<a class="sourceLine" id="cb2-31" data-line-number="31">data_dir_all_csv_titrations &lt;-<span class="st"> </span>data_dir_all_csv <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>readme) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">csv_shifted =</span> purrr<span class="op">::</span><span class="kw">map</span>(csv,<span class="op">~</span>dplyr<span class="op">::</span><span class="kw">mutate</span>(.,<span class="dt">time_shifted =</span> time <span class="op">-</span><span class="st"> </span><span class="kw">min</span>(time)))) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>csv)</a></code></pre></div>
</div>
<div id="initial-plot-of-the-titration-data-as-a-preview" class="section level2">
<h2><span class="header-section-number">1.2</span> Initial plot of the titration data as a preview</h2>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1">data_dir_all_csv_titrations_forteplot &lt;-<span class="st"> </span>data_dir_all_csv_titrations <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(meas_type <span class="op">==</span><span class="st"> &quot;TIT&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">unnest</span>(., <span class="dt">cols =</span> <span class="kw">c</span>(<span class="st">&quot;csv_shifted&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data=</span>., <span class="kw">aes</span>(<span class="dt">x=</span>time_shifted, <span class="dt">y=</span>octet, <span class="dt">colour=</span>conc_nM, <span class="dt">group =</span> sampleid)) <span class="op">+</span></a>
<a class="sourceLine" id="cb3-2" data-line-number="2"><span class="st">  </span><span class="co">#ylab(&quot;Abs /mAU&quot;) +#xlim(c(0,1000)) +#ylim(c(-5,50)) +  #geom_vline(xintercept = mwlines, color = &quot;red&quot;, linetype=&quot;dashed&quot;, size=0.5) +</span></a>
<a class="sourceLine" id="cb3-3" data-line-number="3"><span class="st">  </span><span class="co">#geom_point(size = 2, stroke = 0.1, alpha=0.2, colour = &quot;black&quot;) +</span></a>
<a class="sourceLine" id="cb3-4" data-line-number="4"><span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">size=</span><span class="fl">0.5</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb3-5" data-line-number="5"><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="st">&quot;time: s&quot;</span>, <span class="dt">breaks =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">900</span>, <span class="dv">1800</span>, <span class="dv">2700</span>, <span class="dv">3600</span>, <span class="dv">4300</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb3-6" data-line-number="6"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="st">&quot;octet: nm&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb3-7" data-line-number="7"><span class="st">  </span><span class="kw">scale_colour_gradient2</span>(<span class="dt">low=</span><span class="st">&quot;green&quot;</span>, <span class="dt">mid =</span> <span class="st">&quot;blue&quot;</span>, <span class="dt">high=</span><span class="st">&quot;red&quot;</span>, <span class="dt">midpoint =</span> <span class="dv">10</span> ,<span class="dt">space =</span><span class="st">&quot;Lab&quot;</span>, <span class="dt">trans =</span> <span class="st">&quot;log2&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="co">#,</span></a>
<a class="sourceLine" id="cb3-8" data-line-number="8"><span class="st">  </span><span class="kw">facet_grid</span>(exprun_digit <span class="op">~</span><span class="st"> </span>., <span class="dt">scales =</span> <span class="st">&quot;free_y&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb3-9" data-line-number="9"><span class="st">  </span><span class="co">#facet_grid_paginate(index ~ rec, ncol=2, nrow=4, page = i) +</span></a>
<a class="sourceLine" id="cb3-10" data-line-number="10"><span class="st">  </span><span class="kw">theme_light</span>()</a>
<a class="sourceLine" id="cb3-11" data-line-number="11"><span class="kw">print</span>(data_dir_all_csv_titrations_forteplot)</a></code></pre></div>
<p><img src="index_files/figure-html/forteprocessedXtitrationsplot-1.png" width="672" /></p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="co">#ggsave(file=&quot;ggplot_ligand_ligand_temp.jpeg&quot;, plot=data_dir_all_csv_titrations_plot,device=&quot;jpeg&quot;)</span></a>
<a class="sourceLine" id="cb4-2" data-line-number="2"><span class="kw">ggsave</span>(<span class="dt">file=</span><span class="st">&quot;./ggplot_ligand_ligand_forte.jpeg&quot;</span>, <span class="dt">device=</span><span class="st">&quot;jpeg&quot;</span>, <span class="dt">width =</span> <span class="dv">120</span>, <span class="dt">height =</span> <span class="dv">120</span>, <span class="dt">units =</span> <span class="kw">c</span>(<span class="st">&quot;mm&quot;</span>))</a>
<a class="sourceLine" id="cb4-3" data-line-number="3"><span class="co">#ggsave(file=&quot;./ggplot_ligand_ligand.ps&quot;, width = 120, height = 110, units = c(&quot;mm&quot;))</span></a></code></pre></div>
<div id="titrationsplotCaption" class="figure-box">
<p>Initial plot of the two titrations at low (experiment 901) and high (experiment 1001) salt concentrations, respectively.</p>
</div>
</div>
<div id="initial-pseudo-equilibrium-plot-to-preview-the-extracted-data" class="section level2">
<h2><span class="header-section-number">1.3</span> Initial pseudo-equilibrium plot to preview the extracted data</h2>
<p>Pseudo-equilibrium octet values were first extraced …</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1">data_pall_csv_conc_titrations_eq &lt;-<span class="st">  </span>data_dir_all_csv_titrations <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">csv_shifted_eqphase =</span> purrr<span class="op">::</span><span class="kw">map</span>(csv_shifted, <span class="op">~</span><span class="kw">filter</span>(.,time_shifted <span class="op">&gt;</span><span class="st"> </span><span class="dv">1750</span> <span class="op">&amp;</span><span class="st"> </span>time_shifted <span class="op">&lt;</span><span class="st"> </span><span class="dv">1800</span>))) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">csv_shifted_eqvalue =</span> purrr<span class="op">::</span><span class="kw">map</span>(csv_shifted_eqphase, <span class="op">~</span><span class="kw">summarize</span>(.,<span class="dt">octet_eq =</span> <span class="kw">mean</span>(octet)))) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">unnest</span>(., <span class="kw">c</span>(<span class="st">&quot;csv_shifted_eqvalue&quot;</span>))</a>
<a class="sourceLine" id="cb5-2" data-line-number="2"></a>
<a class="sourceLine" id="cb5-3" data-line-number="3">data_pall_csv_conc_titrations_eq_leftjoin &lt;-<span class="st"> </span>data_pall_csv_conc_titrations_eq <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(., sampleid, conc_nM, octet_eq)</a>
<a class="sourceLine" id="cb5-4" data-line-number="4"></a>
<a class="sourceLine" id="cb5-5" data-line-number="5">data_dir_all_csv_titrations_unnested &lt;-<span class="st"> </span>data_dir_all_csv_titrations <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">left_join</span>(., data_pall_csv_conc_titrations_eq_leftjoin) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">unnest</span>(<span class="dt">cols =</span> <span class="kw">c</span>(<span class="st">&quot;csv_shifted&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(., rec, meas_type) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_modify</span>(.,  <span class="op">~</span><span class="kw">mutate</span>(.,<span class="dt">index=</span><span class="kw">group_indices</span>(.,exprun_digit))) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">ungroup</span>()</a>
<a class="sourceLine" id="cb5-6" data-line-number="6"></a>
<a class="sourceLine" id="cb5-7" data-line-number="7"></a>
<a class="sourceLine" id="cb5-8" data-line-number="8"></a>
<a class="sourceLine" id="cb5-9" data-line-number="9"><span class="co">### plot eq values against concentration: 1200s association</span></a>
<a class="sourceLine" id="cb5-10" data-line-number="10">data_dir_all_csv_titrations_all_nested &lt;-<span class="st"> </span>data_dir_all_csv_titrations_unnested <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(.,meas_type <span class="op">==</span><span class="st"> &quot;TIT&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(., rec, meas_type, sampleid, exprun_digit, sensorid, sensor, sample, ligand, conc_nM, octet_eq, index) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">nest</span>(.) </a>
<a class="sourceLine" id="cb5-11" data-line-number="11"></a>
<a class="sourceLine" id="cb5-12" data-line-number="12">data_pall_csv_conc_titrations_ligand_eq &lt;-<span class="st"> </span>data_pall_csv_conc_titrations_eq <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(meas_type <span class="op">==</span><span class="st"> &quot;TIT&quot;</span>) </a></code></pre></div>
<p>and then plotted against the NTF2-dimer concentration.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1">data_pall_csv_conc_titrations_ligand_eq_logplot &lt;-<span class="st"> </span>data_pall_csv_conc_titrations_ligand_eq <span class="op">%&gt;%</span><span class="st">  </span><span class="kw">ggplot</span>(<span class="dt">data=</span>., <span class="kw">aes</span>(<span class="dt">x=</span>conc_nM, <span class="dt">y=</span>octet_eq, <span class="dt">color=</span>conc_nM, <span class="dt">group=</span><span class="kw">factor</span>(sampleid))) <span class="op">+</span><span class="st">  </span><span class="co">#xlab(&quot;Vol /mL&quot;) + #ylab(&quot;Abs /mAU&quot;) +#xlim(c(0,1000)) +#ylim(c(-5,50)) +  #geom_vline(xintercept = mwlines, color = &quot;red&quot;, linetype=&quot;dashed&quot;, size=0.5) +</span></a>
<a class="sourceLine" id="cb6-2" data-line-number="2"><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">size=</span><span class="dv">2</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb6-3" data-line-number="3"><span class="st">  </span><span class="kw">scale_x_log10</span>(<span class="st">&quot;c(RBD): nM&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb6-4" data-line-number="4"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="st">&quot;pseudo-eq octet: nm&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb6-5" data-line-number="5"><span class="st">  </span><span class="kw">scale_color_gradient2</span>(<span class="st">&quot;c(RBD): nM&quot;</span>, <span class="dt">low=</span><span class="st">&quot;green&quot;</span>, <span class="dt">mid=</span><span class="st">&quot;blue&quot;</span>, <span class="dt">high=</span><span class="st">&quot;red&quot;</span>, <span class="dt">space =</span><span class="st">&quot;Lab&quot;</span>,<span class="dt">midpoint=</span><span class="dv">3</span>, <span class="dt">trans =</span> <span class="st">&quot;log2&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="co">#,</span></a>
<a class="sourceLine" id="cb6-6" data-line-number="6"><span class="kw">facet_grid</span>(sample <span class="op">~</span><span class="st"> </span>., <span class="dt">scales =</span> <span class="st">&quot;free_y&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb6-7" data-line-number="7"><span class="st">  </span><span class="kw">theme_light</span>()</a>
<a class="sourceLine" id="cb6-8" data-line-number="8"><span class="kw">print</span>(data_pall_csv_conc_titrations_ligand_eq_logplot)</a></code></pre></div>
<p><img src="index_files/figure-html/EQfitplot-1.png" width="672" /></p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1"><span class="kw">ggsave</span>(<span class="dt">file=</span><span class="st">&quot;ggplot_ligand_titrations_eqconc_log.jpeg&quot;</span>, <span class="dt">plot=</span>data_pall_csv_conc_titrations_ligand_eq_logplot,<span class="dt">device=</span><span class="st">&quot;jpeg&quot;</span>)</a>
<a class="sourceLine" id="cb7-2" data-line-number="2"><span class="co">#ggsave(file=&quot;ggplot_ligand_titrations_eqconc_log.ps&quot;, plot=data_pall_csv_conc_titrations_ligand_eq_logplot,device=&quot;ps&quot;)</span></a></code></pre></div>
<div id="EQplotCaption" class="figure-box">
<p>Pseudo-equilibrium data versus ligand concentration on semi-log scale, without any fits.</p>
</div>
</div>
<div id="raw-data-plots-to-compare-ligands-and-sensor-surfaces" class="section level2">
<h2><span class="header-section-number">1.4</span> Raw data plots to compare ligands and sensor surfaces</h2>
<p>Before continuing with data fitting and further analysis, raw data are plotted in panels for all experiments. Plots saved as JPGs, only shown for the comparative experiment, not for the titrations.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1"><span class="co">### filter sensor titration data</span></a>
<a class="sourceLine" id="cb8-2" data-line-number="2">data_dir_sensors_raw &lt;-<span class="st"> </span>data_dir_all <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(., fileslist <span class="op">==</span><span class="st"> &quot;RawData0.xls&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">unite</span>(.,<span class="st">&quot;readme&quot;</span>, <span class="kw">c</span>(<span class="st">&quot;dirname&quot;</span>, <span class="st">&quot;fileslist&quot;</span>),<span class="dt">sep=</span><span class="st">&quot;&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>expnumber)</a>
<a class="sourceLine" id="cb8-3" data-line-number="3"></a>
<a class="sourceLine" id="cb8-4" data-line-number="4">sensor_spec &lt;-<span class="st"> </span><span class="kw">tribble</span>(<span class="op">~</span>.name, <span class="op">~</span>.value, <span class="op">~</span>sensor, <span class="op">~</span>ligand, <span class="op">~</span>analyte, <span class="op">~</span>meas_type, <span class="op">~</span>meas_driftcorr,</a>
<a class="sourceLine" id="cb8-5" data-line-number="5">                       <span class="st">&quot;A_time&quot;</span>, <span class="st">&quot;time&quot;</span>, <span class="st">&quot;A&quot;</span>, <span class="st">&quot;nbTy1&quot;</span>, <span class="st">&quot;RBD&quot;</span>, <span class="st">&quot;TIT&quot;</span>, <span class="st">&quot;none&quot;</span>,</a>
<a class="sourceLine" id="cb8-6" data-line-number="6">                       <span class="st">&quot;A_octet&quot;</span>, <span class="st">&quot;octet&quot;</span>, <span class="st">&quot;A&quot;</span>,<span class="st">&quot;nbTy1&quot;</span>,<span class="st">&quot;RBD&quot;</span>, <span class="st">&quot;TIT&quot;</span>, <span class="st">&quot;none&quot;</span>,</a>
<a class="sourceLine" id="cb8-7" data-line-number="7">                       <span class="st">&quot;B_time&quot;</span>, <span class="st">&quot;time&quot;</span>, <span class="st">&quot;B&quot;</span>, <span class="st">&quot;nbTy1&quot;</span>,<span class="st">&quot;RBD&quot;</span>,<span class="st">&quot;TIT&quot;</span>, <span class="st">&quot;none&quot;</span>,</a>
<a class="sourceLine" id="cb8-8" data-line-number="8">                       <span class="st">&quot;B_octet&quot;</span>, <span class="st">&quot;octet&quot;</span>, <span class="st">&quot;B&quot;</span>,<span class="st">&quot;nbTy1&quot;</span>,<span class="st">&quot;RBD&quot;</span>, <span class="st">&quot;TIT&quot;</span>, <span class="st">&quot;none&quot;</span>,</a>
<a class="sourceLine" id="cb8-9" data-line-number="9">                       <span class="st">&quot;C_time&quot;</span>, <span class="st">&quot;time&quot;</span>, <span class="st">&quot;C&quot;</span>, <span class="st">&quot;nbTy1&quot;</span>,<span class="st">&quot;RBD&quot;</span>,<span class="st">&quot;TIT&quot;</span>, <span class="st">&quot;none&quot;</span>,</a>
<a class="sourceLine" id="cb8-10" data-line-number="10">                       <span class="st">&quot;C_octet&quot;</span>, <span class="st">&quot;octet&quot;</span>, <span class="st">&quot;C&quot;</span>,<span class="st">&quot;nbTy1&quot;</span>,<span class="st">&quot;RBD&quot;</span>, <span class="st">&quot;TIT&quot;</span>, <span class="st">&quot;none&quot;</span>,</a>
<a class="sourceLine" id="cb8-11" data-line-number="11">                       <span class="st">&quot;D_time&quot;</span>, <span class="st">&quot;time&quot;</span>, <span class="st">&quot;D&quot;</span>, <span class="st">&quot;nbTy1&quot;</span>,<span class="st">&quot;RBD&quot;</span>,<span class="st">&quot;TIT&quot;</span>, <span class="st">&quot;none&quot;</span>,</a>
<a class="sourceLine" id="cb8-12" data-line-number="12">                       <span class="st">&quot;D_octet&quot;</span>, <span class="st">&quot;octet&quot;</span>, <span class="st">&quot;D&quot;</span>,<span class="st">&quot;nbTy1&quot;</span>,<span class="st">&quot;RBD&quot;</span>, <span class="st">&quot;TIT&quot;</span>, <span class="st">&quot;none&quot;</span>,</a>
<a class="sourceLine" id="cb8-13" data-line-number="13">                       <span class="st">&quot;E_time&quot;</span>, <span class="st">&quot;time&quot;</span>, <span class="st">&quot;E&quot;</span>, <span class="st">&quot;nbTy1&quot;</span>,<span class="st">&quot;RBD&quot;</span>,<span class="st">&quot;TIT&quot;</span>, <span class="st">&quot;none&quot;</span>,</a>
<a class="sourceLine" id="cb8-14" data-line-number="14">                       <span class="st">&quot;E_octet&quot;</span>, <span class="st">&quot;octet&quot;</span>, <span class="st">&quot;E&quot;</span>,<span class="st">&quot;nbTy1&quot;</span>,<span class="st">&quot;RBD&quot;</span>, <span class="st">&quot;TIT&quot;</span>, <span class="st">&quot;none&quot;</span>,</a>
<a class="sourceLine" id="cb8-15" data-line-number="15">                       <span class="st">&quot;F_time&quot;</span>, <span class="st">&quot;time&quot;</span>, <span class="st">&quot;F&quot;</span>, <span class="st">&quot;nbTy1&quot;</span>,<span class="st">&quot;RBD&quot;</span>,<span class="st">&quot;TIT&quot;</span>, <span class="st">&quot;none&quot;</span>,</a>
<a class="sourceLine" id="cb8-16" data-line-number="16">                       <span class="st">&quot;F_octet&quot;</span>, <span class="st">&quot;octet&quot;</span>, <span class="st">&quot;F&quot;</span>,<span class="st">&quot;nbTy1&quot;</span>,<span class="st">&quot;RBD&quot;</span>, <span class="st">&quot;TIT&quot;</span>, <span class="st">&quot;none&quot;</span>,</a>
<a class="sourceLine" id="cb8-17" data-line-number="17">                       <span class="st">&quot;G_time&quot;</span>, <span class="st">&quot;time&quot;</span>, <span class="st">&quot;G&quot;</span>, <span class="st">&quot;nbTy1&quot;</span>,<span class="st">&quot;RBD&quot;</span>,<span class="st">&quot;TIT&quot;</span>, <span class="st">&quot;none&quot;</span>,</a>
<a class="sourceLine" id="cb8-18" data-line-number="18">                       <span class="st">&quot;G_octet&quot;</span>, <span class="st">&quot;octet&quot;</span>, <span class="st">&quot;G&quot;</span>,<span class="st">&quot;nbTy1&quot;</span>,<span class="st">&quot;RBD&quot;</span>, <span class="st">&quot;TIT&quot;</span>, <span class="st">&quot;none&quot;</span>,</a>
<a class="sourceLine" id="cb8-19" data-line-number="19">                       <span class="st">&quot;H_time&quot;</span>, <span class="st">&quot;time&quot;</span>, <span class="st">&quot;H&quot;</span>, <span class="st">&quot;nbTy1&quot;</span>,<span class="st">&quot;RBD&quot;</span>,<span class="st">&quot;TIT&quot;</span>, <span class="st">&quot;none&quot;</span>,</a>
<a class="sourceLine" id="cb8-20" data-line-number="20">                       <span class="st">&quot;H_octet&quot;</span>, <span class="st">&quot;octet&quot;</span>, <span class="st">&quot;H&quot;</span>,<span class="st">&quot;nbTy1&quot;</span>,<span class="st">&quot;RBD&quot;</span>, <span class="st">&quot;TIT&quot;</span>, <span class="st">&quot;none&quot;</span>,</a>
<a class="sourceLine" id="cb8-21" data-line-number="21">                       <span class="st">&quot;A_time&quot;</span>, <span class="st">&quot;time&quot;</span>, <span class="st">&quot;A&quot;</span>, <span class="st">&quot;nbTy1&quot;</span>,<span class="st">&quot;RBD&quot;</span>,<span class="st">&quot;TIT&quot;</span>, <span class="st">&quot;ref&quot;</span>,</a>
<a class="sourceLine" id="cb8-22" data-line-number="22">                       <span class="st">&quot;A_octet&quot;</span>, <span class="st">&quot;octet&quot;</span>, <span class="st">&quot;A&quot;</span>,<span class="st">&quot;nbTy1&quot;</span>,<span class="st">&quot;RBD&quot;</span>, <span class="st">&quot;TIT&quot;</span>, <span class="st">&quot;ref&quot;</span>,</a>
<a class="sourceLine" id="cb8-23" data-line-number="23">                       <span class="st">&quot;B_time&quot;</span>, <span class="st">&quot;time&quot;</span>, <span class="st">&quot;B&quot;</span>, <span class="st">&quot;nbTy1&quot;</span>,<span class="st">&quot;RBD&quot;</span>,<span class="st">&quot;TIT&quot;</span>, <span class="st">&quot;ref&quot;</span>,</a>
<a class="sourceLine" id="cb8-24" data-line-number="24">                       <span class="st">&quot;B_octet&quot;</span>, <span class="st">&quot;octet&quot;</span>, <span class="st">&quot;B&quot;</span>,<span class="st">&quot;nbTy1&quot;</span>,<span class="st">&quot;RBD&quot;</span>, <span class="st">&quot;TIT&quot;</span>, <span class="st">&quot;ref&quot;</span>,</a>
<a class="sourceLine" id="cb8-25" data-line-number="25">                       <span class="st">&quot;C_time&quot;</span>, <span class="st">&quot;time&quot;</span>, <span class="st">&quot;C&quot;</span>, <span class="st">&quot;nbTy1&quot;</span>,<span class="st">&quot;RBD&quot;</span>,<span class="st">&quot;TIT&quot;</span>, <span class="st">&quot;ref&quot;</span>,</a>
<a class="sourceLine" id="cb8-26" data-line-number="26">                       <span class="st">&quot;C_octet&quot;</span>, <span class="st">&quot;octet&quot;</span>, <span class="st">&quot;C&quot;</span>,<span class="st">&quot;nbTy1&quot;</span>,<span class="st">&quot;RBD&quot;</span>, <span class="st">&quot;TIT&quot;</span>, <span class="st">&quot;ref&quot;</span>,</a>
<a class="sourceLine" id="cb8-27" data-line-number="27">                       <span class="st">&quot;D_time&quot;</span>, <span class="st">&quot;time&quot;</span>, <span class="st">&quot;D&quot;</span>, <span class="st">&quot;nbTy1&quot;</span>,<span class="st">&quot;RBD&quot;</span>,<span class="st">&quot;TIT&quot;</span>, <span class="st">&quot;ref&quot;</span>,</a>
<a class="sourceLine" id="cb8-28" data-line-number="28">                       <span class="st">&quot;D_octet&quot;</span>, <span class="st">&quot;octet&quot;</span>, <span class="st">&quot;D&quot;</span>,<span class="st">&quot;nbTy1&quot;</span>,<span class="st">&quot;RBD&quot;</span>, <span class="st">&quot;TIT&quot;</span>, <span class="st">&quot;ref&quot;</span>,</a>
<a class="sourceLine" id="cb8-29" data-line-number="29">                       <span class="st">&quot;E_time&quot;</span>, <span class="st">&quot;time&quot;</span>, <span class="st">&quot;E&quot;</span>, <span class="st">&quot;nbTy1&quot;</span>,<span class="st">&quot;RBD&quot;</span>,<span class="st">&quot;TIT&quot;</span>, <span class="st">&quot;ref&quot;</span>,</a>
<a class="sourceLine" id="cb8-30" data-line-number="30">                       <span class="st">&quot;E_octet&quot;</span>, <span class="st">&quot;octet&quot;</span>, <span class="st">&quot;E&quot;</span>,<span class="st">&quot;nbTy1&quot;</span>,<span class="st">&quot;RBD&quot;</span>, <span class="st">&quot;TIT&quot;</span>, <span class="st">&quot;ref&quot;</span>,</a>
<a class="sourceLine" id="cb8-31" data-line-number="31">                       <span class="st">&quot;F_time&quot;</span>, <span class="st">&quot;time&quot;</span>, <span class="st">&quot;F&quot;</span>, <span class="st">&quot;nbTy1&quot;</span>,<span class="st">&quot;RBD&quot;</span>,<span class="st">&quot;TIT&quot;</span>, <span class="st">&quot;ref&quot;</span>,</a>
<a class="sourceLine" id="cb8-32" data-line-number="32">                       <span class="st">&quot;F_octet&quot;</span>, <span class="st">&quot;octet&quot;</span>, <span class="st">&quot;F&quot;</span>,<span class="st">&quot;nbTy1&quot;</span>,<span class="st">&quot;RBD&quot;</span>, <span class="st">&quot;TIT&quot;</span>, <span class="st">&quot;ref&quot;</span>,</a>
<a class="sourceLine" id="cb8-33" data-line-number="33">                       <span class="st">&quot;G_time&quot;</span>, <span class="st">&quot;time&quot;</span>, <span class="st">&quot;G&quot;</span>, <span class="st">&quot;nbTy1&quot;</span>,<span class="st">&quot;RBD&quot;</span>,<span class="st">&quot;TIT&quot;</span>, <span class="st">&quot;ref&quot;</span>,</a>
<a class="sourceLine" id="cb8-34" data-line-number="34">                       <span class="st">&quot;G_octet&quot;</span>, <span class="st">&quot;octet&quot;</span>, <span class="st">&quot;G&quot;</span>,<span class="st">&quot;nbTy1&quot;</span>,<span class="st">&quot;RBD&quot;</span>, <span class="st">&quot;TIT&quot;</span>, <span class="st">&quot;ref&quot;</span>,</a>
<a class="sourceLine" id="cb8-35" data-line-number="35">                       <span class="st">&quot;H_time&quot;</span>, <span class="st">&quot;time&quot;</span>, <span class="st">&quot;H&quot;</span>, <span class="st">&quot;nbTy1&quot;</span>,<span class="st">&quot;PBST&quot;</span>,<span class="st">&quot;TIT&quot;</span>, <span class="st">&quot;ref&quot;</span>,</a>
<a class="sourceLine" id="cb8-36" data-line-number="36">                       <span class="st">&quot;H_octet&quot;</span>, <span class="st">&quot;octet&quot;</span>, <span class="st">&quot;H&quot;</span>,<span class="st">&quot;nbTy1&quot;</span>,<span class="st">&quot;PBST&quot;</span>, <span class="st">&quot;TIT&quot;</span>, <span class="st">&quot;ref&quot;</span>,</a>
<a class="sourceLine" id="cb8-37" data-line-number="37">                       <span class="st">&quot;A_time&quot;</span>, <span class="st">&quot;time&quot;</span>, <span class="st">&quot;A&quot;</span>, <span class="st">&quot;nbTy1&quot;</span>,<span class="st">&quot;RBD&quot;</span>,<span class="st">&quot;COMP&quot;</span>, <span class="st">&quot;ref&quot;</span>,</a>
<a class="sourceLine" id="cb8-38" data-line-number="38">                       <span class="st">&quot;A_octet&quot;</span>, <span class="st">&quot;octet&quot;</span>, <span class="st">&quot;A&quot;</span>,<span class="st">&quot;nbTy1&quot;</span>,<span class="st">&quot;RBD&quot;</span>, <span class="st">&quot;COMP&quot;</span>, <span class="st">&quot;ref&quot;</span>,</a>
<a class="sourceLine" id="cb8-39" data-line-number="39">                       <span class="st">&quot;B_time&quot;</span>, <span class="st">&quot;time&quot;</span>, <span class="st">&quot;B&quot;</span>, <span class="st">&quot;nbTy1&quot;</span>,<span class="st">&quot;RBD&quot;</span>,<span class="st">&quot;COMP&quot;</span>, <span class="st">&quot;ref&quot;</span>,</a>
<a class="sourceLine" id="cb8-40" data-line-number="40">                       <span class="st">&quot;B_octet&quot;</span>, <span class="st">&quot;octet&quot;</span>, <span class="st">&quot;B&quot;</span>,<span class="st">&quot;nbTy1&quot;</span>,<span class="st">&quot;RBD&quot;</span>, <span class="st">&quot;COMP&quot;</span>, <span class="st">&quot;ref&quot;</span>,</a>
<a class="sourceLine" id="cb8-41" data-line-number="41">                       <span class="st">&quot;C_time&quot;</span>, <span class="st">&quot;time&quot;</span>, <span class="st">&quot;C&quot;</span>, <span class="st">&quot;nbTy1&quot;</span>,<span class="st">&quot;PBST&quot;</span>,<span class="st">&quot;COMP&quot;</span>, <span class="st">&quot;ref&quot;</span>,</a>
<a class="sourceLine" id="cb8-42" data-line-number="42">                       <span class="st">&quot;C_octet&quot;</span>, <span class="st">&quot;octet&quot;</span>, <span class="st">&quot;C&quot;</span>, <span class="st">&quot;nbTy1&quot;</span>,<span class="st">&quot;PBST&quot;</span>,<span class="st">&quot;COMP&quot;</span>, <span class="st">&quot;ref&quot;</span>,</a>
<a class="sourceLine" id="cb8-43" data-line-number="43">                       <span class="st">&quot;D_time&quot;</span>, <span class="st">&quot;time&quot;</span>, <span class="st">&quot;D&quot;</span>, <span class="st">&quot;SAX&quot;</span>,<span class="st">&quot;RBD&quot;</span>,<span class="st">&quot;COMP&quot;</span>, <span class="st">&quot;ref&quot;</span>,</a>
<a class="sourceLine" id="cb8-44" data-line-number="44">                       <span class="st">&quot;D_octet&quot;</span>, <span class="st">&quot;octet&quot;</span>, <span class="st">&quot;D&quot;</span>, <span class="st">&quot;SAX&quot;</span>,<span class="st">&quot;RBD&quot;</span>,<span class="st">&quot;COMP&quot;</span>, <span class="st">&quot;ref&quot;</span>,</a>
<a class="sourceLine" id="cb8-45" data-line-number="45">                       <span class="st">&quot;E_time&quot;</span>, <span class="st">&quot;time&quot;</span>, <span class="st">&quot;E&quot;</span>,<span class="st">&quot;NP-VHH1&quot;</span>,<span class="st">&quot;RBD&quot;</span>,<span class="st">&quot;COMP&quot;</span>, <span class="st">&quot;ref&quot;</span>,</a>
<a class="sourceLine" id="cb8-46" data-line-number="46">                       <span class="st">&quot;E_octet&quot;</span>, <span class="st">&quot;octet&quot;</span>, <span class="st">&quot;E&quot;</span>, <span class="st">&quot;NP-VHH1&quot;</span>,<span class="st">&quot;RBD&quot;</span>,<span class="st">&quot;COMP&quot;</span>, <span class="st">&quot;ref&quot;</span>,</a>
<a class="sourceLine" id="cb8-47" data-line-number="47">                       <span class="st">&quot;F_time&quot;</span>, <span class="st">&quot;time&quot;</span>, <span class="st">&quot;F&quot;</span>, <span class="st">&quot;NP-VHH1&quot;</span>,<span class="st">&quot;RBD&quot;</span>,<span class="st">&quot;COMP&quot;</span>, <span class="st">&quot;ref&quot;</span>,</a>
<a class="sourceLine" id="cb8-48" data-line-number="48">                       <span class="st">&quot;F_octet&quot;</span>, <span class="st">&quot;octet&quot;</span>, <span class="st">&quot;F&quot;</span>, <span class="st">&quot;NP-VHH1&quot;</span>,<span class="st">&quot;RBD&quot;</span>,<span class="st">&quot;COMP&quot;</span>, <span class="st">&quot;ref&quot;</span>,</a>
<a class="sourceLine" id="cb8-49" data-line-number="49">                       <span class="st">&quot;G_time&quot;</span>, <span class="st">&quot;time&quot;</span>, <span class="st">&quot;G&quot;</span>, <span class="st">&quot;NP-VHH1&quot;</span>,<span class="st">&quot;PBST&quot;</span>,<span class="st">&quot;COMP&quot;</span>, <span class="st">&quot;ref&quot;</span>,</a>
<a class="sourceLine" id="cb8-50" data-line-number="50">                       <span class="st">&quot;G_octet&quot;</span>, <span class="st">&quot;octet&quot;</span>, <span class="st">&quot;G&quot;</span>, <span class="st">&quot;NP-VHH1&quot;</span>,<span class="st">&quot;PBST&quot;</span>,<span class="st">&quot;COMP&quot;</span>, <span class="st">&quot;ref&quot;</span>,</a>
<a class="sourceLine" id="cb8-51" data-line-number="51">                       <span class="st">&quot;H_time&quot;</span>, <span class="st">&quot;time&quot;</span>, <span class="st">&quot;H&quot;</span>, <span class="st">&quot;SAX&quot;</span>,<span class="st">&quot;RBD&quot;</span>,<span class="st">&quot;COMP&quot;</span>, <span class="st">&quot;ref&quot;</span>,</a>
<a class="sourceLine" id="cb8-52" data-line-number="52">                       <span class="st">&quot;H_octet&quot;</span>, <span class="st">&quot;octet&quot;</span>, <span class="st">&quot;H&quot;</span>, <span class="st">&quot;SAX&quot;</span>,<span class="st">&quot;RBD&quot;</span>,<span class="st">&quot;COMP&quot;</span>, <span class="st">&quot;ref&quot;</span>)</a>
<a class="sourceLine" id="cb8-53" data-line-number="53"></a>
<a class="sourceLine" id="cb8-54" data-line-number="54">sensor_spec_nested &lt;-<span class="st"> </span>sensor_spec <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(., meas_type, meas_driftcorr) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">nest</span>() <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(., meas_type, meas_driftcorr, <span class="dt">sensor_par =</span> data)</a>
<a class="sourceLine" id="cb8-55" data-line-number="55"></a>
<a class="sourceLine" id="cb8-56" data-line-number="56">sensor_plot_f &lt;-<span class="st"> </span><span class="cf">function</span>(df){</a>
<a class="sourceLine" id="cb8-57" data-line-number="57"> plot_obj &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data=</span>df, <span class="kw">aes</span>(<span class="dt">x=</span>time, <span class="dt">y=</span>octet, <span class="dt">color=</span>sensor)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb8-58" data-line-number="58"><span class="st">  </span><span class="co">#xlab(&quot;Vol /mL&quot;) + #ylab(&quot;Abs /mAU&quot;) +#xlim(c(0,1000)) +#ylim(c(-5,50)) +  #geom_vline(xintercept = mwlines, color = &quot;red&quot;, linetype=&quot;dashed&quot;, size=0.5) +</span></a>
<a class="sourceLine" id="cb8-59" data-line-number="59"><span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">size=</span><span class="dv">1</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb8-60" data-line-number="60"><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="st">&quot;time: s&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb8-61" data-line-number="61"><span class="st">   </span><span class="kw">scale_y_continuous</span>(<span class="st">&quot;octet: nm&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb8-62" data-line-number="62"><span class="st">  </span><span class="kw">theme_light</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb8-63" data-line-number="63"><span class="st">  </span><span class="kw">scale_color_aaas</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb8-64" data-line-number="64"><span class="st">    </span><span class="co">#scale_color_gradient2(low=&quot;green&quot;, mid=&quot;blue&quot;, high=&quot;red&quot;, space =&quot;Lab&quot;,midpoint=3, trans = &quot;log10&quot;) + #,</span></a>
<a class="sourceLine" id="cb8-65" data-line-number="65"><span class="kw">facet_grid</span>(ligand <span class="op">~</span><span class="st"> </span>analyte)</a>
<a class="sourceLine" id="cb8-66" data-line-number="66">  <span class="kw">return</span>(plot_obj)</a>
<a class="sourceLine" id="cb8-67" data-line-number="67">}</a>
<a class="sourceLine" id="cb8-68" data-line-number="68"></a>
<a class="sourceLine" id="cb8-69" data-line-number="69">  </a>
<a class="sourceLine" id="cb8-70" data-line-number="70"><span class="co">### plot raw data </span></a>
<a class="sourceLine" id="cb8-71" data-line-number="71">data_dir_sensors_raw_xls &lt;-<span class="st"> </span>data_dir_sensors_raw <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">csv =</span> purrr<span class="op">::</span><span class="kw">map</span>(readme,<span class="op">~</span><span class="kw">read_tsv</span>(., <span class="dt">skip =</span> <span class="dv">1</span>, <span class="dt">col_names =</span> <span class="kw">c</span>(<span class="st">&quot;A_time&quot;</span>, <span class="st">&quot;A_octet&quot;</span>, <span class="st">&quot;B_time&quot;</span>, <span class="st">&quot;B_octet&quot;</span>, <span class="st">&quot;C_time&quot;</span>, <span class="st">&quot;C_octet&quot;</span>, <span class="st">&quot;D_time&quot;</span>, <span class="st">&quot;D_octet&quot;</span>, <span class="st">&quot;E_time&quot;</span>, <span class="st">&quot;E_octet&quot;</span>, <span class="st">&quot;F_time&quot;</span>, <span class="st">&quot;F_octet&quot;</span>, <span class="st">&quot;G_time&quot;</span>, <span class="st">&quot;G_octet&quot;</span>,<span class="st">&quot;H_time&quot;</span>, <span class="st">&quot;H_octet&quot;</span>))) ) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">left_join</span>(., sensor_spec_nested) </a>
<a class="sourceLine" id="cb8-72" data-line-number="72"></a>
<a class="sourceLine" id="cb8-73" data-line-number="73">data_dir_sensors_raw_xls_longer &lt;-<span class="st"> </span>data_dir_sensors_raw_xls <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">xls_longer =</span> purrr<span class="op">::</span><span class="kw">pmap</span>(<span class="kw">list</span>(csv, sensor_par), pivot_longer_spec)) <span class="op">%&gt;%</span><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">xls_longer_sorted =</span> purrr<span class="op">::</span><span class="kw">map</span>(xls_longer,<span class="op">~</span><span class="kw">arrange</span>(., sensor))) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(., <span class="dt">sensor_plot =</span> purrr<span class="op">::</span><span class="kw">pmap</span>(<span class="kw">list</span>(xls_longer_sorted),sensor_plot_f)) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(., <span class="dt">plot_name =</span> <span class="kw">paste</span>(<span class="st">&quot;rawdata_&quot;</span>, sample, <span class="st">&quot;.jpeg&quot;</span>, <span class="dt">sep =</span><span class="st">&quot;&quot;</span>)) </a>
<a class="sourceLine" id="cb8-74" data-line-number="74"></a>
<a class="sourceLine" id="cb8-75" data-line-number="75"><span class="kw">pwalk</span>(<span class="kw">list</span>(data_dir_sensors_raw_xls_longer<span class="op">$</span>plot_name, data_dir_sensors_raw_xls_longer<span class="op">$</span>sensor_plot), ggsave)</a></code></pre></div>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1">data_dir_sensors_raw_xls_longer_comp &lt;-<span class="st"> </span>data_dir_sensors_raw_xls_longer <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(., <span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>), xls_longer_sorted) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(., rec <span class="op">==</span><span class="st"> &quot;BOTH&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">unnest</span>(., xls_longer_sorted) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(., <span class="dt">plotgroup =</span> <span class="kw">paste</span>(ligand, analyte, <span class="dt">sep =</span> <span class="st">&quot; &amp; &quot;</span>))</a>
<a class="sourceLine" id="cb9-2" data-line-number="2"></a>
<a class="sourceLine" id="cb9-3" data-line-number="3">sample_list_colororder &lt;-<span class="st"> </span>data_dir_sensors_raw_xls_longer_comp <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(., exprun_digit, sample, sensor, ligand, analyte, plotgroup) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">summarize</span>(., <span class="dt">min_time =</span> <span class="kw">min</span>(time)) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(., <span class="dt">plotid =</span> <span class="kw">paste</span>(sample, sensor, <span class="dt">sep =</span> <span class="st">&quot;x&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">ungroup</span>()</a>
<a class="sourceLine" id="cb9-4" data-line-number="4"></a>
<a class="sourceLine" id="cb9-5" data-line-number="5">data_dir_sensors_raw_xls_longer_comp_plot &lt;-<span class="st"> </span>data_dir_sensors_raw_xls_longer_comp <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">ggplot</span>(., <span class="kw">aes</span>(<span class="dt">x=</span>time, <span class="dt">y=</span>octet, <span class="dt">color=</span>plotgroup)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb9-6" data-line-number="6"><span class="st">  </span><span class="co">#xlab(&quot;Vol /mL&quot;) + #ylab(&quot;Abs /mAU&quot;) +#xlim(c(0,1000)) +#ylim(c(-5,50)) +  #geom_vline(xintercept = mwlines, color = &quot;red&quot;, linetype=&quot;dashed&quot;, size=0.5) +</span></a>
<a class="sourceLine" id="cb9-7" data-line-number="7"><span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">size=</span><span class="dv">1</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb9-8" data-line-number="8"><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="st">&quot;time: s&quot;</span>, <span class="dt">n.breaks =</span> <span class="dv">10</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb9-9" data-line-number="9"><span class="st">   </span><span class="kw">scale_y_continuous</span>(<span class="st">&quot;octet: nm&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb9-10" data-line-number="10"><span class="st">  </span><span class="kw">theme_light</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb9-11" data-line-number="11"><span class="st">  </span><span class="kw">scale_color_aaas</span>() </a>
<a class="sourceLine" id="cb9-12" data-line-number="12">    <span class="co">#scale_color_gradient2(low=&quot;green&quot;, mid=&quot;blue&quot;, high=&quot;red&quot;, space =&quot;Lab&quot;,midpoint=3, trans = &quot;log10&quot;) + #,</span></a>
<a class="sourceLine" id="cb9-13" data-line-number="13"><span class="co">#facet_grid(. ~ .)</span></a>
<a class="sourceLine" id="cb9-14" data-line-number="14">  <span class="kw">print</span>(data_dir_sensors_raw_xls_longer_comp_plot)</a></code></pre></div>
<p><img src="index_files/figure-html/plotCompAsRaw-1.png" width="672" /></p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1">  <span class="kw">ggsave</span>(<span class="st">&quot;comparative_plot.jpeg&quot;</span>, <span class="dt">plot =</span> data_dir_sensors_raw_xls_longer_comp_plot, <span class="dt">width =</span> <span class="dv">160</span>, <span class="dt">height =</span> <span class="dv">80</span>, <span class="dt">units =</span> <span class="kw">c</span>(<span class="st">&quot;mm&quot;</span>))</a>
<a class="sourceLine" id="cb10-2" data-line-number="2">  <span class="kw">ggsave</span>(<span class="st">&quot;comparative_plot.ps&quot;</span>, <span class="dt">plot =</span> data_dir_sensors_raw_xls_longer_comp_plot, <span class="dt">width =</span> <span class="dv">160</span>, <span class="dt">height =</span> <span class="dv">80</span>, <span class="dt">units =</span> <span class="kw">c</span>(<span class="st">&quot;mm&quot;</span>))</a></code></pre></div>
<div id="ComparativePlotCaption" class="figure-box">
<p>This figure was used in an earlier manuscript version, following caption just copied froma that earlier version: RBD bounds to surface-immobilized nbTy1 (red curves), but not to NP-VH11 (violet curves) or to biocytin-quenched Streptavidin (SAX, green curves). Almost equal nanobody immobilization levels of about 0.7 nm were obtained by first loading nbTy1 and then NP-VH11. The SAX control surface (green) was only quenched, but not loaded with nanobodies. During association, nanobody sample and control SAX sensors (red, violet and green) were dipped into RBD, while the reference nanobody sensors were dipped into PBST (blue and light-green). For dissociation, all sensors were dipped into PBST. Binding of molecules over time is recorded as sensorgrams recording the shift in wavelengths (unit: nm) due to an increase in the optical thickness of the surface layer.</p>
</div>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1">sample_list_colororder_add &lt;-<span class="st"> </span>sample_list_colororder</a>
<a class="sourceLine" id="cb11-2" data-line-number="2"></a>
<a class="sourceLine" id="cb11-3" data-line-number="3">data_dir_all_csv_comp_forteplot &lt;-<span class="st"> </span>data_dir_all_csv_titrations <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(meas_type <span class="op">==</span><span class="st"> &quot;COMP&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(., <span class="dt">nanobody =</span> <span class="kw">case_when</span>(sensorid <span class="op">==</span><span class="st"> &quot;A5&quot;</span> <span class="op">~</span><span class="st"> &quot;nbTy1&quot;</span>, sensorid <span class="op">==</span><span class="st"> &quot;B5&quot;</span> <span class="op">~</span><span class="st">&quot;nbTy1&quot;</span>, sensorid <span class="op">==</span><span class="st"> &quot;E5&quot;</span> <span class="op">~</span><span class="st">&quot;NP-VHH1&quot;</span>, sensorid <span class="op">==</span><span class="st"> &quot;F5&quot;</span> <span class="op">~</span><span class="st">&quot;NP-VHH1&quot;</span>) ) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(., <span class="dt">plotgroup =</span> <span class="kw">paste</span>(nanobody, <span class="st">&quot; &amp; RBD&quot;</span>, <span class="dt">sep =</span> <span class="st">&quot;&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(., <span class="dt">sensor =</span> <span class="kw">str_extract</span>(sensorid, <span class="dt">pattern =</span> <span class="st">&quot;[ABCDEFGH]&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(., <span class="dt">plotid =</span> <span class="kw">paste</span>(sample, sensor, <span class="dt">sep =</span> <span class="st">&quot;x&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(., <span class="dt">plotorder =</span> <span class="kw">case_when</span>(nanobody <span class="op">==</span><span class="st"> &quot;nbTy1&quot;</span> <span class="op">~</span><span class="st"> &quot;id2:nbTy1&quot;</span>, nanobody <span class="op">==</span><span class="st"> &quot;NP-VHH1&quot;</span> <span class="op">~</span><span class="st"> &quot;id1:NP-VHH1&quot;</span>, <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> &quot;none&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">unnest</span>(., <span class="dt">cols =</span> <span class="kw">c</span>(<span class="st">&quot;csv_shifted&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data=</span>., <span class="kw">aes</span>(<span class="dt">x=</span>time_shifted, <span class="dt">y=</span>octet, <span class="dt">colour=</span>plotorder, <span class="dt">group =</span> plotid)) <span class="op">+</span></a>
<a class="sourceLine" id="cb11-4" data-line-number="4"><span class="st">  </span><span class="co">#ylab(&quot;Abs /mAU&quot;) +#xlim(c(0,1000)) +#ylim(c(-5,50)) +  #geom_vline(xintercept = mwlines, color = &quot;red&quot;, linetype=&quot;dashed&quot;, size=0.5) +</span></a>
<a class="sourceLine" id="cb11-5" data-line-number="5"><span class="st">  </span><span class="co">#geom_point(size = 2, stroke = 0.1, alpha=0.2, colour = &quot;black&quot;) +</span></a>
<a class="sourceLine" id="cb11-6" data-line-number="6"><span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">size=</span><span class="fl">0.5</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb11-7" data-line-number="7"><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="st">&quot;time: min&quot;</span>, <span class="dt">breaks =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">900</span>, <span class="dv">1800</span>, <span class="dv">2700</span>, <span class="dv">3600</span>), <span class="dt">labels =</span> <span class="cf">function</span>(breaks) breaks<span class="op">/</span><span class="dv">60</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb11-8" data-line-number="8"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="st">&quot;octet: nm&quot;</span>, <span class="dt">limits =</span> <span class="kw">c</span>(<span class="op">-</span><span class="fl">0.1</span>,<span class="dv">2</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb11-9" data-line-number="9"><span class="st">  </span><span class="co">#scale_colour_gradient2(low=&quot;green&quot;, mid = &quot;blue&quot;, high=&quot;red&quot;, midpoint = 10 ,space =&quot;Lab&quot;, trans = &quot;log2&quot;) + #,</span></a>
<a class="sourceLine" id="cb11-10" data-line-number="10"><span class="st">  </span><span class="co">#facet_grid(exprun_digit ~ .) +</span></a>
<a class="sourceLine" id="cb11-11" data-line-number="11"><span class="st">  </span><span class="kw">scale_color_aaas</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb11-12" data-line-number="12"><span class="st">  </span><span class="co">#facet_grid_paginate(index ~ rec, ncol=2, nrow=4, page = i) +</span></a>
<a class="sourceLine" id="cb11-13" data-line-number="13"><span class="st">  </span><span class="kw">theme_light</span>()</a>
<a class="sourceLine" id="cb11-14" data-line-number="14"><span class="kw">print</span>(data_dir_all_csv_comp_forteplot)</a></code></pre></div>
<p><img src="index_files/figure-html/nanobodyXcomplot-1.png" width="672" /></p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1"><span class="co">#ggsave(file=&quot;ggplot_ligand_ligand_temp.jpeg&quot;, plot=data_dir_all_csv_titrations_plot,device=&quot;jpeg&quot;)</span></a>
<a class="sourceLine" id="cb12-2" data-line-number="2"><span class="kw">ggsave</span>(<span class="dt">file=</span><span class="st">&quot;./ggplot_ligand_ligand_fortecomp.jpeg&quot;</span>, <span class="dt">device=</span><span class="st">&quot;jpeg&quot;</span>, <span class="dt">width =</span> <span class="dv">120</span>, <span class="dt">height =</span> <span class="dv">40</span>, <span class="dt">units =</span> <span class="kw">c</span>(<span class="st">&quot;mm&quot;</span>))</a>
<a class="sourceLine" id="cb12-3" data-line-number="3"><span class="co">#ggsave(file=&quot;./ggplot_ligand_ligand.ps&quot;, width = 120, height = 110, units = c(&quot;mm&quot;))</span></a></code></pre></div>
<div id="nanobodyXcomplotCaption" class="figure-box">
<p>Plot used for Figure 3A in ms. see figure legend in ms for more details.</p>
</div>
</div>
<div id="analysis-and-plotting-of-sensor-ligand-loads" class="section level2">
<h2><span class="header-section-number">1.5</span> Analysis and plotting of sensor ligand loads</h2>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" data-line-number="1"><span class="co">#define report points for sensor loads</span></a>
<a class="sourceLine" id="cb13-2" data-line-number="2">data_dir_all_pars_mod_sample_loadids &lt;-<span class="st"> </span>data_dir_all_pars_mod <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(sample, meas_type) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(sample, meas_type) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">summarize</span>() <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(., <span class="dt">load_id1 =</span> <span class="kw">case_when</span>(meas_type <span class="op">==</span><span class="st"> &quot;TIT&quot;</span> <span class="op">~</span><span class="st"> </span><span class="dv">1</span>, meas_type <span class="op">==</span><span class="st"> &quot;COMP&quot;</span> <span class="op">~</span><span class="st"> </span><span class="dv">1</span>, <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> </span><span class="dv">0</span>), <span class="dt">load_id2 =</span> <span class="kw">case_when</span>(meas_type <span class="op">==</span><span class="st"> &quot;TIT&quot;</span> <span class="op">~</span><span class="st"> </span><span class="dv">4</span>, meas_type <span class="op">==</span><span class="st"> &quot;COMP&quot;</span> <span class="op">~</span><span class="st"> </span><span class="dv">3</span>, <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> </span><span class="dv">0</span>),  <span class="dt">load_id3 =</span> <span class="kw">case_when</span>(meas_type <span class="op">==</span><span class="st"> &quot;TIT&quot;</span> <span class="op">~</span><span class="st"> </span><span class="dv">1</span>, meas_type <span class="op">==</span><span class="st"> &quot;COMP&quot;</span> <span class="op">~</span><span class="st"> </span><span class="dv">3</span>, <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> </span><span class="dv">0</span>), <span class="dt">load_id4 =</span> <span class="kw">case_when</span>(meas_type <span class="op">==</span><span class="st"> &quot;TIT&quot;</span> <span class="op">~</span><span class="st"> </span><span class="dv">4</span>, meas_type <span class="op">==</span><span class="st"> &quot;COMP&quot;</span> <span class="op">~</span><span class="st"> </span><span class="dv">6</span>, <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> </span><span class="dv">0</span>)) </a>
<a class="sourceLine" id="cb13-3" data-line-number="3"></a>
<a class="sourceLine" id="cb13-4" data-line-number="4">pull_id_times_f &lt;-<span class="st"> </span><span class="cf">function</span>(senstray_acc, load_id){</a>
<a class="sourceLine" id="cb13-5" data-line-number="5">  time &lt;-<span class="st"> </span>senstray_acc <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(., step_id <span class="op">==</span><span class="st"> </span>load_id) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(., step_time_acc) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pull</span>()</a>
<a class="sourceLine" id="cb13-6" data-line-number="6">  <span class="kw">return</span>(time)</a>
<a class="sourceLine" id="cb13-7" data-line-number="7">}</a>
<a class="sourceLine" id="cb13-8" data-line-number="8"></a>
<a class="sourceLine" id="cb13-9" data-line-number="9">data_dir_all_pars_mod_join &lt;-<span class="st"> </span>data_dir_all_pars_mod <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(., filterme <span class="op">==</span><span class="st"> </span>report_type) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(., sample, meas_type, senstray_acc) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">left_join</span>(., data_dir_all_pars_mod_sample_loadids) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(., <span class="dt">id1_time =</span> purrr<span class="op">::</span><span class="kw">pmap</span>(<span class="kw">list</span>(senstray_acc, load_id1), pull_id_times_f),<span class="dt">id2_time =</span> purrr<span class="op">::</span><span class="kw">pmap</span>(<span class="kw">list</span>(senstray_acc, load_id2), pull_id_times_f), <span class="dt">id3_time =</span> purrr<span class="op">::</span><span class="kw">pmap</span>(<span class="kw">list</span>(senstray_acc, load_id3), pull_id_times_f), <span class="dt">id4_time =</span> purrr<span class="op">::</span><span class="kw">pmap</span>(<span class="kw">list</span>(senstray_acc, load_id4), pull_id_times_f) ) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">unchop</span>(., <span class="dt">cols =</span> <span class="kw">c</span>(<span class="st">&quot;id1_time&quot;</span>, <span class="st">&quot;id2_time&quot;</span>, <span class="st">&quot;id3_time&quot;</span>, <span class="st">&quot;id4_time&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(., sample, meas_type, <span class="kw">contains</span>(<span class="st">&quot;_time&quot;</span>))</a>
<a class="sourceLine" id="cb13-10" data-line-number="10"></a>
<a class="sourceLine" id="cb13-11" data-line-number="11"><span class="co">#extract sensorloads at the defined timepoints</span></a>
<a class="sourceLine" id="cb13-12" data-line-number="12">sensor_load_pull_f &lt;-<span class="st"> </span><span class="cf">function</span>(df, id_time){</a>
<a class="sourceLine" id="cb13-13" data-line-number="13">  df_value &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(., time <span class="op">&gt;</span><span class="st"> </span>(id_time<span class="dv">-5</span>) <span class="op">&amp;</span><span class="st"> </span>time <span class="op">&lt;</span><span class="st"> </span>(id_time<span class="fl">+0.1</span>)) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">group_by</span>(., sensor) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">summarize</span>(., <span class="dt">octet_level =</span> <span class="kw">mean</span>(octet))</a>
<a class="sourceLine" id="cb13-14" data-line-number="14">  <span class="kw">return</span>(df_value)</a>
<a class="sourceLine" id="cb13-15" data-line-number="15">}</a>
<a class="sourceLine" id="cb13-16" data-line-number="16"></a>
<a class="sourceLine" id="cb13-17" data-line-number="17">data_dir_sensors_raw_xls_longer_sensorloads &lt;-<span class="st"> </span>data_dir_sensors_raw_xls_longer <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(., <span class="op">-</span>csv, <span class="op">-</span>sensor_par, <span class="op">-</span>sensor_plot, <span class="op">-</span>plot_name, <span class="op">-</span>xls_longer) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">left_join</span>(., data_dir_all_pars_mod_join) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">level_id1 =</span> purrr<span class="op">::</span><span class="kw">pmap</span>(<span class="kw">list</span>(xls_longer_sorted, id1_time), sensor_load_pull_f),<span class="dt">level_id2 =</span> purrr<span class="op">::</span><span class="kw">pmap</span>(<span class="kw">list</span>(xls_longer_sorted, id2_time), sensor_load_pull_f),<span class="dt">level_id3 =</span> purrr<span class="op">::</span><span class="kw">pmap</span>(<span class="kw">list</span>(xls_longer_sorted, id3_time), sensor_load_pull_f), <span class="dt">level_id4 =</span> purrr<span class="op">::</span><span class="kw">pmap</span>(<span class="kw">list</span>(xls_longer_sorted, id4_time), sensor_load_pull_f))</a>
<a class="sourceLine" id="cb13-18" data-line-number="18"></a>
<a class="sourceLine" id="cb13-19" data-line-number="19">combine_level_ids_f &lt;-<span class="st"> </span><span class="cf">function</span>(df1, df2, df3, df4){</a>
<a class="sourceLine" id="cb13-20" data-line-number="20">  df_combined &lt;-<span class="st"> </span>df1 <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">left_join</span>(., df2) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">left_join</span>(., df3) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">left_join</span>(., df4)</a>
<a class="sourceLine" id="cb13-21" data-line-number="21">  <span class="kw">return</span>(df_combined)</a>
<a class="sourceLine" id="cb13-22" data-line-number="22">}</a>
<a class="sourceLine" id="cb13-23" data-line-number="23"></a>
<a class="sourceLine" id="cb13-24" data-line-number="24">data_dir_sensors_raw_xls_longer_sensorloads_unnested &lt;-<span class="st"> </span>data_dir_sensors_raw_xls_longer_sensorloads <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(sample, rec, exprun_digit, meas_type, meas_driftcorr, meas_salt, <span class="kw">contains</span>(<span class="st">&quot;level&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">level_id1_rn =</span> purrr<span class="op">::</span><span class="kw">map</span>(level_id1, <span class="op">~</span>dplyr<span class="op">::</span><span class="kw">select</span>(., sensor, <span class="dt">level_id1 =</span> octet_level)), <span class="dt">level_id2_rn =</span> purrr<span class="op">::</span><span class="kw">map</span>(level_id2, <span class="op">~</span>dplyr<span class="op">::</span><span class="kw">select</span>(., sensor, <span class="dt">level_id2 =</span> octet_level)), <span class="dt">level_id3_rn =</span> purrr<span class="op">::</span><span class="kw">map</span>(level_id3, <span class="op">~</span>dplyr<span class="op">::</span><span class="kw">select</span>(., sensor, <span class="dt">level_id3 =</span> octet_level)), <span class="dt">level_id4_rn =</span> purrr<span class="op">::</span><span class="kw">map</span>(level_id4, <span class="op">~</span>dplyr<span class="op">::</span><span class="kw">select</span>(., sensor, <span class="dt">level_id4 =</span> octet_level))  ) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(., <span class="op">-</span><span class="kw">c</span>(<span class="st">&quot;level_id1&quot;</span>,<span class="st">&quot;level_id2&quot;</span>,<span class="st">&quot;level_id3&quot;</span>,<span class="st">&quot;level_id4&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">level_ids =</span> purrr<span class="op">::</span><span class="kw">pmap</span>(<span class="kw">list</span>(level_id1_rn, level_id2_rn, level_id3_rn, level_id4_rn), combine_level_ids_f)) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">level_ids_diff =</span> purrr<span class="op">::</span><span class="kw">map</span>(level_ids,  <span class="op">~</span>dplyr<span class="op">::</span><span class="kw">mutate</span>(., <span class="dt">diff_id1 =</span> level_id2 <span class="op">-</span><span class="st"> </span>level_id1, <span class="dt">diff_id3 =</span> level_id4 <span class="op">-</span><span class="st"> </span>level_id3) )) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(., sample, rec, exprun_digit, meas_type, <span class="kw">contains</span>(<span class="st">&quot;meas_&quot;</span>), level_ids_diff) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">unnest</span>(., <span class="kw">c</span>(<span class="st">&quot;level_ids_diff&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(., <span class="dt">plotname =</span> <span class="st">&quot;sensors&quot;</span>)</a></code></pre></div>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" data-line-number="1">data_dir_sensorloads_sel_plot &lt;-<span class="st"> </span>data_dir_sensors_raw_xls_longer_sensorloads_unnested <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(meas_type <span class="op">==</span><span class="st"> &quot;TIT&quot;</span> <span class="op">&amp;</span><span class="st"> </span>exprun_digit <span class="op">&gt;</span><span class="st"> </span><span class="dv">802</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">ggplot</span>(., <span class="kw">aes</span>(<span class="dt">x =</span> plotname, <span class="dt">y =</span> diff_id1)) <span class="op">+</span></a>
<a class="sourceLine" id="cb14-2" data-line-number="2"><span class="st">  </span><span class="kw">geom_boxplot</span>(<span class="dt">position =</span> <span class="st">&quot;identity&quot;</span>, <span class="dt">outlier.shape =</span> <span class="ot">NA</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb14-3" data-line-number="3"><span class="st">  </span><span class="kw">geom_jitter</span>(<span class="dt">stat =</span> <span class="st">&quot;identity&quot;</span>, <span class="dt">width =</span> <span class="fl">0.1</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb14-4" data-line-number="4"><span class="st">  </span><span class="kw">facet_grid</span>(exprun_digit <span class="op">~</span><span class="st"> </span>., <span class="dt">scales =</span> <span class="st">&quot;free_y&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb14-5" data-line-number="5"><span class="st">  </span><span class="kw">scale_color_aaas</span>()  <span class="op">+</span></a>
<a class="sourceLine" id="cb14-6" data-line-number="6"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">name =</span> <span class="ot">NULL</span>, <span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">0.5</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb14-7" data-line-number="7"><span class="st">  </span><span class="kw">theme_light</span>()</a>
<a class="sourceLine" id="cb14-8" data-line-number="8"><span class="kw">print</span>(data_dir_sensorloads_sel_plot)</a></code></pre></div>
<p><img src="index_files/figure-html/PlotSensorLoadsTitration-1.png" width="672" /></p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" data-line-number="1"><span class="kw">ggsave</span>(<span class="st">&quot;./sensorload_all_sel.jpeg&quot;</span>, data_dir_sensorloads_sel_plot,  <span class="dt">device=</span><span class="st">&quot;jpeg&quot;</span>, <span class="dt">width =</span> <span class="dv">40</span>, <span class="dt">height =</span> <span class="dv">80</span>, <span class="dt">units =</span> <span class="kw">c</span>(<span class="st">&quot;mm&quot;</span>))</a></code></pre></div>
<div id="PlotSensorLoadsTitrationCaption" class="figure-box">
<p>Sensor Loads of titration experiments. Used for Figures 3B and supplemental Figure 2A. see figure legend in ms for more details.</p>
</div>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" data-line-number="1">sensor_spec_nested_comp &lt;-<span class="st"> </span>sensor_spec_nested <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(., meas_type <span class="op">==</span><span class="st"> &quot;COMP&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">unnest</span>(sensor_par) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(., meas_type, meas_driftcorr, sensor, ligand, analyte) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">summarize</span>() <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(sensor, ligand, analyte)</a>
<a class="sourceLine" id="cb16-2" data-line-number="2"></a>
<a class="sourceLine" id="cb16-3" data-line-number="3">data_dir_sensors_raw_xls_longer_sensorloads_unnested_comp &lt;-<span class="st"> </span>data_dir_sensors_raw_xls_longer_sensorloads_unnested <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(., meas_type <span class="op">==</span><span class="st"> &quot;COMP&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(., <span class="kw">c</span>(sample, rec, exprun_digit, sensor, diff_id1, diff_id3)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">left_join</span>(., sensor_spec_nested_comp) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(., <span class="dt">sensorgroup =</span> <span class="kw">case_when</span>(sensor <span class="op">==</span><span class="st"> &quot;A&quot;</span> <span class="op">~</span><span class="st"> &quot;AD&quot;</span>, sensor <span class="op">==</span><span class="st"> &quot;B&quot;</span> <span class="op">~</span><span class="st"> &quot;AD&quot;</span>, sensor <span class="op">==</span><span class="st"> &quot;C&quot;</span> <span class="op">~</span><span class="st"> &quot;AD&quot;</span>, sensor <span class="op">==</span><span class="st"> &quot;D&quot;</span> <span class="op">~</span><span class="st"> &quot;AD&quot;</span>,sensor <span class="op">==</span><span class="st"> &quot;E&quot;</span> <span class="op">~</span><span class="st"> &quot;EH&quot;</span>, sensor <span class="op">==</span><span class="st"> &quot;F&quot;</span> <span class="op">~</span><span class="st"> &quot;EH&quot;</span>, sensor <span class="op">==</span><span class="st"> &quot;G&quot;</span> <span class="op">~</span><span class="st"> &quot;EH&quot;</span>, sensor <span class="op">==</span><span class="st"> &quot;H&quot;</span> <span class="op">~</span><span class="st"> &quot;EH&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(., <span class="dt">diff_id =</span> <span class="kw">case_when</span>(sensorgroup <span class="op">==</span><span class="st"> &quot;AD&quot;</span> <span class="op">~</span><span class="st"> </span>diff_id1, sensorgroup <span class="op">==</span><span class="st"> &quot;EH&quot;</span> <span class="op">~</span><span class="st"> </span>diff_id3, <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> </span><span class="dv">0</span>))</a>
<a class="sourceLine" id="cb16-4" data-line-number="4"></a>
<a class="sourceLine" id="cb16-5" data-line-number="5">data_dir_sensorloads_comp_plot &lt;-<span class="st"> </span>data_dir_sensors_raw_xls_longer_sensorloads_unnested_comp <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(., <span class="dt">plotorder =</span> <span class="kw">case_when</span>(ligand <span class="op">==</span><span class="st"> &quot;nbTy1&quot;</span> <span class="op">~</span><span class="st"> &quot;id2:nbTy1&quot;</span>, ligand <span class="op">==</span><span class="st"> &quot;NP-VHH1&quot;</span> <span class="op">~</span><span class="st"> &quot;id1:NP-VHH1&quot;</span>, ligand <span class="op">==</span><span class="st"> &quot;SAX&quot;</span> <span class="op">~</span><span class="st"> &quot;id3: SAX&quot;</span>, <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> &quot;none&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(., ligand <span class="op">!=</span><span class="st"> &quot;SAX&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">ggplot</span>(., <span class="kw">aes</span>(<span class="dt">x =</span> ligand, <span class="dt">y =</span> diff_id)) <span class="op">+</span></a>
<a class="sourceLine" id="cb16-6" data-line-number="6"><span class="st">  </span><span class="kw">geom_boxplot</span>(<span class="dt">position =</span> <span class="st">&quot;identity&quot;</span>, <span class="dt">outlier.shape =</span> <span class="ot">NA</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb16-7" data-line-number="7"><span class="st">  </span><span class="kw">geom_jitter</span>(<span class="kw">aes</span>(<span class="dt">colour =</span> plotorder), <span class="dt">stat =</span> <span class="st">&quot;identity&quot;</span>, <span class="dt">width =</span> <span class="fl">0.1</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb16-8" data-line-number="8"><span class="st">  </span><span class="kw">facet_grid</span>(. <span class="op">~</span><span class="st"> </span>., <span class="dt">scales =</span> <span class="st">&quot;free_y&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb16-9" data-line-number="9"><span class="st">  </span><span class="kw">scale_color_aaas</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb16-10" data-line-number="10"><span class="st">  </span><span class="kw">scale_x_discrete</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb16-11" data-line-number="11"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">name =</span> <span class="ot">NULL</span>, <span class="dt">labels =</span> <span class="ot">NULL</span>, <span class="dt">limits =</span> <span class="kw">c</span>(<span class="op">-</span><span class="fl">0.1</span>,<span class="dv">2</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb16-12" data-line-number="12"><span class="st">  </span><span class="kw">theme_light</span>()</a>
<a class="sourceLine" id="cb16-13" data-line-number="13"><span class="kw">print</span>(data_dir_sensorloads_comp_plot)</a></code></pre></div>
<p><img src="index_files/figure-html/PlotSensorLoadsComp-1.png" width="672" /></p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" data-line-number="1"><span class="kw">ggsave</span>(<span class="st">&quot;./sensorload_all_comp.jpeg&quot;</span>, data_dir_sensorloads_comp_plot,  <span class="dt">device=</span><span class="st">&quot;jpeg&quot;</span>, <span class="dt">width =</span> <span class="dv">60</span>, <span class="dt">height =</span> <span class="dv">120</span>, <span class="dt">units =</span> <span class="kw">c</span>(<span class="st">&quot;mm&quot;</span>))</a></code></pre></div>
<div id="PlotSensorLoadsCompCaption" class="figure-box">
<p>Sensor Loads of comparative experiments. Used for Figure 3A. see ms figure legend in ms for more details.</p>
</div>
</div>
<div id="fitting-and-plotting-pseudo-equilibrium-data" class="section level2">
<h2><span class="header-section-number">1.6</span> Fitting and plotting pseudo-equilibrium data</h2>
<p>Pseudo-eq binding data were fit using the Hill equation, taken from <span class="citation">(Gadagkar and Call 2015)</span>:</p>
<p><span class="math display" id="eq:hill">\[\begin{equation}
octet_{eq} = octet_0 + \frac{octet_{max} - octet_0}{1+[\frac{EC50}{conc}]^{hslope} }
\tag{1.1}
\end{equation}\]</span></p>
<p>and a simple Langmuir isotherm, eq taken from <span class="citation">(O’Shannessy and Winzor 1996)</span></p>
<p><span class="math display" id="eq:langmuir">\[\begin{equation}
octet_{eq} = \frac{octet_{max}*conc}{Kd + conc}
\tag{1.2}
\end{equation}\]</span></p>
<p>with <span class="math inline">\(octet_{eq}\)</span> as pseude-equilibrium values, <span class="math inline">\(octet_0\)</span> as response at zero analyte concentration, <span class="math inline">\(EC50\)</span> and <span class="math inline">\(Kd\)</span> as half-maximum response and affinity, respectively, <span class="math inline">\(conc\)</span> as analyte concentration, and <span class="math inline">\(hslope\)</span> as the hill slope.</p>
<p>Data fitting chunk:</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" data-line-number="1"><span class="co"># Hill-fit https://doi.org/10.1016/j.vascn.2014.08.006</span></a>
<a class="sourceLine" id="cb18-2" data-line-number="2"><span class="co"># Myszka (1996) Analytical BIochemistry: Equilibrium Analysis of High Affinity Interactions Using BIACORE </span></a>
<a class="sourceLine" id="cb18-3" data-line-number="3"><span class="co"># O’Shannessy, D J, and D J Winzor. 1996. “Interpretation of Deviations from Pseudo-First-Order Kinetic Behavior in the Characterization of Ligand Binding by  Biosensor Technology.” Analytical Biochemistry 236 (2): 275–83. https://doi.org/10.1006/abio.1996.0167.</span></a>
<a class="sourceLine" id="cb18-4" data-line-number="4"></a>
<a class="sourceLine" id="cb18-5" data-line-number="5"></a>
<a class="sourceLine" id="cb18-6" data-line-number="6">norm_purrr_f &lt;-<span class="st"> </span><span class="cf">function</span>(df){</a>
<a class="sourceLine" id="cb18-7" data-line-number="7">  octet_max &lt;-<span class="st"> </span><span class="fl">0.7</span> <span class="co">#max(octet_eq)</span></a>
<a class="sourceLine" id="cb18-8" data-line-number="8">  df_norm &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(., <span class="dt">octet_norm =</span> ((octet_eq<span class="op">-</span><span class="kw">min</span>(octet_eq))<span class="op">/</span>(octet_max<span class="op">-</span><span class="kw">min</span>(octet_eq))), <span class="dt">conc_nM_dimer =</span> conc_nM<span class="op">/</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb18-9" data-line-number="9">  <span class="kw">return</span>(df_norm)</a>
<a class="sourceLine" id="cb18-10" data-line-number="10">}</a>
<a class="sourceLine" id="cb18-11" data-line-number="11"></a>
<a class="sourceLine" id="cb18-12" data-line-number="12">nlsLM_KD_f &lt;-<span class="st"> </span><span class="cf">function</span>(data, Rstart, Rminlim, Rmaxlim){</a>
<a class="sourceLine" id="cb18-13" data-line-number="13">fit_obj &lt;-<span class="st">  </span><span class="kw">nlsLM</span>(octet_eq <span class="op">~</span><span class="st"> </span>(R<span class="op">*</span>conc_nM<span class="op">/</span>(KD_eq<span class="op">+</span>conc_nM)), <span class="dt">start =</span> <span class="kw">list</span>(<span class="dt">R=</span>Rstart,<span class="dt">KD_eq=</span><span class="dv">10</span>), <span class="dt">lower=</span><span class="kw">c</span>(Rminlim,<span class="dv">1</span>), <span class="dt">upper=</span><span class="kw">c</span>(Rmaxlim,<span class="ot">Inf</span>), <span class="dt">data=</span>data, <span class="dt">weights =</span> (<span class="dv">1</span><span class="op">/</span>octet_eq))</a>
<a class="sourceLine" id="cb18-14" data-line-number="14"><span class="kw">return</span>(fit_obj)</a>
<a class="sourceLine" id="cb18-15" data-line-number="15">}</a>
<a class="sourceLine" id="cb18-16" data-line-number="16"></a>
<a class="sourceLine" id="cb18-17" data-line-number="17">nlsLM_Hill_f &lt;-<span class="st"> </span><span class="cf">function</span>(data, Rstart, Rminlim, Rmaxlim){</a>
<a class="sourceLine" id="cb18-18" data-line-number="18">  fit_obj &lt;-<span class="st"> </span><span class="kw">nlsLM</span>(octet_eq <span class="op">~</span><span class="st"> </span>(octet_zero<span class="op">+</span>(octet_max<span class="op">-</span>octet_zero)<span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>(EC50<span class="op">/</span>conc_nM)<span class="op">^</span>hslope ) ), <span class="dt">start =</span> <span class="kw">list</span>(<span class="dt">octet_max=</span>Rstart, <span class="dt">octet_zero=</span><span class="dv">0</span>, <span class="dt">EC50=</span><span class="dv">10</span>,<span class="dt">hslope=</span><span class="dv">1</span>), <span class="dt">lower=</span><span class="kw">c</span>(Rminlim, <span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.3</span>), <span class="dt">upper=</span><span class="kw">c</span>(Rmaxlim, <span class="dv">0</span>, <span class="dv">100</span>, <span class="fl">1.5</span>), <span class="dt">data=</span>data, <span class="dt">weights =</span> (<span class="dv">1</span><span class="op">/</span>octet_eq))</a>
<a class="sourceLine" id="cb18-19" data-line-number="19">  <span class="kw">return</span>(fit_obj)</a>
<a class="sourceLine" id="cb18-20" data-line-number="20">}</a>
<a class="sourceLine" id="cb18-21" data-line-number="21"></a>
<a class="sourceLine" id="cb18-22" data-line-number="22"></a>
<a class="sourceLine" id="cb18-23" data-line-number="23">data_pall_csv_conc_titrations_ligand_eq_fit &lt;-<span class="st"> </span>data_pall_csv_conc_titrations_ligand_eq <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>csv_shifted, <span class="op">-</span>csv_shifted_eqphase) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(exprun_digit) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_modify</span>(.,  <span class="op">~</span><span class="kw">mutate</span>(.,<span class="dt">Rstart=</span><span class="kw">max</span>(octet_eq))) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_modify</span>(.,  <span class="op">~</span><span class="kw">mutate</span>(.,<span class="dt">Rmaxlim=</span>Rstart<span class="fl">+0.2</span><span class="op">*</span>Rstart, <span class="dt">Rminlim=</span>Rstart<span class="fl">-0.2</span><span class="op">*</span>Rstart )) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(exprun_digit, rec, meas_type, sample, ligand, meas_driftcorr, meas_salt, Rstart, Rmaxlim, Rminlim) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">nest</span>() <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">eq_KD_fit =</span> purrr<span class="op">::</span><span class="kw">pmap</span>(<span class="kw">list</span>(data, Rstart, Rminlim, Rmaxlim), nlsLM_KD_f)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">KD_results =</span> <span class="kw">map</span>(eq_KD_fit, augment)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">eq_Hill_fit =</span> purrr<span class="op">::</span><span class="kw">pmap</span>(<span class="kw">list</span>(data, Rstart, Rminlim, Rmaxlim), nlsLM_Hill_f)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">hill_results =</span> <span class="kw">map</span>(eq_Hill_fit, augment)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">kd_results =</span> <span class="kw">map</span>(eq_KD_fit, augment)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">kd_pars =</span> <span class="kw">map</span>(eq_KD_fit, tidy)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">hill_pars =</span> <span class="kw">map</span>(eq_Hill_fit, tidy)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">hill_results_mod =</span> purrr<span class="op">::</span><span class="kw">map</span>(hill_results, <span class="op">~</span>dplyr<span class="op">::</span><span class="kw">select</span>(., octet_eq, conc_nM, <span class="dt">hill_fit =</span> <span class="st">&quot;.fitted&quot;</span>))) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">kd_results_mod =</span> purrr<span class="op">::</span><span class="kw">map</span>(kd_results, <span class="op">~</span>dplyr<span class="op">::</span><span class="kw">select</span>(., octet_eq, conc_nM, <span class="dt">kd_fit =</span> <span class="st">&quot;.fitted&quot;</span>)))</a>
<a class="sourceLine" id="cb18-24" data-line-number="24"></a>
<a class="sourceLine" id="cb18-25" data-line-number="25"><span class="co">### write fit parameters as csv files</span></a>
<a class="sourceLine" id="cb18-26" data-line-number="26">data_pall_csv_conc_titrations_ligand_eq_fit_pars_table &lt;-<span class="st"> </span>data_pall_csv_conc_titrations_ligand_eq_fit <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(., <span class="dt">hill_pars_long =</span> purrr<span class="op">::</span><span class="kw">map</span>(hill_pars, <span class="op">~</span><span class="kw">pivot_longer</span>(., <span class="dv">2</span><span class="op">:</span><span class="dv">5</span>, <span class="dt">names_to =</span> <span class="st">&quot;hill_stats&quot;</span>, <span class="dt">values_to =</span> <span class="st">&quot;hill_stats_value&quot;</span>)), <span class="dt">kd_pars_long =</span> purrr<span class="op">::</span><span class="kw">map</span>(kd_pars, <span class="op">~</span><span class="kw">pivot_longer</span>(., <span class="dv">2</span><span class="op">:</span><span class="dv">5</span>, <span class="dt">names_to =</span> <span class="st">&quot;kd_stats&quot;</span>, <span class="dt">values_to =</span> <span class="st">&quot;kd_stats_value&quot;</span>)) ) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(., <span class="dt">hill_pars_long_names =</span> purrr<span class="op">::</span><span class="kw">map</span>(hill_pars_long, <span class="op">~</span>dplyr<span class="op">::</span><span class="kw">select</span>(., <span class="dt">hill_term =</span> term, <span class="dv">2</span><span class="op">:</span><span class="dv">3</span>)), <span class="dt">kd_pars_long_names =</span> purrr<span class="op">::</span><span class="kw">map</span>(kd_pars_long, <span class="op">~</span>dplyr<span class="op">::</span><span class="kw">select</span>(., <span class="dt">kd_term =</span> term, <span class="dv">2</span><span class="op">:</span><span class="dv">3</span>)) )<span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(rec, hill_pars_long_names, kd_pars_long_names)</a>
<a class="sourceLine" id="cb18-27" data-line-number="27"></a>
<a class="sourceLine" id="cb18-28" data-line-number="28"><span class="co">###Hill vline estimates</span></a>
<a class="sourceLine" id="cb18-29" data-line-number="29">data_pall_csv_conc_titrations_ligand_eq_fit_hill_estimate &lt;-<span class="st"> </span>data_pall_csv_conc_titrations_ligand_eq_fit_pars_table <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(., hill_pars_long_names) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">unnest</span>(., <span class="kw">c</span>(<span class="st">&quot;hill_pars_long_names&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(., (hill_term <span class="op">==</span><span class="st"> &quot;EC50&quot;</span> <span class="op">|</span><span class="st"> </span>hill_term <span class="op">==</span><span class="st"> &quot;hslope&quot;</span>)  <span class="op">&amp;</span><span class="st"> </span>(hill_stats <span class="op">==</span><span class="st"> &quot;estimate&quot;</span> <span class="op">|</span><span class="st"> </span>hill_stats <span class="op">==</span><span class="st"> &quot;std.error&quot;</span>))</a>
<a class="sourceLine" id="cb18-30" data-line-number="30"></a>
<a class="sourceLine" id="cb18-31" data-line-number="31">data_pall_csv_conc_titrations_ligand_eq_fit_hill_estimate_vline &lt;-<span class="st"> </span>data_pall_csv_conc_titrations_ligand_eq_fit_hill_estimate <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pivot_wider</span>(., <span class="dt">id_cols =</span> <span class="kw">c</span>(<span class="st">&quot;sample&quot;</span>, <span class="st">&quot;hill_term&quot;</span>), <span class="dt">names_from =</span> <span class="kw">c</span>(<span class="st">&quot;hill_stats&quot;</span>), <span class="dt">values_from =</span> <span class="kw">c</span>(<span class="st">&quot;hill_stats_value&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(., hill_term <span class="op">==</span><span class="st"> &quot;EC50&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(., <span class="dt">vline_estimate =</span> estimate, <span class="dt">vline_plus =</span> estimate<span class="op">+</span>std.error, <span class="dt">vline_minus =</span> estimate<span class="op">-</span>std.error) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(., <span class="op">-</span>hill_term, <span class="op">-</span>std.error, <span class="op">-</span>estimate) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pivot_longer</span>(., <span class="kw">c</span>(<span class="dv">2</span><span class="op">:</span><span class="kw">ncol</span>(.))) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(., sample, <span class="dt">vline_name =</span> name, <span class="dt">vline_value =</span> value) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(., <span class="dt">vline_size =</span> <span class="kw">case_when</span>(vline_name <span class="op">==</span><span class="st"> &quot;vline_estimate&quot;</span> <span class="op">~</span><span class="st"> </span><span class="dv">2</span>, vline_name <span class="op">==</span><span class="st"> &quot;vline_plus&quot;</span> <span class="op">~</span><span class="st"> </span><span class="dv">1</span>, vline_name <span class="op">==</span><span class="st"> &quot;vline_minus&quot;</span> <span class="op">~</span><span class="st"> </span><span class="dv">1</span>))</a>
<a class="sourceLine" id="cb18-32" data-line-number="32"></a>
<a class="sourceLine" id="cb18-33" data-line-number="33"><span class="co">### KD vline estimates </span></a>
<a class="sourceLine" id="cb18-34" data-line-number="34">data_pall_csv_conc_titrations_ligand_eq_fit_kd_estimate &lt;-<span class="st"> </span>data_pall_csv_conc_titrations_ligand_eq_fit_pars_table <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(., kd_pars_long_names) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">unnest</span>(., <span class="kw">c</span>(<span class="st">&quot;kd_pars_long_names&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(., (kd_term <span class="op">==</span><span class="st"> &quot;KD_eq&quot;</span>)  <span class="op">&amp;</span><span class="st"> </span>(kd_stats <span class="op">==</span><span class="st"> &quot;estimate&quot;</span> <span class="op">|</span><span class="st"> </span>kd_stats <span class="op">==</span><span class="st"> &quot;std.error&quot;</span>))</a>
<a class="sourceLine" id="cb18-35" data-line-number="35"></a>
<a class="sourceLine" id="cb18-36" data-line-number="36"></a>
<a class="sourceLine" id="cb18-37" data-line-number="37">data_pall_csv_conc_titrations_ligand_eq_fit_kd_estimate_vline &lt;-<span class="st"> </span>data_pall_csv_conc_titrations_ligand_eq_fit_kd_estimate <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pivot_wider</span>(., <span class="dt">id_cols =</span> <span class="kw">c</span>(<span class="st">&quot;sample&quot;</span>, <span class="st">&quot;kd_term&quot;</span>), <span class="dt">names_from =</span> <span class="kw">c</span>(<span class="st">&quot;kd_stats&quot;</span>), <span class="dt">values_from =</span> <span class="kw">c</span>(<span class="st">&quot;kd_stats_value&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(., kd_term <span class="op">==</span><span class="st"> &quot;KD_eq&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(., <span class="dt">vline_estimate =</span> estimate, <span class="dt">vline_plus =</span> estimate<span class="op">+</span>std.error, <span class="dt">vline_minus =</span> estimate<span class="op">-</span>std.error) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(., <span class="op">-</span>kd_term, <span class="op">-</span>std.error, <span class="op">-</span>estimate) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pivot_longer</span>(., <span class="kw">c</span>(<span class="dv">2</span><span class="op">:</span><span class="kw">ncol</span>(.))) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(., sample, <span class="dt">vline_name =</span> name, <span class="dt">vline_value =</span> value) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(., <span class="dt">vline_size =</span> <span class="kw">case_when</span>(vline_name <span class="op">==</span><span class="st"> &quot;vline_estimate&quot;</span> <span class="op">~</span><span class="st"> </span><span class="dv">2</span>, vline_name <span class="op">==</span><span class="st"> &quot;vline_plus&quot;</span> <span class="op">~</span><span class="st"> </span><span class="dv">1</span>, vline_name <span class="op">==</span><span class="st"> &quot;vline_minus&quot;</span> <span class="op">~</span><span class="st"> </span><span class="dv">1</span>))</a>
<a class="sourceLine" id="cb18-38" data-line-number="38"></a>
<a class="sourceLine" id="cb18-39" data-line-number="39"></a>
<a class="sourceLine" id="cb18-40" data-line-number="40">data_pall_csv_conc_titrations_ligand_eq_fit_pars_table <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(., hill_pars_long_names) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">unnest</span>(., <span class="kw">c</span>(<span class="st">&quot;hill_pars_long_names&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">write_csv2</span>(.,<span class="dt">path =</span> <span class="st">&quot;./ggplot_ligand_titrations_eqconc_fit_hill_pars.csv&quot;</span>)</a>
<a class="sourceLine" id="cb18-41" data-line-number="41"></a>
<a class="sourceLine" id="cb18-42" data-line-number="42">data_pall_csv_conc_titrations_ligand_eq_fit_pars_table <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(., kd_pars_long_names) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">unnest</span>(., <span class="kw">c</span>(<span class="st">&quot;kd_pars_long_names&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">write_csv2</span>(.,<span class="dt">path =</span> <span class="st">&quot;./ggplot_ligand_titrations_eqconc_fit_kd_pars.csv&quot;</span>)</a></code></pre></div>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" data-line-number="1"><span class="co">###plot Kd, Hill fit</span></a>
<a class="sourceLine" id="cb19-2" data-line-number="2">data_pall_csv_conc_titrations_ligand_eq_fit_kd &lt;-<span class="st"> </span>data_pall_csv_conc_titrations_ligand_eq_fit <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(rec, kd_results_mod) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">unnest</span>(kd_results_mod)                  </a>
<a class="sourceLine" id="cb19-3" data-line-number="3">data_pall_csv_conc_titrations_ligand_eq_fit_hill &lt;-<span class="st">  </span>data_pall_csv_conc_titrations_ligand_eq_fit <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(rec, hill_results_mod) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">unnest</span>(., hill_results_mod)</a>
<a class="sourceLine" id="cb19-4" data-line-number="4"></a>
<a class="sourceLine" id="cb19-5" data-line-number="5">data_pall_csv_conc_titrations_ligand_eq_fit_kd_hill &lt;-<span class="st"> </span>data_pall_csv_conc_titrations_ligand_eq_fit_kd <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">left_join</span>(.,data_pall_csv_conc_titrations_ligand_eq_fit_hill)</a>
<a class="sourceLine" id="cb19-6" data-line-number="6"></a>
<a class="sourceLine" id="cb19-7" data-line-number="7"></a>
<a class="sourceLine" id="cb19-8" data-line-number="8">data_pall_csv_conc_titrations_ligand_eq_fit_kd_plot_selected &lt;-<span class="st"> </span>data_pall_csv_conc_titrations_ligand_eq_fit_kd_hill <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">left_join</span>(., data_pall_csv_conc_titrations_ligand_eq_fit_kd_estimate_vline) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(., <span class="dt">octet =</span> octet_eq) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data=</span>., <span class="kw">aes</span>(<span class="dt">x=</span>conc_nM, <span class="dt">y=</span>octet, <span class="dt">color=</span>rec)) <span class="op">+</span><span class="st">  </span><span class="co">#xlab(&quot;Vol /mL&quot;) + #ylab(&quot;Abs /mAU&quot;) +#xlim(c(0,1000)) +#ylim(c(-5,50)) +  #geom_vline(xintercept = mwlines, color = &quot;red&quot;, linetype=&quot;dashed&quot;, size=0.5) +</span></a>
<a class="sourceLine" id="cb19-9" data-line-number="9"><span class="st">   </span><span class="kw">geom_point</span>(<span class="dt">size =</span> <span class="dv">2</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb19-10" data-line-number="10"><span class="st">  </span><span class="co">#geom_line(aes(x=conc_nM_dimer, y=kd_fit)) +</span></a>
<a class="sourceLine" id="cb19-11" data-line-number="11"><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">x=</span>conc_nM, <span class="dt">y=</span>kd_fit)) <span class="op">+</span></a>
<a class="sourceLine" id="cb19-12" data-line-number="12"><span class="st">  </span><span class="kw">scale_x_log10</span>(<span class="dt">breaks =</span> <span class="kw">c</span>(<span class="dv">10</span><span class="op">^-</span><span class="dv">3</span>, <span class="dv">10</span><span class="op">^-</span><span class="dv">2</span>, <span class="dv">10</span><span class="op">^-</span><span class="dv">1</span>, <span class="dv">10</span><span class="op">^</span><span class="dv">0</span>, <span class="dv">10</span><span class="op">^</span><span class="dv">1</span>, <span class="dv">10</span><span class="op">^</span><span class="dv">2</span>, <span class="dv">10</span><span class="op">^</span><span class="dv">3</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb19-13" data-line-number="13"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">name =</span> <span class="ot">NULL</span>, <span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">0.5</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb19-14" data-line-number="14"><span class="st">    </span><span class="co">#scale_color_gradient2(low=&quot;green&quot;, mid=&quot;blue&quot;, high=&quot;red&quot;, space =&quot;Lab&quot;,midpoint=3, trans = &quot;log10&quot;) + #,</span></a>
<a class="sourceLine" id="cb19-15" data-line-number="15"><span class="kw">facet_grid</span>(exprun_digit <span class="op">~</span><span class="st"> </span>.) <span class="op">+</span></a>
<a class="sourceLine" id="cb19-16" data-line-number="16"><span class="st">  </span><span class="kw">scale_color_aaas</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb19-17" data-line-number="17"><span class="st">  </span><span class="kw">geom_vline</span>(<span class="kw">aes</span>(<span class="dt">xintercept =</span> vline_value, <span class="dt">linetype =</span> <span class="kw">factor</span>(vline_size<span class="op">*-</span><span class="dv">1</span>))) <span class="op">+</span></a>
<a class="sourceLine" id="cb19-18" data-line-number="18"><span class="st">  </span><span class="kw">theme_light</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb19-19" data-line-number="19"><span class="st">  </span><span class="co">#theme(legend.position = &quot;none&quot;) +</span></a>
<a class="sourceLine" id="cb19-20" data-line-number="20"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>, <span class="dt">strip.background =</span> <span class="kw">element_blank</span>(), <span class="dt">strip.text.y =</span> <span class="kw">element_blank</span>()) </a>
<a class="sourceLine" id="cb19-21" data-line-number="21"><span class="kw">print</span>(data_pall_csv_conc_titrations_ligand_eq_fit_kd_plot_selected)</a></code></pre></div>
<p><img src="index_files/figure-html/PlotKdHillEQfits-1.png" width="672" /></p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" data-line-number="1"><span class="kw">ggsave</span>(<span class="dt">file=</span><span class="st">&quot;ggplot_ligand_titrations_eqconc_kdfit_selected.jpeg&quot;</span>, <span class="dt">plot=</span>data_pall_csv_conc_titrations_ligand_eq_fit_kd_plot_selected,<span class="dt">device=</span><span class="st">&quot;jpeg&quot;</span>, <span class="dt">width =</span> <span class="dv">60</span>, <span class="dt">height =</span> <span class="dv">80</span>, <span class="dt">units =</span> <span class="kw">c</span>(<span class="st">&quot;mm&quot;</span>))</a></code></pre></div>
<div id="OctetEQFitsCaption" class="figure-box">
<p>Only the simple Langmuir fit was shown in Figures 3B and supplementary Figure 2A. see figure legend in ms for more details.</p>
</div>
</div>
<div id="fits-of-the-sensorgrams-using-11-local-fit-as-implemented-in-fortebio-software" class="section level2">
<h2><span class="header-section-number">1.7</span> Fits of the sensorgrams using 1:1 local fit as implemented in ForteBio software</h2>
<p>Chunk to import data including local fits.
Kinetic fitting data were exported in the same txt files comprising data with fits. The fit parameters listed in the file were used to calculate KD and kon dissociation constants according to <a href="http://csbi.mit.edu/instrumentation/ForteBio_App_Note_14.pdf" class="uri">http://csbi.mit.edu/instrumentation/ForteBio_App_Note_14.pdf</a></p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" data-line-number="1">data_dir_all_kinetics &lt;-<span class="st"> </span>data_dir_all <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(., dirname, sample, rec, exprun_digit, filterme, <span class="kw">contains</span>(<span class="st">&quot;meas_&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(., sample, dirname, rec, exprun_digit, filterme, meas_type, meas_driftcorr, meas_salt) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">summarize</span>() <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(., <span class="dt">csv_kinfolder =</span> <span class="kw">paste</span>(dirname, <span class="st">&quot;Results_kd&quot;</span>, filterme, <span class="dt">sep =</span> <span class="st">&quot;&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">csv_kinfilelist =</span> purrr<span class="op">::</span><span class="kw">map</span>(csv_kinfolder, <span class="op">~</span><span class="kw">list.files</span>(<span class="dt">path =</span> ., <span class="dt">pattern =</span> <span class="st">&quot;*.txt&quot;</span>,<span class="dt">recursive =</span> <span class="ot">FALSE</span>))) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">unnest</span>(., csv_kinfilelist) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(., <span class="dt">csv_kinfilereadme =</span> <span class="kw">paste</span>(csv_kinfolder, <span class="st">&quot;/&quot;</span> , csv_kinfilelist, <span class="dt">sep =</span> <span class="st">&quot;&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">csv =</span> purrr<span class="op">::</span><span class="kw">map</span>(csv_kinfilereadme,<span class="op">~</span><span class="kw">read_tsv</span>(.,<span class="dt">skip=</span><span class="dv">8</span>, <span class="dt">col_names =</span> <span class="kw">c</span>(<span class="st">&quot;time&quot;</span>,<span class="st">&quot;octet&quot;</span>,<span class="st">&quot;simulated&quot;</span>))) ) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">csv_shifted =</span> purrr<span class="op">::</span><span class="kw">map</span>(csv,<span class="op">~</span>dplyr<span class="op">::</span><span class="kw">mutate</span>(.,<span class="dt">time_shifted =</span> time <span class="op">-</span><span class="st"> </span><span class="kw">min</span>(time)))) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>csv) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">csv_shifted_rmsd =</span> purrr<span class="op">::</span><span class="kw">map</span>(csv_shifted,<span class="op">~</span>dplyr<span class="op">::</span><span class="kw">mutate</span>(.,<span class="dt">residuals =</span> simulated <span class="op">-</span><span class="st"> </span>octet))) </a>
<a class="sourceLine" id="cb21-2" data-line-number="2"></a>
<a class="sourceLine" id="cb21-3" data-line-number="3">data_dir_all_kinetics_parsimport &lt;-<span class="st"> </span>data_dir_all_kinetics <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">fitpars =</span> purrr<span class="op">::</span><span class="kw">map</span>(csv_kinfilereadme,<span class="op">~</span><span class="kw">read_tsv</span>(.,<span class="dt">skip=</span><span class="dv">0</span>, <span class="dt">col_names =</span> <span class="kw">c</span>(<span class="st">&quot;fitparameter&quot;</span>,<span class="st">&quot;value&quot;</span>), <span class="dt">n_max =</span> <span class="dv">7</span>)) ) </a>
<a class="sourceLine" id="cb21-4" data-line-number="4"></a>
<a class="sourceLine" id="cb21-5" data-line-number="5">data_dir_all_kinetics_pars &lt;-<span class="st"> </span>data_dir_all_kinetics_parsimport <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">fitpars_wide =</span> purrr<span class="op">::</span><span class="kw">map</span>(fitpars, <span class="op">~</span><span class="kw">pivot_wider</span>(., <span class="dt">names_from =</span> <span class="kw">c</span>(<span class="st">&quot;fitparameter&quot;</span>), <span class="dt">values_from =</span> <span class="kw">c</span>(<span class="st">&quot;value&quot;</span>)) ) ) <span class="op">%&gt;%</span><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">fitpars_wide_kon =</span> purrr<span class="op">::</span><span class="kw">map</span>(fitpars_wide, <span class="op">~</span>dplyr<span class="op">::</span><span class="kw">mutate</span>(., <span class="dt">Kon =</span> (Kobs <span class="op">-</span><span class="st"> </span>Koff)<span class="op">/</span>Conc1 ) ) ) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">fitpars_wide_kon =</span> purrr<span class="op">::</span><span class="kw">map</span>(fitpars_wide_kon, <span class="op">~</span>dplyr<span class="op">::</span><span class="kw">mutate</span>(., <span class="dt">KD_nM =</span> (Koff<span class="op">/</span>Kon)<span class="op">*</span><span class="dv">10</span><span class="op">^</span><span class="dv">9</span> ) ) )</a>
<a class="sourceLine" id="cb21-6" data-line-number="6"></a>
<a class="sourceLine" id="cb21-7" data-line-number="7">pull_pars_f &lt;-<span class="st"> </span><span class="cf">function</span>(df, parameter){</a>
<a class="sourceLine" id="cb21-8" data-line-number="8">  value &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(., <span class="kw">c</span>(parameter)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pull</span>()</a>
<a class="sourceLine" id="cb21-9" data-line-number="9">  <span class="kw">return</span>(value)</a>
<a class="sourceLine" id="cb21-10" data-line-number="10">}</a>
<a class="sourceLine" id="cb21-11" data-line-number="11"></a>
<a class="sourceLine" id="cb21-12" data-line-number="12"></a>
<a class="sourceLine" id="cb21-13" data-line-number="13">data_dir_all_kinetics_pars_csv_residual &lt;-<span class="st"> </span>data_dir_all_kinetics_pars <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(., sample, rec, exprun_digit, <span class="dt">sensorcsv =</span> csv_kinfilereadme, <span class="kw">contains</span>(<span class="st">&quot;meas_&quot;</span>), csv_shifted_rmsd, fitpars_wide_kon) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(., <span class="dt">conc =</span> purrr<span class="op">::</span><span class="kw">pmap</span>(<span class="kw">list</span>(fitpars_wide_kon, <span class="st">&quot;Conc1&quot;</span>), pull_pars_f)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">unchop</span>(., <span class="kw">c</span>(<span class="st">&quot;conc&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(., <span class="dt">conc_nM =</span> conc <span class="op">*</span><span class="dv">10</span><span class="op">^</span><span class="dv">9</span>)</a></code></pre></div>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" data-line-number="1">data_dir_all_kinetics_pars_KonVsKD &lt;-<span class="st"> </span>data_dir_all_kinetics_pars <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(., sample, rec, exprun_digit, filterme, <span class="kw">contains</span>(<span class="st">&quot;meas_&quot;</span>), fitpars_wide_kon) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">unnest</span>(., fitpars_wide_kon) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(., <span class="dt">Kon_corr =</span> <span class="kw">case_when</span>(Kon <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span> <span class="op">~</span><span class="st"> </span>Kon, Kon <span class="op">&lt;</span><span class="st"> </span><span class="dv">0</span> <span class="op">~</span><span class="st"> </span><span class="dv">0</span>, <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> </span>Kon)) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">Kon_corr =</span> <span class="kw">na_if</span>(Kon_corr, <span class="dv">0</span>))</a>
<a class="sourceLine" id="cb22-2" data-line-number="2"></a>
<a class="sourceLine" id="cb22-3" data-line-number="3">data_dir_all_kinetics_pars_KonVsKD_forplot &lt;-<span class="st"> </span>data_dir_all_kinetics_pars_KonVsKD <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(meas_type <span class="op">==</span><span class="st"> &quot;TIT&quot;</span> <span class="op">&amp;</span><span class="st"> </span>exprun_digit <span class="op">&gt;</span><span class="st"> </span><span class="dv">802</span>) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(.,<span class="dt">conc_nM =</span> Conc1<span class="op">*</span><span class="dv">10</span><span class="op">^</span><span class="dv">9</span>)  <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(., <span class="dt">koff_log10 =</span> <span class="kw">log10</span>(Koff), <span class="dt">Kd_log10_nM =</span> <span class="kw">log10</span>(KD_nM<span class="op">*</span><span class="dv">10</span><span class="op">^-</span><span class="dv">9</span>)<span class="op">+</span><span class="dv">9</span>) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(., <span class="dt">value_norm =</span> <span class="dv">0</span>)</a>
<a class="sourceLine" id="cb22-4" data-line-number="4"></a>
<a class="sourceLine" id="cb22-5" data-line-number="5">data_dir_all_kinetics_pars_KonVsKD_2Dplot &lt;-<span class="st"> </span>data_dir_all_kinetics_pars_KonVsKD <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(.,<span class="dt">conc_nM =</span> Conc1<span class="op">*</span><span class="dv">10</span><span class="op">^</span><span class="dv">9</span>) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(meas_type <span class="op">==</span><span class="st"> &quot;TIT&quot;</span> <span class="op">&amp;</span><span class="st"> </span>exprun_digit <span class="op">&gt;</span><span class="st"> </span><span class="dv">802</span>) <span class="op">%&gt;%</span><span class="st">  </span><span class="kw">ggplot</span>(<span class="dt">data=</span>., <span class="kw">aes</span>(<span class="dt">x=</span>KD_nM, <span class="dt">y=</span>Kon, <span class="dt">color=</span>conc_nM)) <span class="op">+</span><span class="st">  </span><span class="co">#xlab(&quot;Vol /mL&quot;) + #ylab(&quot;Abs /mAU&quot;) +#xlim(c(0,1000)) +#ylim(c(-5,50)) +  #geom_vline(xintercept = mwlines, color = &quot;red&quot;, linetype=&quot;dashed&quot;, size=0.5) +</span></a>
<a class="sourceLine" id="cb22-6" data-line-number="6"><span class="st">   </span><span class="kw">geom_point</span>(<span class="dt">size =</span> <span class="dv">2</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb22-7" data-line-number="7"><span class="st">  </span><span class="co">#geom_line(aes(x=conc_nM_dimer, y=kd_fit)) +</span></a>
<a class="sourceLine" id="cb22-8" data-line-number="8"><span class="st">  </span><span class="co">#geom_line(aes(x=KD_nM, y=kd_fit)) +</span></a>
<a class="sourceLine" id="cb22-9" data-line-number="9"><span class="st">  </span><span class="kw">scale_x_log10</span>(<span class="st">&quot;log10(Kd in nM)&quot;</span>, <span class="dt">breaks =</span> <span class="kw">c</span>(<span class="dv">10</span><span class="op">^-</span><span class="dv">1</span>, <span class="dv">10</span><span class="op">^</span><span class="dv">0</span>, <span class="dv">10</span><span class="op">^</span><span class="dv">1</span>, <span class="dv">10</span><span class="op">^</span><span class="dv">2</span>, <span class="dv">10</span><span class="op">^</span><span class="dv">3</span>), <span class="dt">labels =</span> <span class="cf">function</span>(breaks) <span class="kw">log10</span>(breaks)) <span class="op">+</span></a>
<a class="sourceLine" id="cb22-10" data-line-number="10"><span class="st">  </span><span class="kw">scale_y_log10</span>(<span class="st">&quot;Kon: Ms-1&quot;</span>, <span class="dt">breaks =</span> <span class="kw">c</span>(<span class="dv">10</span><span class="op">^</span><span class="dv">3</span>, <span class="dv">10</span><span class="op">^</span><span class="dv">4</span>, <span class="dv">10</span><span class="op">^</span><span class="dv">5</span>, <span class="dv">10</span><span class="op">^</span><span class="dv">6</span>, <span class="dv">10</span><span class="op">^</span><span class="dv">7</span>), <span class="dt">labels =</span> <span class="cf">function</span>(breaks) <span class="kw">log10</span>(breaks)) <span class="op">+</span></a>
<a class="sourceLine" id="cb22-11" data-line-number="11"><span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="fl">0.1</span>, <span class="dv">1000</span>), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">10</span><span class="op">^</span><span class="dv">3</span>, <span class="dv">10</span><span class="op">^</span><span class="dv">7</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb22-12" data-line-number="12"><span class="st">  </span><span class="kw">scale_color_gradient2</span>(<span class="dt">low=</span><span class="st">&quot;green&quot;</span>, <span class="dt">mid=</span><span class="st">&quot;blue&quot;</span>, <span class="dt">high=</span><span class="st">&quot;red&quot;</span>, <span class="dt">space =</span><span class="st">&quot;Lab&quot;</span>,<span class="dt">midpoint=</span><span class="dv">3</span>, <span class="dt">trans =</span> <span class="st">&quot;log10&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="co">#,</span></a>
<a class="sourceLine" id="cb22-13" data-line-number="13"><span class="kw">facet_grid</span>(exprun_digit <span class="op">~</span><span class="st"> </span>.) <span class="op">+</span></a>
<a class="sourceLine" id="cb22-14" data-line-number="14"><span class="st">  </span><span class="co">#scale_color_aaas() +</span></a>
<a class="sourceLine" id="cb22-15" data-line-number="15"><span class="st">  </span><span class="co">#geom_vline(aes(xintercept = vline_value, linetype = factor(vline_size*-1))) +</span></a>
<a class="sourceLine" id="cb22-16" data-line-number="16"><span class="st">  </span><span class="kw">theme_light</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb22-17" data-line-number="17"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;left&quot;</span>, <span class="dt">strip.background =</span> <span class="kw">element_blank</span>(), <span class="dt">strip.text.y =</span> <span class="kw">element_blank</span>()) <span class="op">+</span><span class="st"> </span><span class="co"># remove facet legend +</span></a>
<a class="sourceLine" id="cb22-18" data-line-number="18"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>)</a>
<a class="sourceLine" id="cb22-19" data-line-number="19"><span class="kw">print</span>(data_dir_all_kinetics_pars_KonVsKD_2Dplot)</a></code></pre></div>
<p><img src="index_files/figure-html/ForteBioKineticFitParameterPlots-1.png" width="672" /></p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb23-1" data-line-number="1"><span class="kw">ggsave</span>(<span class="dt">file=</span><span class="st">&quot;ggplot_ligand_titrations_KDKon_log.jpeg&quot;</span>, <span class="dt">plot=</span>data_dir_all_kinetics_pars_KonVsKD_2Dplot,<span class="dt">device=</span><span class="st">&quot;jpeg&quot;</span>, <span class="dt">width =</span> <span class="dv">60</span>, <span class="dt">height =</span> <span class="dv">80</span>, <span class="dt">units =</span> <span class="kw">c</span>(<span class="st">&quot;mm&quot;</span>))</a>
<a class="sourceLine" id="cb23-2" data-line-number="2"></a>
<a class="sourceLine" id="cb23-3" data-line-number="3">data_dir_all_kinetics_pars_KonVsKD_values &lt;-<span class="st"> </span>data_dir_all_kinetics_pars_KonVsKD <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(.,<span class="dt">conc_nM =</span> Conc1<span class="op">*</span><span class="dv">10</span><span class="op">^</span><span class="dv">9</span>) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(meas_type <span class="op">==</span><span class="st"> &quot;TIT&quot;</span> <span class="op">&amp;</span><span class="st"> </span>exprun_digit <span class="op">&gt;</span><span class="st"> </span><span class="dv">802</span>) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(., sample, exprun_digit, conc_nM, KD_nM, Kon, Koff, Kobs) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(rec, exprun_digit) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(., KD_nM <span class="op">&gt;</span><span class="st"> </span><span class="dv">10</span> <span class="op">&amp;</span><span class="st"> </span>KD_nM <span class="op">&lt;</span><span class="st"> </span><span class="dv">100</span>) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">summarize</span>(., <span class="dt">Kon_median =</span> <span class="kw">median</span>(Kon), <span class="dt">Koff_median =</span> <span class="kw">median</span>(Koff),<span class="dt">KD_median =</span> <span class="kw">median</span>(KD_nM), <span class="dt">Kon_sd =</span> <span class="kw">sd</span>(Kon), <span class="dt">Koff_sd =</span> <span class="kw">sd</span>(Koff),<span class="dt">KD_sd =</span> <span class="kw">sd</span>(KD_nM)) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(., <span class="dt">Kon_median_log =</span> <span class="kw">log10</span>(Kon_median), <span class="dt">Koff_median_log =</span> <span class="kw">log10</span>(Koff_median), <span class="dt">Kon_sd_log =</span> <span class="kw">log10</span>(Kon_sd), <span class="dt">Koff_sd_log =</span> <span class="kw">log10</span>(Koff_sd)) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(., <span class="dt">Kon_upper_10to5 =</span> (Kon_median <span class="op">+</span><span class="st"> </span>Kon_sd)<span class="op">*</span><span class="dv">10</span><span class="op">^-</span><span class="dv">5</span>, <span class="dt">Kon_lower_10to5 =</span> (Kon_median <span class="op">-</span><span class="st"> </span>Kon_sd)<span class="op">*</span><span class="dv">10</span><span class="op">^-</span><span class="dv">5</span>, <span class="dt">Koff_upper_10tominus3 =</span> (Koff_median <span class="op">+</span><span class="st"> </span>Koff_sd)<span class="op">*</span><span class="dv">10</span><span class="op">^</span><span class="dv">3</span>, <span class="dt">Koff_lower_10tominus3 =</span> (Koff_median <span class="op">-</span><span class="st"> </span>Koff_sd)<span class="op">*</span><span class="dv">10</span><span class="op">^</span><span class="dv">3</span> )</a></code></pre></div>
<div id="ForteBioKineticFitParameterPlotsCaption" class="figure-box">
<p>Plotting on-rates versus log10(Kd in nM): 1 corresponds to 10 nM, 2 to 100 nM … / this plot was not used for the publication.</p>
</div>
</div>
<div id="tidying-data-for-evilfit-analysis-and-combined-plots-of-local-11-fits-vs.global-bayesian-11-fits-forte-vs.evilfit" class="section level2">
<h2><span class="header-section-number">1.8</span> Tidying data for evilfit analysis and combined plots of local 1:1 fits vs. global bayesian 1:1 fits (Forte vs. Evilfit)</h2>
<p>Export data to be imported into <a href="https://sedfitsedphat.nibib.nih.gov/software/default.aspx">Evilfit</a> for Bayesian analysis to obtain two-dimensional distribution of KD and koff-rate constants to address heterogeneous ligand site populations on the sensor surface <span class="citation">(Svitel et al. 2003)</span><span class="citation">(Gorshkova et al. 2008)</span>.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb24-1" data-line-number="1">pick_id &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">seq</span>(<span class="dv">1</span>,<span class="dv">1000000</span>,<span class="dv">5</span>))</a>
<a class="sourceLine" id="cb24-2" data-line-number="2"></a>
<a class="sourceLine" id="cb24-3" data-line-number="3">data_dir_all_kinetics_evil1 &lt;-<span class="st"> </span>data_dir_all_kinetics <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(., exprun_digit <span class="op">&gt;</span><span class="st"> </span><span class="dv">802</span>) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(., <span class="op">-</span>csv_shifted, <span class="op">-</span>dirname, <span class="op">-</span>filterme, <span class="op">-</span>meas_type, <span class="op">-</span>meas_driftcorr, <span class="op">-</span>csv_kinfolder) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(., <span class="dt">sensor =</span> <span class="kw">str_extract</span>(csv_kinfilelist, <span class="st">&quot;[^[Result.txt]]&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">unnest</span>(., <span class="kw">c</span>(<span class="st">&quot;csv_shifted_rmsd&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(., <span class="dt">octet1000 =</span> octet<span class="op">*</span><span class="dv">1000</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(., <span class="op">-</span>csv_kinfilelist, csv_kinfilereadme) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(sample, sensor) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">nest</span>() <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(., <span class="dt">data_mod =</span> purrr<span class="op">::</span><span class="kw">map</span>(data, <span class="op">~</span>dplyr<span class="op">::</span><span class="kw">mutate</span>(., <span class="dt">octet1000pos =</span> octet1000<span class="op">-</span><span class="kw">min</span>(octet1000)))) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>data) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">unnest</span>(<span class="dt">cols =</span> <span class="kw">c</span>(<span class="st">&quot;data_mod&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pivot_longer</span>(., <span class="dt">cols =</span> <span class="kw">c</span>(<span class="st">&quot;time&quot;</span>, <span class="st">&quot;octet&quot;</span>, <span class="st">&quot;simulated&quot;</span>, <span class="st">&quot;time_shifted&quot;</span>, <span class="st">&quot;residuals&quot;</span>, <span class="st">&quot;octet1000&quot;</span>, <span class="st">&quot;octet1000pos&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(., sample, exprun_digit) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">nest</span>() <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">data_wide =</span> purrr<span class="op">::</span><span class="kw">map</span>(data, <span class="op">~</span>dplyr<span class="op">::</span><span class="kw">group_by</span>(., sensor, name))) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">data_wide =</span> purrr<span class="op">::</span><span class="kw">map</span>(data_wide, <span class="op">~</span>dplyr<span class="op">::</span><span class="kw">mutate</span>(., <span class="dt">timeid =</span> <span class="kw">row_number</span>()))) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">data_wider =</span> purrr<span class="op">::</span><span class="kw">map</span>(data_wide, <span class="op">~</span><span class="kw">pivot_wider</span>(., <span class="dt">id_cols =</span> <span class="kw">c</span>(<span class="st">&quot;rec&quot;</span>, <span class="st">&quot;meas_salt&quot;</span>, <span class="st">&quot;timeid&quot;</span>), <span class="dt">names_from =</span> <span class="kw">c</span>(<span class="st">&quot;name&quot;</span>, <span class="st">&quot;sensor&quot;</span>), <span class="dt">values_from =</span> <span class="kw">c</span>(<span class="st">&quot;value&quot;</span>)) )) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">data_wider_1s =</span> purrr<span class="op">::</span><span class="kw">map</span>(data_wider, <span class="op">~</span>dplyr<span class="op">::</span><span class="kw">filter</span>(., timeid <span class="op">%in%</span><span class="st"> </span>pick_id ) )) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">evil_exp =</span> purrr<span class="op">::</span><span class="kw">map</span>(data_wider_1s, <span class="op">~</span>dplyr<span class="op">::</span><span class="kw">select</span>(., time_shifted_A, octet1000_A, time_shifted_B, octet1000_B, time_shifted_C, octet1000_C, time_shifted_D, octet1000_D, time_shifted_E, octet1000_E, time_shifted_F, octet1000_F, time_shifted_G, octet1000_G ) )) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(., <span class="dt">evilname =</span> <span class="kw">paste</span>(<span class="st">&quot;./&quot;</span>, sample, <span class="st">&quot;_evil.xls&quot;</span>, <span class="dt">sep =</span> <span class="st">&quot;&quot;</span>))</a>
<a class="sourceLine" id="cb24-4" data-line-number="4"></a>
<a class="sourceLine" id="cb24-5" data-line-number="5"><span class="kw">pwalk</span>(<span class="kw">list</span>(data_dir_all_kinetics_evil1<span class="op">$</span>evil_exp, data_dir_all_kinetics_evil1<span class="op">$</span>evilname), write_excel_csv)</a></code></pre></div>
<p>In Evilfit, it is possible to obtain a matlab file that can be imported into R for customized visualization.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb25-1" data-line-number="1">mat_pluck_f &lt;-<span class="st"> </span><span class="cf">function</span>(df){</a>
<a class="sourceLine" id="cb25-2" data-line-number="2">  mattib &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">enframe</span>(.) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pivot_wider</span>(., <span class="dt">names_from =</span> <span class="kw">c</span>(<span class="st">&quot;name&quot;</span>), <span class="dt">values_from =</span> <span class="kw">c</span>(<span class="st">&quot;value&quot;</span>))</a>
<a class="sourceLine" id="cb25-3" data-line-number="3">}</a>
<a class="sourceLine" id="cb25-4" data-line-number="4"></a>
<a class="sourceLine" id="cb25-5" data-line-number="5">mat_to_tib_f &lt;-<span class="st"> </span><span class="cf">function</span>(evilmatrix, evilcolname){</a>
<a class="sourceLine" id="cb25-6" data-line-number="6"> idcolname &lt;-<span class="st"> </span><span class="kw">paste</span>(evilcolname, <span class="st">&quot;id&quot;</span>, <span class="dt">sep =</span> <span class="st">&quot;&quot;</span>)</a>
<a class="sourceLine" id="cb25-7" data-line-number="7"> eviltib &lt;-<span class="st"> </span>evilmatrix <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">unlist</span>(.) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">as_tibble</span>(.) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(., <span class="dt">joinme =</span> <span class="st">&quot;joinme&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(., <span class="dt">distrow =</span> <span class="kw">row_number</span>(joinme)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">set_colnames</span>(<span class="kw">c</span>(evilcolname, <span class="st">&quot;joinme&quot;</span>, idcolname)) </a>
<a class="sourceLine" id="cb25-8" data-line-number="8"> <span class="kw">return</span>(eviltib)</a>
<a class="sourceLine" id="cb25-9" data-line-number="9">}</a>
<a class="sourceLine" id="cb25-10" data-line-number="10"></a>
<a class="sourceLine" id="cb25-11" data-line-number="11">distmat_to_tib_f &lt;-<span class="st"> </span><span class="cf">function</span>(evilmatrix){</a>
<a class="sourceLine" id="cb25-12" data-line-number="12"> eviltib &lt;-<span class="st"> </span>evilmatrix <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(., <span class="dt">melted =</span> purrr<span class="op">::</span><span class="kw">map</span>(PlotConcMat, <span class="op">~</span><span class="kw">melt</span>(.))) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(., melted) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">unnest</span>(., <span class="dt">cols =</span> <span class="kw">c</span>(<span class="st">&quot;melted&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(., <span class="dt">joinme =</span> <span class="st">&quot;joinme&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">set_colnames</span>(<span class="kw">c</span>(<span class="st">&quot;Kdid&quot;</span>, <span class="st">&quot;koffid&quot;</span>, <span class="st">&quot;value&quot;</span>, <span class="st">&quot;joinme&quot;</span>))</a>
<a class="sourceLine" id="cb25-13" data-line-number="13"> <span class="kw">return</span>(eviltib)</a>
<a class="sourceLine" id="cb25-14" data-line-number="14">}</a>
<a class="sourceLine" id="cb25-15" data-line-number="15"></a>
<a class="sourceLine" id="cb25-16" data-line-number="16"><span class="co"># </span></a>
<a class="sourceLine" id="cb25-17" data-line-number="17"></a>
<a class="sourceLine" id="cb25-18" data-line-number="18">data_dir_evil &lt;-<span class="st"> </span><span class="kw">enframe</span>(<span class="kw">list.files</span>(<span class="dt">path =</span> <span class="st">&quot;./evilfit&quot;</span>, <span class="dt">pattern =</span> <span class="st">&quot;*.mat&quot;</span>, <span class="dt">full.names =</span> <span class="ot">TRUE</span>, <span class="dt">recursive=</span><span class="ot">FALSE</span>)) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(., <span class="dt">evilname =</span> value) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">evilmat =</span> purrr<span class="op">::</span><span class="kw">map</span>(evilname,<span class="op">~</span>rmatio<span class="op">::</span><span class="kw">read.mat</span>(.) ))  </a>
<a class="sourceLine" id="cb25-19" data-line-number="19"></a>
<a class="sourceLine" id="cb25-20" data-line-number="20"><span class="co">#add_matids_f &lt;- function(Kd_tib, koff_tib, plotdistr_tib){</span></a>
<a class="sourceLine" id="cb25-21" data-line-number="21"><span class="co">#  plotdistr_tib_mod &lt;- plotdistr_tib %&gt;% </span></a>
<a class="sourceLine" id="cb25-22" data-line-number="22"><span class="co">#  return(plotdistr_tib_mod)</span></a>
<a class="sourceLine" id="cb25-23" data-line-number="23"><span class="co">#}</span></a>
<a class="sourceLine" id="cb25-24" data-line-number="24"><span class="co">#%&gt;% dplyr::mutate(., plotdistr_tib_mod = purrr::pmap(list(Kd_tib, koff_tib, plotdistr_tib), add_matids_f)) </span></a>
<a class="sourceLine" id="cb25-25" data-line-number="25"></a>
<a class="sourceLine" id="cb25-26" data-line-number="26">data_dir_evil_mat2 &lt;-<span class="st"> </span>data_dir_evil <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(., <span class="dt">id =</span> <span class="kw">row_number</span>(evilname)) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(., <span class="dt">Kdmatid =</span> <span class="st">&quot;Kd&quot;</span>, <span class="dt">koffmatid =</span> <span class="st">&quot;koff&quot;</span>, <span class="dt">distid =</span> <span class="st">&quot;distribution&quot;</span>) <span class="op">%&gt;%</span><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(., <span class="dt">evilmat_wide =</span> purrr<span class="op">::</span><span class="kw">map</span>(evilmat, <span class="op">~</span><span class="kw">mat_pluck_f</span>(.))) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(., <span class="dt">Kd_mat =</span> purrr<span class="op">::</span><span class="kw">map</span>(evilmat_wide, <span class="op">~</span>dplyr<span class="op">::</span><span class="kw">select</span>(., Kdlist)), <span class="dt">koff_mat =</span> purrr<span class="op">::</span><span class="kw">map</span>(evilmat_wide, <span class="op">~</span>dplyr<span class="op">::</span><span class="kw">select</span>(., kofflist)), <span class="dt">dist_mat =</span> purrr<span class="op">::</span><span class="kw">map</span>(evilmat_wide, <span class="op">~</span>dplyr<span class="op">::</span><span class="kw">select</span>(., PlotConcMat))) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">Kd_tib =</span> purrr<span class="op">::</span><span class="kw">pmap</span>(<span class="kw">list</span>(Kd_mat, Kdmatid), mat_to_tib_f), <span class="dt">koff_tib =</span> purrr<span class="op">::</span><span class="kw">pmap</span>(<span class="kw">list</span>(koff_mat, koffmatid), mat_to_tib_f), <span class="dt">plotdistr_tib =</span> purrr<span class="op">::</span><span class="kw">map</span>(dist_mat, <span class="op">~</span><span class="kw">distmat_to_tib_f</span>(.))) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(., <span class="dt">plotdistr_tib_Kd =</span> purrr<span class="op">::</span><span class="kw">pmap</span>(<span class="kw">list</span>(plotdistr_tib, Kd_tib), left_join)) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(., <span class="dt">plotdistr_tib_Kdkoff =</span> purrr<span class="op">::</span><span class="kw">pmap</span>(<span class="kw">list</span>(plotdistr_tib_Kd, koff_tib), left_join)) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(., <span class="dt">plotdistr_tib_Kdkoff_log10 =</span> purrr<span class="op">::</span><span class="kw">map</span>(plotdistr_tib_Kdkoff, <span class="op">~</span>dplyr<span class="op">::</span><span class="kw">mutate</span>(., <span class="dt">Kd_log10_nM =</span> <span class="kw">log10</span>(Kd<span class="op">*</span><span class="dv">10</span><span class="op">^</span><span class="dv">9</span>), <span class="dt">koff_log10 =</span> <span class="kw">log10</span>(koff)))) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(., <span class="dt">plotdistr_tib_Kdkoff_log10_norm =</span> purrr<span class="op">::</span><span class="kw">map</span>(plotdistr_tib_Kdkoff_log10, <span class="op">~</span>dplyr<span class="op">::</span><span class="kw">mutate</span>(., <span class="dt">value_norm =</span> (value<span class="op">/</span><span class="kw">max</span>(value)) )))</a></code></pre></div>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb26-1" data-line-number="1"><span class="co">## plot 2D distributions of fitted parameters</span></a>
<a class="sourceLine" id="cb26-2" data-line-number="2">inferno_colours &lt;-<span class="st"> </span><span class="kw">c</span>(viridisLite<span class="op">::</span><span class="kw">inferno</span>(<span class="dv">200</span>))</a>
<a class="sourceLine" id="cb26-3" data-line-number="3">plasma_colours &lt;-<span class="st"> </span><span class="kw">c</span>(viridisLite<span class="op">::</span><span class="kw">plasma</span>(<span class="dv">200</span>))</a>
<a class="sourceLine" id="cb26-4" data-line-number="4"></a>
<a class="sourceLine" id="cb26-5" data-line-number="5">plotdistr_tib_Kdkoff_log10_forplot &lt;-<span class="st"> </span>data_dir_evil_mat2 <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(., evilname, plotdistr_tib_Kdkoff_log10_norm) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">unnest</span>(., <span class="dt">cols =</span> <span class="st">&quot;plotdistr_tib_Kdkoff_log10_norm&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(., <span class="dt">exprun =</span> <span class="kw">str_extract</span>(evilname, <span class="dt">pattern =</span> <span class="st">&quot;x[:digit:]{4}&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(., <span class="dt">exprun_digit =</span> <span class="kw">str_extract</span>(exprun, <span class="dt">pattern =</span> <span class="st">&quot;[:digit:]{4}&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">mutate_at</span>(., <span class="kw">vars</span>(<span class="kw">matches</span>(<span class="st">&quot;exprun_digit&quot;</span>)), as.numeric) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(., exprun_digit, Kd_log10_nM, koff_log10, value_norm) </a>
<a class="sourceLine" id="cb26-6" data-line-number="6"></a>
<a class="sourceLine" id="cb26-7" data-line-number="7">plotdistr_tib_Kdkoff_log10_plot &lt;-<span class="st"> </span>plotdistr_tib_Kdkoff_log10_forplot <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">ggplot</span>(., ) <span class="op">+</span><span class="st"> </span><span class="co">#contourplot(value ~ Kd_log10_nM * koff_log10, data = ., cuts = 10) +</span></a>
<a class="sourceLine" id="cb26-8" data-line-number="8"><span class="st">  </span><span class="co">#geom_raster(aes(fill = value_norm), interpolate = TRUE) +</span></a>
<a class="sourceLine" id="cb26-9" data-line-number="9"><span class="st">  </span><span class="co">#geom_tile(aes(x = Kd_log10_nM, y = koff_log10, fill = value_norm), linejoin = &quot;mitre&quot;) +</span></a>
<a class="sourceLine" id="cb26-10" data-line-number="10"><span class="st">  </span><span class="co">#stat_contour(colour = &quot;white&quot;, size = 0.1, breaks = c(1/3, 2/3)) +</span></a>
<a class="sourceLine" id="cb26-11" data-line-number="11"><span class="st">  </span><span class="kw">stat_contour</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Kd_log10_nM, <span class="dt">y =</span> koff_log10, <span class="dt">z =</span> value_norm, <span class="dt">colour =</span> ..level..), <span class="dt">size =</span> <span class="fl">0.25</span>, <span class="dt">bins =</span> <span class="dv">10</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb26-12" data-line-number="12"><span class="st">  </span><span class="co">#scale_colour_viridis_c() +</span></a>
<a class="sourceLine" id="cb26-13" data-line-number="13"><span class="st">  </span><span class="kw">scale_colour_gradient</span>(<span class="dt">low =</span> <span class="st">&quot;blue&quot;</span>, <span class="dt">high =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">space =</span> <span class="st">&quot;Lab&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb26-14" data-line-number="14"><span class="st">  </span><span class="co">#scale_fill_gradientn(colours = plasma_colours, space = &quot;Lab&quot;, breaks = c(0/3, 1/3, 2/3, 3/3), labels = function(breaks) round(breaks, 2)) +</span></a>
<a class="sourceLine" id="cb26-15" data-line-number="15"><span class="st">  </span><span class="co">#scale_colour_gradientn(colours = terrain.colors(10)) +</span></a>
<a class="sourceLine" id="cb26-16" data-line-number="16"><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> data_dir_all_kinetics_pars_KonVsKD_forplot, <span class="kw">aes</span>(<span class="dt">x =</span> Kd_log10_nM, <span class="dt">y =</span> koff_log10), <span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">shape =</span> <span class="dv">3</span>, <span class="dt">size =</span> <span class="fl">0.5</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb26-17" data-line-number="17"><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">name =</span> <span class="st">&quot;KD: nM&quot;</span>, <span class="dt">breaks =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">3</span>, <span class="dv">-2</span>, <span class="dv">-1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>), <span class="dt">labels =</span> <span class="cf">function</span>(breaks) <span class="dv">10</span><span class="op">^</span>breaks) <span class="op">+</span></a>
<a class="sourceLine" id="cb26-18" data-line-number="18"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">name =</span> <span class="st">&quot;koff s-1&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb26-19" data-line-number="19"><span class="st">  </span><span class="kw">facet_grid</span>(exprun_digit <span class="op">~</span><span class="st"> </span>.) <span class="op">+</span></a>
<a class="sourceLine" id="cb26-20" data-line-number="20"><span class="st"> </span><span class="co"># remove facet legend +</span></a>
<a class="sourceLine" id="cb26-21" data-line-number="21"><span class="st">  </span><span class="kw">theme_light</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb26-22" data-line-number="22"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;left&quot;</span>, <span class="dt">strip.background =</span> <span class="kw">element_blank</span>(), <span class="dt">strip.text.y =</span> <span class="kw">element_blank</span>()) </a>
<a class="sourceLine" id="cb26-23" data-line-number="23">  <span class="co">#coord_cartesian(ylim = c(10^3, 10^7)) +</span></a>
<a class="sourceLine" id="cb26-24" data-line-number="24">  <span class="co">#scale_color_gradient2(low=&quot;green&quot;, mid=&quot;blue&quot;, high=&quot;red&quot;, midpoint = 10, space =&quot;Lab&quot;) </span></a>
<a class="sourceLine" id="cb26-25" data-line-number="25"><span class="kw">print</span>(plotdistr_tib_Kdkoff_log10_plot)</a></code></pre></div>
<p><img src="index_files/figure-html/Plot2DEvilfit-1.png" width="672" /></p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb27-1" data-line-number="1"><span class="kw">ggsave</span>(<span class="st">&quot;plotdistr_tib_Kdkoff_log10_plot.jpeg&quot;</span>, plotdistr_tib_Kdkoff_log10_plot, <span class="dt">width =</span> <span class="dv">120</span>, <span class="dt">height =</span> <span class="dv">60</span>, <span class="dt">units =</span> <span class="st">&quot;mm&quot;</span>)</a>
<a class="sourceLine" id="cb27-2" data-line-number="2"><span class="kw">ggsave</span>(<span class="st">&quot;plotdistr_tib_Kdkoff_log10_plot.ps&quot;</span>, plotdistr_tib_Kdkoff_log10_plot, <span class="dt">width =</span> <span class="dv">120</span>, <span class="dt">height =</span> <span class="dv">60</span>, <span class="dt">units =</span> <span class="st">&quot;mm&quot;</span>)</a></code></pre></div>
<div id="Plot2DEvilfitCaption" class="figure-box">
<p>Direct comparison of the obtained koff vs. Kd distribution of the two titrations. Plots were used for Figures 3B and supplementary Figure 2A. see ms figure legend in ms for more details.</p>
</div>
<p>some more transformations…</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb28-1" data-line-number="1"><span class="co"># contourlpots different way but not as nice</span></a>
<a class="sourceLine" id="cb28-2" data-line-number="2"><span class="co">#plotdistr_tib_Kdkoff_log10_forcontourplot &lt;- as.data.frame(plotdistr_tib_Kdkoff_log10_forplot)</span></a>
<a class="sourceLine" id="cb28-3" data-line-number="3"><span class="co">#plotdistr_tib_Kdkoff_log10_contourplot &lt;- contourplot(..value ~ ..Kd_log10_nM * ..koff_log10 | ..exprun_digit , data = plotdistr_tib_Kdkoff_log10_forcontourplot, cuts = 8,  region = TRUE, col.regions = heat.colors(800)) </span></a>
<a class="sourceLine" id="cb28-4" data-line-number="4"></a>
<a class="sourceLine" id="cb28-5" data-line-number="5">datamat_to_tib_f &lt;-<span class="st"> </span><span class="cf">function</span>(evilmatrix){</a>
<a class="sourceLine" id="cb28-6" data-line-number="6"> eviltib &lt;-<span class="st"> </span>evilmatrix <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(., <span class="dt">data_melted =</span> purrr<span class="op">::</span><span class="kw">map</span>(signalmats, <span class="op">~</span><span class="kw">melt</span>(.))) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(., data_melted) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(., <span class="dt">joinme =</span> <span class="st">&quot;joinme&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">unnest</span>(., <span class="dt">cols =</span> <span class="kw">c</span>(<span class="st">&quot;data_melted&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">set_colnames</span>(<span class="kw">c</span>(<span class="st">&quot;type&quot;</span>, <span class="st">&quot;id&quot;</span>, <span class="st">&quot;value&quot;</span>, <span class="st">&quot;curve&quot;</span>, <span class="st">&quot;dropme1&quot;</span>, <span class="st">&quot;dropme2&quot;</span>, <span class="st">&quot;joinme&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(., <span class="dt">meastype =</span> <span class="kw">case_when</span>(type <span class="op">==</span><span class="st"> </span><span class="dv">1</span> <span class="op">~</span><span class="st"> &quot;time_s&quot;</span>, type <span class="op">==</span><span class="st"> </span><span class="dv">2</span> <span class="op">~</span><span class="st"> &quot;octet_1000&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(., <span class="dt">curve_point =</span> <span class="kw">paste</span>(<span class="st">&quot;id&quot;</span>, curve, id, <span class="dt">sep =</span> <span class="st">&quot;_&quot;</span>) ) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(., curve, curve_point, meastype, value) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pivot_wider</span>(., <span class="dt">names_from =</span> <span class="kw">c</span>(<span class="st">&quot;meastype&quot;</span>), <span class="dt">values_from =</span> <span class="kw">c</span>(<span class="st">&quot;value&quot;</span>))</a>
<a class="sourceLine" id="cb28-7" data-line-number="7"> <span class="kw">return</span>(eviltib)</a>
<a class="sourceLine" id="cb28-8" data-line-number="8">}</a>
<a class="sourceLine" id="cb28-9" data-line-number="9"></a>
<a class="sourceLine" id="cb28-10" data-line-number="10">fitmat_to_tib_f &lt;-<span class="st"> </span><span class="cf">function</span>(evilmatrix){</a>
<a class="sourceLine" id="cb28-11" data-line-number="11"> eviltib &lt;-<span class="st"> </span>evilmatrix <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(., <span class="dt">fits_melted =</span> purrr<span class="op">::</span><span class="kw">map</span>(fits, <span class="op">~</span><span class="kw">melt</span>(.))) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(., fits_melted) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(., <span class="dt">joinme =</span> <span class="st">&quot;joinme&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">unnest</span>(., <span class="dt">cols =</span> <span class="kw">c</span>(<span class="st">&quot;fits_melted&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">set_colnames</span>(<span class="kw">c</span>(<span class="st">&quot;type&quot;</span>, <span class="st">&quot;id&quot;</span>, <span class="st">&quot;value&quot;</span>, <span class="st">&quot;curve&quot;</span>, <span class="st">&quot;dropme1&quot;</span>, <span class="st">&quot;dropme2&quot;</span>, <span class="st">&quot;joinme&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(., <span class="dt">meastype =</span> <span class="kw">case_when</span>(type <span class="op">==</span><span class="st"> </span><span class="dv">1</span> <span class="op">~</span><span class="st"> &quot;time_s&quot;</span>, type <span class="op">==</span><span class="st"> </span><span class="dv">2</span> <span class="op">~</span><span class="st"> &quot;evilfit_1000&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(., <span class="dt">curve_point =</span> <span class="kw">paste</span>(<span class="st">&quot;id&quot;</span>, curve, id, <span class="dt">sep =</span> <span class="st">&quot;_&quot;</span>) ) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(., curve, curve_point, meastype, value) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pivot_wider</span>(., <span class="dt">names_from =</span> <span class="kw">c</span>(<span class="st">&quot;meastype&quot;</span>), <span class="dt">values_from =</span> <span class="kw">c</span>(<span class="st">&quot;value&quot;</span>))</a>
<a class="sourceLine" id="cb28-12" data-line-number="12"> <span class="kw">return</span>(eviltib)</a>
<a class="sourceLine" id="cb28-13" data-line-number="13">}</a>
<a class="sourceLine" id="cb28-14" data-line-number="14"></a>
<a class="sourceLine" id="cb28-15" data-line-number="15">join_data_dir_all_kinetics_pars_KonVsKD &lt;-<span class="st"> </span>data_dir_all_kinetics_pars_KonVsKD <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(., exprun_digit <span class="op">&gt;</span><span class="st"> </span><span class="dv">802</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(sample, Conc1) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(., <span class="dt">conc_nM =</span> Conc1<span class="op">*</span><span class="dv">10</span><span class="op">^</span><span class="dv">9</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(., sample) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(., <span class="dt">curve =</span> <span class="kw">row_number</span>(sample)) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>Conc1) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(sample) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">nest</span>(.) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(sample, <span class="dt">meas_parameters =</span> data)</a>
<a class="sourceLine" id="cb28-16" data-line-number="16">                                                                               </a>
<a class="sourceLine" id="cb28-17" data-line-number="17"><span class="co">## get used data/fit/rmsd for plotting</span></a>
<a class="sourceLine" id="cb28-18" data-line-number="18">data_dir_evil_mat2_dataVsfit &lt;-<span class="st"> </span>data_dir_evil_mat2 <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(., <span class="dt">sample =</span> <span class="kw">str_extract</span>(evilname, <span class="dt">pattern =</span> <span class="st">&quot;[:digit:]{6}xSAXxNB1AxRBDHisxTITx[:digit:]{4}&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(., <span class="dt">evildata =</span> purrr<span class="op">::</span><span class="kw">pmap</span>(<span class="kw">list</span>(evilmat_wide), datamat_to_tib_f)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">left_join</span>(., join_data_dir_all_kinetics_pars_KonVsKD) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(., <span class="dt">evildata_par =</span> purrr<span class="op">::</span><span class="kw">pmap</span>(<span class="kw">list</span>(evildata, meas_parameters), left_join)) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(., <span class="dt">evilfit =</span> purrr<span class="op">::</span><span class="kw">pmap</span>(<span class="kw">list</span>(evilmat_wide), fitmat_to_tib_f)) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(., <span class="dt">evilfit_par =</span> purrr<span class="op">::</span><span class="kw">pmap</span>(<span class="kw">list</span>(evilfit, meas_parameters), left_join)) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(., <span class="dt">evildataVsfit =</span> purrr<span class="op">::</span><span class="kw">pmap</span>(<span class="kw">list</span>(evildata_par, evilfit_par), left_join)) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(., <span class="dt">evildataVsfit_res =</span> purrr<span class="op">::</span><span class="kw">map</span>(evildataVsfit, <span class="op">~</span>dplyr<span class="op">::</span><span class="kw">mutate</span>(., <span class="dt">datafit_res_1000 =</span> evilfit_<span class="dv">1000</span> <span class="op">-</span><span class="st"> </span>octet_<span class="dv">1000</span>))) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(., <span class="dt">evildataVsfit_res_nm =</span> purrr<span class="op">::</span><span class="kw">map</span>(evildataVsfit_res, <span class="op">~</span>dplyr<span class="op">::</span><span class="kw">mutate</span>(., <span class="dt">octet =</span> octet_<span class="dv">1000</span><span class="op">/</span><span class="dv">1000</span>, <span class="dt">evilfit =</span> evilfit_<span class="dv">1000</span><span class="op">/</span><span class="dv">1000</span>, <span class="dt">evilfit_res =</span> datafit_res_<span class="dv">1000</span><span class="op">/</span><span class="dv">1000</span>)))</a>
<a class="sourceLine" id="cb28-19" data-line-number="19"></a>
<a class="sourceLine" id="cb28-20" data-line-number="20"><span class="co">#KDs in nM, koff in 10^-3 (tm3), octet was multiplied by 1000</span></a>
<a class="sourceLine" id="cb28-21" data-line-number="21">evilpeaks_manual_trib &lt;-<span class="st"> </span><span class="kw">tribble</span>(<span class="op">~</span>sample, <span class="op">~</span>peak_id, <span class="op">~</span>peak_KD_nM, <span class="op">~</span>peak_koff_tm3, <span class="op">~</span>peak_area, <span class="op">~</span>total_area, <span class="op">~</span>total_rmsd, </a>
<a class="sourceLine" id="cb28-22" data-line-number="22">                                 <span class="st">&quot;200529xSAXxNB1AxRBDHisxTITx0901_evilexportall&quot;</span>, <span class="dv">1</span>, <span class="fl">5.2</span>, <span class="fl">4.2</span>, <span class="dv">151</span>, <span class="dv">1418</span>, <span class="fl">4.1</span>,</a>
<a class="sourceLine" id="cb28-23" data-line-number="23">                                 <span class="st">&quot;200529xSAXxNB1AxRBDHisxTITx0901_evilexportall&quot;</span>, <span class="dv">2</span>, <span class="fl">6.6</span>, <span class="dv">1</span><span class="op">*</span><span class="dv">10</span><span class="op">^-</span><span class="dv">4</span>, <span class="dv">928</span>, <span class="dv">1418</span>, <span class="fl">4.1</span>,</a>
<a class="sourceLine" id="cb28-24" data-line-number="24">                                 <span class="st">&quot;200529xSAXxNB1AxRBDHisxTITx1001_evilexportall&quot;</span>, <span class="dv">1</span>, <span class="fl">8.8</span>, <span class="fl">5.1</span>, <span class="dv">115</span>, <span class="dv">998</span>,<span class="fl">3.0</span>,</a>
<a class="sourceLine" id="cb28-25" data-line-number="25">                                 <span class="st">&quot;200529xSAXxNB1AxRBDHisxTITx1001_evilexportall&quot;</span>, <span class="dv">1</span>, <span class="fl">6.9</span>, <span class="fl">4.1</span><span class="op">*</span><span class="dv">10</span><span class="op">^-</span><span class="dv">4</span>, <span class="dv">287</span>, <span class="dv">998</span>,<span class="dv">3</span>)</a></code></pre></div>
</div>
<div id="combining-the-local-fits-with-bayesian-analysis-in-a-single-plot" class="section level2">
<h2><span class="header-section-number">1.9</span> Combining the local fits with bayesian analysis in a single plot</h2>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb29-1" data-line-number="1">data_dir_all_csv_titrations_sel_fortefit_join &lt;-<span class="st"> </span>data_dir_all_kinetics_pars_csv_residual <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(., sample, conc_nM, exprun_digit, meas_salt, csv_shifted_rmsd) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(exprun_digit <span class="op">&gt;</span><span class="st"> </span><span class="dv">802</span>) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(., <span class="dt">plotgroup =</span> <span class="kw">paste</span>(sample, conc_nM, <span class="dt">sep =</span> <span class="st">&quot;_&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">unnest</span>(., <span class="dt">cols =</span> <span class="kw">c</span>(<span class="st">&quot;csv_shifted_rmsd&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(., <span class="op">-</span>time) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(sample)  <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">nest</span>() <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(., <span class="dt">fortefit =</span> data)</a>
<a class="sourceLine" id="cb29-2" data-line-number="2"></a>
<a class="sourceLine" id="cb29-3" data-line-number="3">evilfit_join &lt;-<span class="st"> </span>data_dir_evil_mat2_dataVsfit <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(sample, evildataVsfit_res_nm) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">unnest</span>(., <span class="dt">cols =</span> <span class="kw">c</span>(<span class="st">&quot;evildataVsfit_res_nm&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(., sample, <span class="dt">time_shifted =</span> time_s, <span class="dt">eviloctet =</span> octet, evilfit, evilfit_res, conc_nM) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(., <span class="dt">plotgroup =</span> <span class="kw">paste</span>(sample, conc_nM, <span class="dt">sep =</span> <span class="st">&quot;_&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(., sample) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">nest</span>() <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(., <span class="dt">evilfit =</span> data)</a>
<a class="sourceLine" id="cb29-4" data-line-number="4"></a>
<a class="sourceLine" id="cb29-5" data-line-number="5">forte_evil_fits_combined &lt;-<span class="st"> </span>data_dir_all_csv_titrations_sel_fortefit_join <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">left_join</span>(., evilfit_join)</a>
<a class="sourceLine" id="cb29-6" data-line-number="6"></a>
<a class="sourceLine" id="cb29-7" data-line-number="7">fortefit_nesting_f &lt;-<span class="st"> </span><span class="cf">function</span>(df){</a>
<a class="sourceLine" id="cb29-8" data-line-number="8">  df_nested &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(., plotgroup, conc_nM) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">nest</span>(.) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(.,  plotgroup, conc_nM, <span class="dt">forte_nested =</span> data)</a>
<a class="sourceLine" id="cb29-9" data-line-number="9">  <span class="kw">return</span>(df_nested)</a>
<a class="sourceLine" id="cb29-10" data-line-number="10">}</a>
<a class="sourceLine" id="cb29-11" data-line-number="11">evilfit_nesting_f &lt;-<span class="st"> </span><span class="cf">function</span>(df){</a>
<a class="sourceLine" id="cb29-12" data-line-number="12">  df_nested &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(., plotgroup, conc_nM) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">nest</span>(.) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(.,  plotgroup, conc_nM, <span class="dt">evil_nested =</span> data)</a>
<a class="sourceLine" id="cb29-13" data-line-number="13">  <span class="kw">return</span>(df_nested)</a>
<a class="sourceLine" id="cb29-14" data-line-number="14">}</a>
<a class="sourceLine" id="cb29-15" data-line-number="15"></a>
<a class="sourceLine" id="cb29-16" data-line-number="16">check_octet_value_f &lt;-<span class="st"> </span><span class="cf">function</span>(df){</a>
<a class="sourceLine" id="cb29-17" data-line-number="17">  df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(., time_shifted <span class="op">&gt;</span><span class="st"> </span><span class="dv">90</span> <span class="op">&amp;</span><span class="st"> </span>time_shifted <span class="op">&lt;</span><span class="st"> </span><span class="dv">120</span>) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(., time_shifted <span class="op">==</span><span class="st"> </span><span class="kw">min</span>(time_shifted)) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(., <span class="kw">contains</span>(<span class="st">&quot;octet&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pull</span>()</a>
<a class="sourceLine" id="cb29-18" data-line-number="18">}</a>
<a class="sourceLine" id="cb29-19" data-line-number="19"></a>
<a class="sourceLine" id="cb29-20" data-line-number="20">addtoevil_f &lt;-<span class="st"> </span><span class="cf">function</span>(df, addtoevil){</a>
<a class="sourceLine" id="cb29-21" data-line-number="21">  df_added &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(., <span class="dt">evilfit_corr =</span> evilfit <span class="op">+</span><span class="st"> </span>addtoevil)</a>
<a class="sourceLine" id="cb29-22" data-line-number="22">  <span class="kw">return</span>(df_added)</a>
<a class="sourceLine" id="cb29-23" data-line-number="23">}</a>
<a class="sourceLine" id="cb29-24" data-line-number="24"></a>
<a class="sourceLine" id="cb29-25" data-line-number="25">forte_evil_fits_combined_join &lt;-<span class="st"> </span>forte_evil_fits_combined <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(., <span class="dt">fortefit_nested =</span> purrr<span class="op">::</span><span class="kw">map</span>(fortefit, <span class="op">~</span><span class="kw">fortefit_nesting_f</span>(.))) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(., <span class="dt">evilfit_nested =</span> purrr<span class="op">::</span><span class="kw">map</span>(evilfit, <span class="op">~</span><span class="kw">evilfit_nesting_f</span>(.))) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(., <span class="dt">fortenested_evilnested_combined =</span> purrr<span class="op">::</span><span class="kw">pmap</span>(<span class="kw">list</span>(fortefit_nested, evilfit_nested), left_join)) </a>
<a class="sourceLine" id="cb29-26" data-line-number="26"></a>
<a class="sourceLine" id="cb29-27" data-line-number="27">forte_evil_fits_combined_forplot &lt;-<span class="st"> </span>forte_evil_fits_combined_join <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(sample, fortenested_evilnested_combined) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">unnest</span>(., <span class="dt">cols =</span> <span class="kw">c</span>(<span class="st">&quot;fortenested_evilnested_combined&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(., <span class="dt">data_octet =</span> purrr<span class="op">::</span><span class="kw">map</span>(forte_nested, <span class="op">~</span><span class="kw">check_octet_value_f</span>(.)), <span class="dt">evil_octet =</span> purrr<span class="op">::</span><span class="kw">map</span>(evil_nested, <span class="op">~</span><span class="kw">check_octet_value_f</span>(.))) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">unchop</span>(., <span class="kw">c</span>(<span class="st">&quot;data_octet&quot;</span>, <span class="st">&quot;evil_octet&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(., <span class="dt">addtoevil =</span> data_octet <span class="op">-</span><span class="st"> </span>evil_octet) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(., <span class="dt">evil_nested_corr =</span> purrr<span class="op">::</span><span class="kw">pmap</span>(<span class="kw">list</span>(evil_nested, addtoevil), addtoevil_f))</a>
<a class="sourceLine" id="cb29-28" data-line-number="28"></a>
<a class="sourceLine" id="cb29-29" data-line-number="29">select_eviltimes_f &lt;-<span class="st"> </span><span class="cf">function</span>(forte_nested, evil_times){</a>
<a class="sourceLine" id="cb29-30" data-line-number="30">  eviltimes_vector &lt;-<span class="st"> </span>evil_times <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">mutate_if</span>(is.numeric, as.integer) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pull</span>()</a>
<a class="sourceLine" id="cb29-31" data-line-number="31">  forte_nested_out &lt;-<span class="st"> </span>forte_nested <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(., <span class="dt">timeid =</span> <span class="kw">row_number</span>()) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(., timeid <span class="op">%in%</span><span class="st"> </span>pick_id ) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">mutate_at</span>(<span class="kw">c</span>(<span class="st">&quot;time_shifted&quot;</span>), as.integer) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(., time_shifted <span class="op">%in%</span><span class="st"> </span>eviltimes_vector)</a>
<a class="sourceLine" id="cb29-32" data-line-number="32">  <span class="kw">return</span>(forte_nested_out)</a>
<a class="sourceLine" id="cb29-33" data-line-number="33">}</a>
<a class="sourceLine" id="cb29-34" data-line-number="34"></a>
<a class="sourceLine" id="cb29-35" data-line-number="35">addevilbase_f &lt;-<span class="st"> </span><span class="cf">function</span>(forte_nested_cut, evil_nested){</a>
<a class="sourceLine" id="cb29-36" data-line-number="36">  evil_nested_combine &lt;-<span class="st"> </span>evil_nested <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">mutate_at</span>(<span class="kw">c</span>(<span class="st">&quot;time_shifted&quot;</span>), as.integer)</a>
<a class="sourceLine" id="cb29-37" data-line-number="37">  forte_evil_combined &lt;-<span class="st"> </span>forte_nested_cut <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">left_join</span>(., evil_nested_combine) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(., <span class="dt">addevil =</span> eviloctet <span class="op">-</span><span class="st"> </span>octet) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(., <span class="dt">evilfit_corr =</span> evilfit <span class="op">-</span><span class="st"> </span>addevil)</a>
<a class="sourceLine" id="cb29-38" data-line-number="38">}</a>
<a class="sourceLine" id="cb29-39" data-line-number="39"></a>
<a class="sourceLine" id="cb29-40" data-line-number="40">forte_evil_fits_combined_forplot_corrected &lt;-<span class="st"> </span>forte_evil_fits_combined_forplot <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(., <span class="dt">evil_times =</span> purrr<span class="op">::</span><span class="kw">map</span>(evil_nested, <span class="op">~</span>dplyr<span class="op">::</span><span class="kw">select</span>(., time_shifted))) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(., <span class="dt">forte_nested_cut =</span> purrr<span class="op">::</span><span class="kw">pmap</span>(<span class="kw">list</span>(forte_nested, evil_times), select_eviltimes_f)) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">forte_evil_combined =</span> purrr<span class="op">::</span><span class="kw">pmap</span>(<span class="kw">list</span>(forte_nested_cut, evil_nested), addevilbase_f)) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(., sample, plotgroup, conc_nM, forte_evil_combined) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">unnest</span>(., <span class="dt">cols =</span> <span class="kw">c</span>(<span class="st">&quot;forte_evil_combined&quot;</span>))</a>
<a class="sourceLine" id="cb29-41" data-line-number="41"></a>
<a class="sourceLine" id="cb29-42" data-line-number="42">evilfit_forplot &lt;-<span class="st"> </span>forte_evil_fits_combined_forplot <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(., sample, plotgroup, conc_nM, evil_nested_corr) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">unnest</span>(., <span class="dt">cols =</span> <span class="kw">c</span>(<span class="st">&quot;evil_nested_corr&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(., <span class="dt">residuals_fittype =</span> <span class="st">&quot;evil&quot;</span>)</a>
<a class="sourceLine" id="cb29-43" data-line-number="43">fortefit_forplot &lt;-<span class="st"> </span>forte_evil_fits_combined_forplot <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(., sample, plotgroup, conc_nM, forte_nested) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">unnest</span>(., <span class="dt">cols =</span> <span class="kw">c</span>(<span class="st">&quot;forte_nested&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(., <span class="dt">residuals_fittype =</span> <span class="st">&quot;forte&quot;</span>)</a>
<a class="sourceLine" id="cb29-44" data-line-number="44"></a>
<a class="sourceLine" id="cb29-45" data-line-number="45"></a>
<a class="sourceLine" id="cb29-46" data-line-number="46">forte_evil_fits_combined_plot &lt;-<span class="st"> </span><span class="kw">ggplot</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb29-47" data-line-number="47"><span class="st">  </span><span class="co">#ylab(&quot;Abs /mAU&quot;) +#xlim(c(0,1000)) +#ylim(c(-5,50)) +  #geom_vline(xintercept = mwlines, color = &quot;red&quot;, linetype=&quot;dashed&quot;, size=0.5) +</span></a>
<a class="sourceLine" id="cb29-48" data-line-number="48"><span class="st">  </span><span class="co">#geom_point(size = 2, stroke = 0.1, alpha=0.2, colour = &quot;black&quot;) +</span></a>
<a class="sourceLine" id="cb29-49" data-line-number="49"><span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">data =</span> fortefit_forplot, <span class="kw">aes</span>(<span class="dt">x=</span>time_shifted, <span class="dt">y=</span>octet, <span class="dt">colour=</span>conc_nM, <span class="dt">group =</span> plotgroup), <span class="dt">size=</span><span class="fl">0.6</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb29-50" data-line-number="50"><span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">data=</span> fortefit_forplot, <span class="kw">aes</span>(<span class="dt">x=</span>time_shifted,<span class="dt">y=</span>simulated, <span class="dt">group =</span> plotgroup), <span class="dt">size=</span><span class="fl">0.3</span>, <span class="dt">colour =</span> <span class="st">&quot;grey&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb29-51" data-line-number="51"><span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">data =</span> evilfit_forplot, <span class="kw">aes</span>(<span class="dt">x=</span>time_shifted,<span class="dt">y=</span>evilfit_corr, <span class="dt">group =</span> plotgroup), <span class="dt">size=</span><span class="fl">0.3</span>, <span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb29-52" data-line-number="52"><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="st">&quot;time: min&quot;</span>, <span class="dt">breaks =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">900</span>, <span class="dv">1800</span>, <span class="dv">2700</span>, <span class="dv">3600</span>), <span class="dt">labels =</span> <span class="cf">function</span>(breaks) breaks<span class="op">/</span><span class="dv">60</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb29-53" data-line-number="53"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="st">&quot;octet: nm&quot;</span>, <span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">0.5</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb29-54" data-line-number="54"><span class="st">  </span><span class="kw">scale_colour_gradient2</span>(<span class="dt">low=</span><span class="st">&quot;green&quot;</span>, <span class="dt">mid =</span> <span class="st">&quot;blue&quot;</span>, <span class="dt">high=</span><span class="st">&quot;red&quot;</span>, <span class="dt">midpoint =</span> <span class="dv">10</span> ,<span class="dt">space =</span><span class="st">&quot;Lab&quot;</span>, <span class="dt">trans =</span> <span class="st">&quot;log2&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="co">#,</span></a>
<a class="sourceLine" id="cb29-55" data-line-number="55"><span class="st">  </span><span class="kw">facet_grid</span>(sample <span class="op">~</span><span class="st"> </span>., <span class="dt">scales =</span> <span class="st">&quot;free_y&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb29-56" data-line-number="56"><span class="st">  </span><span class="co">#facet_grid_paginate(index ~ rec, ncol=2, nrow=4, page = i) +</span></a>
<a class="sourceLine" id="cb29-57" data-line-number="57"><span class="st">  </span><span class="kw">theme_light</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb29-58" data-line-number="58"><span class="st">  </span><span class="kw">guides</span>(<span class="dt">fill =</span> <span class="kw">guide_legend</span>(<span class="dt">title.theme =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">10</span>))) <span class="op">+</span><span class="st"> </span><span class="co">#change text size in legend</span></a>
<a class="sourceLine" id="cb29-59" data-line-number="59"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;left&quot;</span>, <span class="dt">strip.background =</span> <span class="kw">element_blank</span>(), <span class="dt">strip.text.y =</span> <span class="kw">element_blank</span>()) <span class="co"># remove facet legend</span></a>
<a class="sourceLine" id="cb29-60" data-line-number="60"><span class="kw">print</span>(forte_evil_fits_combined_plot)</a></code></pre></div>
<p><img src="index_files/figure-html/ForteBioKineticAndEvilFitPlots-1.png" width="672" /></p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb30-1" data-line-number="1"><span class="co">#ggsave(file=&quot;ggplot_ligand_ligand_temp.jpeg&quot;, plot=data_dir_all_csv_titrations_plot,device=&quot;jpeg&quot;)</span></a>
<a class="sourceLine" id="cb30-2" data-line-number="2"><span class="kw">ggsave</span>(<span class="dt">file=</span><span class="st">&quot;./forte_evil_fits_combined_plot.jpeg&quot;</span>, <span class="dt">device=</span><span class="st">&quot;jpeg&quot;</span>, <span class="dt">width =</span> <span class="dv">160</span>, <span class="dt">height =</span> <span class="dv">80</span>, <span class="dt">units =</span> <span class="kw">c</span>(<span class="st">&quot;mm&quot;</span>))</a>
<a class="sourceLine" id="cb30-3" data-line-number="3"><span class="co">#ggsave(file=&quot;./ggplot_ligand_ligand.ps&quot;, width = 120, height = 110, units = c(&quot;mm&quot;))</span></a></code></pre></div>
<div id="ForteBioKineticAndEvilFitPlotsCaption" class="figure-box">
<p>Local and bayesian fits versus data. Plots were used for Figures 3B and supplementary Figure 2A. see ms figure legend in ms for more details.</p>
</div>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb31-1" data-line-number="1">forte_evil_fits_combined_plot_corrected &lt;-<span class="st"> </span>forte_evil_fits_combined_forplot_corrected <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> .) <span class="op">+</span></a>
<a class="sourceLine" id="cb31-2" data-line-number="2"><span class="st">  </span><span class="co">#ylab(&quot;Abs /mAU&quot;) +#xlim(c(0,1000)) +#ylim(c(-5,50)) +  #geom_vline(xintercept = mwlines, color = &quot;red&quot;, linetype=&quot;dashed&quot;, size=0.5) +</span></a>
<a class="sourceLine" id="cb31-3" data-line-number="3"><span class="st">  </span><span class="co">#geom_point(size = 2, stroke = 0.1, alpha=0.2, colour = &quot;black&quot;) +</span></a>
<a class="sourceLine" id="cb31-4" data-line-number="4"><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">x=</span>time_shifted, <span class="dt">y=</span>octet, <span class="dt">colour=</span>conc_nM, <span class="dt">group =</span> plotgroup), <span class="dt">size=</span><span class="fl">0.6</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb31-5" data-line-number="5"><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">x=</span>time_shifted,<span class="dt">y=</span>simulated, <span class="dt">group =</span> plotgroup), <span class="dt">size=</span><span class="fl">0.3</span>, <span class="dt">colour =</span> <span class="st">&quot;grey&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb31-6" data-line-number="6"><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">x=</span>time_shifted,<span class="dt">y=</span>evilfit_corr, <span class="dt">group =</span> plotgroup), <span class="dt">size=</span><span class="fl">0.3</span>, <span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb31-7" data-line-number="7"><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="st">&quot;time: min&quot;</span>, <span class="dt">breaks =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">900</span>, <span class="dv">1800</span>, <span class="dv">2700</span>, <span class="dv">3600</span>), <span class="dt">labels =</span> <span class="cf">function</span>(breaks) breaks<span class="op">/</span><span class="dv">60</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb31-8" data-line-number="8"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="st">&quot;octet: nm&quot;</span>, <span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">0.5</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb31-9" data-line-number="9"><span class="st">  </span><span class="kw">scale_colour_gradient2</span>(<span class="dt">low=</span><span class="st">&quot;green&quot;</span>, <span class="dt">mid =</span> <span class="st">&quot;blue&quot;</span>, <span class="dt">high=</span><span class="st">&quot;red&quot;</span>, <span class="dt">midpoint =</span> <span class="dv">10</span> ,<span class="dt">space =</span><span class="st">&quot;Lab&quot;</span>, <span class="dt">trans =</span> <span class="st">&quot;log2&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="co">#,</span></a>
<a class="sourceLine" id="cb31-10" data-line-number="10"><span class="st">  </span><span class="kw">facet_grid</span>(sample <span class="op">~</span><span class="st"> </span>., <span class="dt">scales =</span> <span class="st">&quot;free_y&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb31-11" data-line-number="11"><span class="st">  </span><span class="co">#facet_grid_paginate(index ~ rec, ncol=2, nrow=4, page = i) +</span></a>
<a class="sourceLine" id="cb31-12" data-line-number="12"><span class="st">  </span><span class="kw">theme_light</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb31-13" data-line-number="13"><span class="st">  </span><span class="kw">guides</span>(<span class="dt">fill =</span> <span class="kw">guide_legend</span>(<span class="dt">title.theme =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">10</span>))) <span class="op">+</span><span class="st"> </span><span class="co">#change text size in legend</span></a>
<a class="sourceLine" id="cb31-14" data-line-number="14"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;left&quot;</span>, <span class="dt">strip.background =</span> <span class="kw">element_blank</span>(), <span class="dt">strip.text.y =</span> <span class="kw">element_blank</span>()) <span class="co"># remove facet legend</span></a>
<a class="sourceLine" id="cb31-15" data-line-number="15"><span class="kw">print</span>(forte_evil_fits_combined_plot_corrected)</a></code></pre></div>
<p><img src="index_files/figure-html/forte_evil_fits_combined_plot_corrected-1.png" width="672" /></p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb32-1" data-line-number="1"><span class="co">#ggsave(file=&quot;ggplot_ligand_ligand_temp.jpeg&quot;, plot=data_dir_all_csv_titrations_plot,device=&quot;jpeg&quot;)</span></a>
<a class="sourceLine" id="cb32-2" data-line-number="2"><span class="kw">ggsave</span>(<span class="dt">file=</span><span class="st">&quot;./forte_evil_fits_combined_plot_corrected.jpeg&quot;</span>, <span class="dt">device=</span><span class="st">&quot;jpeg&quot;</span>, <span class="dt">width =</span> <span class="dv">160</span>, <span class="dt">height =</span> <span class="dv">80</span>, <span class="dt">units =</span> <span class="kw">c</span>(<span class="st">&quot;mm&quot;</span>))</a>
<a class="sourceLine" id="cb32-3" data-line-number="3"><span class="co">#ggsave(file=&quot;./ggplot_ligand_ligand.ps&quot;, width = 120, height = 110, units = c(&quot;mm&quot;))</span></a></code></pre></div>
<div id="forte_evil_fits_combined_plot_correctedCaption" class="figure-box">
<p>Same plot as the previous one. However, in Evilfit the fit also comprised a baseline subtraction, which had to be added to the bayesian fits for the visualization. In the first published version, this addition was not 100% correct, but fine for visualization purposes. If you compare the previous version with this new correct one, you hardly notice any difference.</p>
</div>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb33-1" data-line-number="1">forte_fits_combined_resplot &lt;-<span class="st"> </span><span class="kw">ggplot</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb33-2" data-line-number="2"><span class="st">  </span><span class="co">#ylab(&quot;Abs /mAU&quot;) +#xlim(c(0,1000)) +#ylim(c(-5,50)) +  #geom_vline(xintercept = mwlines, color = &quot;red&quot;, linetype=&quot;dashed&quot;, size=0.5) +</span></a>
<a class="sourceLine" id="cb33-3" data-line-number="3"><span class="st">  </span><span class="co">#geom_point(size = 2, stroke = 0.1, alpha=0.2, colour = &quot;black&quot;) +</span></a>
<a class="sourceLine" id="cb33-4" data-line-number="4"><span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">data=</span>fortefit_forplot, <span class="kw">aes</span>(<span class="dt">x=</span>time_shifted, <span class="dt">y=</span>residuals, <span class="dt">colour=</span>conc_nM, <span class="dt">group =</span> plotgroup), <span class="dt">size=</span><span class="fl">0.5</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb33-5" data-line-number="5"><span class="st">  </span><span class="co">#geom_line(aes(x=time_shifted,y=simulated), size=0.5, alpha = 0.5) +</span></a>
<a class="sourceLine" id="cb33-6" data-line-number="6"><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">name =</span> <span class="ot">NULL</span>, <span class="dt">breaks =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">900</span>, <span class="dv">1800</span>, <span class="dv">2700</span>, <span class="dv">3600</span>), <span class="dt">labels =</span> <span class="cf">function</span>(breaks) breaks<span class="op">/</span><span class="dv">60</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb33-7" data-line-number="7"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="st">&quot;octet: nm&quot;</span>, <span class="dt">limits =</span> <span class="kw">c</span>(<span class="op">-</span><span class="fl">0.1</span>, <span class="fl">0.1</span>), <span class="dt">breaks =</span> <span class="kw">c</span>(<span class="op">-</span><span class="fl">0.1</span>, <span class="dv">0</span>, <span class="fl">0.1</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb33-8" data-line-number="8"><span class="st">  </span><span class="kw">scale_colour_gradient2</span>(<span class="dt">low=</span><span class="st">&quot;green&quot;</span>, <span class="dt">mid =</span> <span class="st">&quot;blue&quot;</span>, <span class="dt">high=</span><span class="st">&quot;red&quot;</span>, <span class="dt">midpoint =</span> <span class="dv">10</span> ,<span class="dt">space =</span><span class="st">&quot;Lab&quot;</span>, <span class="dt">trans =</span> <span class="st">&quot;log2&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="co">#,</span></a>
<a class="sourceLine" id="cb33-9" data-line-number="9"><span class="st">  </span><span class="kw">facet_grid</span>(sample <span class="op">~</span><span class="st"> </span>., <span class="dt">scales =</span> <span class="st">&quot;free_y&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb33-10" data-line-number="10"><span class="st">  </span><span class="co">#facet_grid_paginate(index ~ rec, ncol=2, nrow=4, page = i) +</span></a>
<a class="sourceLine" id="cb33-11" data-line-number="11"><span class="st">  </span><span class="kw">theme_light</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb33-12" data-line-number="12"><span class="st">  </span><span class="kw">guides</span>(<span class="dt">fill =</span> <span class="kw">guide_legend</span>(<span class="dt">title.theme =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">10</span>))) <span class="op">+</span><span class="st"> </span><span class="co">#change text size in legend</span></a>
<a class="sourceLine" id="cb33-13" data-line-number="13"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;left&quot;</span>, <span class="dt">strip.background =</span> <span class="kw">element_blank</span>(), <span class="dt">strip.text.y =</span> <span class="kw">element_blank</span>()) <span class="co"># remove facet legend</span></a>
<a class="sourceLine" id="cb33-14" data-line-number="14"><span class="kw">print</span>(forte_fits_combined_resplot)</a></code></pre></div>
<p><img src="index_files/figure-html/forte_fits_combined_resplot-1.png" width="672" /></p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb34-1" data-line-number="1"><span class="co">#ggsave(file=&quot;ggplot_ligand_ligand_temp.jpeg&quot;, plot=data_dir_all_csv_titrations_plot,device=&quot;jpeg&quot;)</span></a>
<a class="sourceLine" id="cb34-2" data-line-number="2"><span class="kw">ggsave</span>(<span class="dt">file=</span><span class="st">&quot;./forte_fits_combined_resplot.jpeg&quot;</span>, <span class="dt">device=</span><span class="st">&quot;jpeg&quot;</span>, <span class="dt">width =</span> <span class="dv">160</span>, <span class="dt">height =</span> <span class="dv">80</span>, <span class="dt">units =</span> <span class="kw">c</span>(<span class="st">&quot;mm&quot;</span>))</a>
<a class="sourceLine" id="cb34-3" data-line-number="3"><span class="co">#ggsave(file=&quot;./ggplot_ligand_ligand_fortefit_sel_resplot.ps&quot;, plot = data_dir_all_csv_titrations_sel_fortefit_resplot, device = &quot;ps&quot;, width = 160, height = 80, units = c(&quot;mm&quot;))</span></a></code></pre></div>
<div id="forte_fits_combined_resplotCaption" class="figure-box">
<p>Residuals of local fits versus data. Plots were not used.</p>
</div>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb35-1" data-line-number="1">evil_fits_combined_resplot &lt;-<span class="st"> </span><span class="kw">ggplot</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb35-2" data-line-number="2"><span class="st">  </span><span class="co">#ylab(&quot;Abs /mAU&quot;) +#xlim(c(0,1000)) +#ylim(c(-5,50)) +  #geom_vline(xintercept = mwlines, color = &quot;red&quot;, linetype=&quot;dashed&quot;, size=0.5) +</span></a>
<a class="sourceLine" id="cb35-3" data-line-number="3"><span class="st">  </span><span class="co">#geom_point(size = 2, stroke = 0.1, alpha=0.2, colour = &quot;black&quot;) +</span></a>
<a class="sourceLine" id="cb35-4" data-line-number="4"><span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">data=</span>evilfit_forplot, <span class="kw">aes</span>(<span class="dt">x=</span>time_shifted, <span class="dt">y=</span>evilfit_res, <span class="dt">colour=</span>conc_nM, <span class="dt">group =</span> plotgroup), <span class="dt">size=</span><span class="fl">0.5</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb35-5" data-line-number="5"><span class="st">  </span><span class="co">#geom_line(aes(x=time_shifted,y=simulated), size=0.5, alpha = 0.5) +</span></a>
<a class="sourceLine" id="cb35-6" data-line-number="6"><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">name =</span> <span class="ot">NULL</span>, <span class="dt">breaks =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">900</span>, <span class="dv">1800</span>, <span class="dv">2700</span>, <span class="dv">3600</span>), <span class="dt">labels =</span> <span class="cf">function</span>(breaks) breaks<span class="op">/</span><span class="dv">60</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb35-7" data-line-number="7"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="st">&quot;octet: nm&quot;</span>, <span class="dt">limits =</span> <span class="kw">c</span>(<span class="op">-</span><span class="fl">0.1</span>, <span class="fl">0.1</span>), <span class="dt">breaks =</span> <span class="kw">c</span>(<span class="op">-</span><span class="fl">0.1</span>, <span class="dv">0</span>, <span class="fl">0.1</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb35-8" data-line-number="8"><span class="st">  </span><span class="kw">scale_colour_gradient2</span>(<span class="dt">low=</span><span class="st">&quot;green&quot;</span>, <span class="dt">mid =</span> <span class="st">&quot;blue&quot;</span>, <span class="dt">high=</span><span class="st">&quot;red&quot;</span>, <span class="dt">midpoint =</span> <span class="dv">10</span> ,<span class="dt">space =</span><span class="st">&quot;Lab&quot;</span>, <span class="dt">trans =</span> <span class="st">&quot;log2&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="co">#,</span></a>
<a class="sourceLine" id="cb35-9" data-line-number="9"><span class="st">  </span><span class="kw">facet_grid</span>(sample <span class="op">~</span><span class="st"> </span>., <span class="dt">scales =</span> <span class="st">&quot;free_y&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb35-10" data-line-number="10"><span class="st">  </span><span class="co">#facet_grid_paginate(index ~ rec, ncol=2, nrow=4, page = i) +</span></a>
<a class="sourceLine" id="cb35-11" data-line-number="11"><span class="st">  </span><span class="kw">theme_light</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb35-12" data-line-number="12"><span class="st">  </span><span class="kw">guides</span>(<span class="dt">fill =</span> <span class="kw">guide_legend</span>(<span class="dt">title.theme =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">10</span>))) <span class="op">+</span><span class="st"> </span><span class="co">#change text size in legend</span></a>
<a class="sourceLine" id="cb35-13" data-line-number="13"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;left&quot;</span>, <span class="dt">strip.background =</span> <span class="kw">element_blank</span>(), <span class="dt">strip.text.y =</span> <span class="kw">element_blank</span>()) <span class="co"># remove facet legend</span></a>
<a class="sourceLine" id="cb35-14" data-line-number="14"><span class="kw">print</span>(evil_fits_combined_resplot)</a></code></pre></div>
<p><img src="index_files/figure-html/evil_fits_combined_resplot-1.png" width="672" /></p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb36-1" data-line-number="1"><span class="co">#ggsave(file=&quot;ggplot_ligand_ligand_temp.jpeg&quot;, plot=data_dir_all_csv_titrations_plot,device=&quot;jpeg&quot;)</span></a>
<a class="sourceLine" id="cb36-2" data-line-number="2"><span class="kw">ggsave</span>(<span class="dt">file=</span><span class="st">&quot;./evil_fits_combined_resplot.jpeg&quot;</span>, <span class="dt">device=</span><span class="st">&quot;jpeg&quot;</span>, <span class="dt">width =</span> <span class="dv">160</span>, <span class="dt">height =</span> <span class="dv">80</span>, <span class="dt">units =</span> <span class="kw">c</span>(<span class="st">&quot;mm&quot;</span>))</a></code></pre></div>
<div id="evil_fits_combined_resplotCaption" class="figure-box">
<p>Residuals of bayesian fits versus data. Plots were not used.</p>
</div>
</div>
<div id="assembling-figures-for-manuscript" class="section level2">
<h2><span class="header-section-number">1.10</span> Assembling figures for manuscript</h2>
<p>In this step the pre-figures were pre-assembled, then imported into Adobe illustrator for final polishing.</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb37-1" data-line-number="1"><span class="co"># plot for biorxiv</span></a>
<a class="sourceLine" id="cb37-2" data-line-number="2"><span class="co">#data_dir_all_csv_titrations_sel_forteplot_kdfit_combplot &lt;- ggpubr::ggarrange(data_dir_all_csv_titrations_sel_fortefit_plot, data_pall_csv_conc_titrations_ligand_eq_fit_kd_plot_selected, data_dir_sensorloads_sel_plot, data_dir_all_csv_titrations_sel_fortefit_resplot, data_dir_all_kinetics_pars_KonVsKD_2Dplot,  common.legend = TRUE, nrow = 2, ncol = 3, legend = &quot;none&quot;, heights = c(5, 2))</span></a>
<a class="sourceLine" id="cb37-3" data-line-number="3"></a>
<a class="sourceLine" id="cb37-4" data-line-number="4"><span class="co">#ggsave(file=&quot;ggplot_ligand_titrations_kdfit_combplot.jpeg&quot;, plot=data_dir_all_csv_titrations_sel_forteplot_kdfit_combplot,device=&quot;jpeg&quot;, width = 160, height = 100, units = c(&quot;mm&quot;))</span></a>
<a class="sourceLine" id="cb37-5" data-line-number="5"></a>
<a class="sourceLine" id="cb37-6" data-line-number="6"><span class="co">#ggsave(file=&quot;ggplot_ligand_titrations_kdfit_combplot.ps&quot;, plot=data_dir_all_csv_titrations_sel_forteplot_kdfit_combplot,device=&quot;ps&quot;, width = 160, height = 100, units = c(&quot;mm&quot;))</span></a>
<a class="sourceLine" id="cb37-7" data-line-number="7"></a>
<a class="sourceLine" id="cb37-8" data-line-number="8"><span class="co"># plot for new submission</span></a>
<a class="sourceLine" id="cb37-9" data-line-number="9">data_dir_all_csv_comp_combplot &lt;-<span class="st"> </span>ggpubr<span class="op">::</span><span class="kw">ggarrange</span>(data_dir_all_csv_comp_forteplot, data_dir_sensorloads_comp_plot, <span class="dt">common.legend =</span> <span class="ot">TRUE</span>, <span class="dt">nrow =</span> <span class="dv">1</span>, <span class="dt">ncol =</span> <span class="dv">2</span>, <span class="dt">widths =</span> <span class="kw">c</span>(<span class="fl">0.3125</span>, <span class="fl">0.1875</span>))</a>
<a class="sourceLine" id="cb37-10" data-line-number="10"></a>
<a class="sourceLine" id="cb37-11" data-line-number="11"><span class="kw">ggsave</span>(<span class="dt">file=</span><span class="st">&quot;data_dir_all_csv_comp_combplot.jpeg&quot;</span>, <span class="dt">plot=</span>data_dir_all_csv_comp_combplot,<span class="dt">device=</span><span class="st">&quot;jpeg&quot;</span>, <span class="dt">width =</span> <span class="dv">70</span>, <span class="dt">height =</span> <span class="dv">40</span>, <span class="dt">units =</span> <span class="kw">c</span>(<span class="st">&quot;mm&quot;</span>))</a>
<a class="sourceLine" id="cb37-12" data-line-number="12"></a>
<a class="sourceLine" id="cb37-13" data-line-number="13"><span class="kw">ggsave</span>(<span class="dt">file=</span><span class="st">&quot;data_dir_all_csv_comp_combplot.ps&quot;</span>, <span class="dt">plot=</span>data_dir_all_csv_comp_combplot,<span class="dt">device=</span><span class="st">&quot;ps&quot;</span>, <span class="dt">width =</span> <span class="dv">70</span>, <span class="dt">height =</span> <span class="dv">40</span>, <span class="dt">units =</span> <span class="kw">c</span>(<span class="st">&quot;mm&quot;</span>))</a>
<a class="sourceLine" id="cb37-14" data-line-number="14"></a>
<a class="sourceLine" id="cb37-15" data-line-number="15"></a>
<a class="sourceLine" id="cb37-16" data-line-number="16">data_dir_all_csv_titrations_sel_forteplot_kdfit_combplot_pre1 &lt;-<span class="st"> </span>ggpubr<span class="op">::</span><span class="kw">ggarrange</span>(forte_fits_combined_resplot, evil_fits_combined_resplot, <span class="dt">common.legend =</span> <span class="ot">TRUE</span>, <span class="dt">nrow =</span> <span class="dv">2</span>, <span class="dt">ncol =</span> <span class="dv">1</span>,<span class="dt">legend =</span> <span class="st">&quot;none&quot;</span>)</a>
<a class="sourceLine" id="cb37-17" data-line-number="17"><span class="kw">ggsave</span>(<span class="dt">file=</span><span class="st">&quot;data_dir_all_csv_titrations_sel_forteplot_kdfit_combplot_pre.jpeg&quot;</span>, <span class="dt">plot=</span>data_dir_all_csv_titrations_sel_forteplot_kdfit_combplot_pre1,<span class="dt">device=</span><span class="st">&quot;jpeg&quot;</span>, <span class="dt">width =</span> <span class="dv">80</span>, <span class="dt">height =</span> <span class="dv">60</span>, <span class="dt">units =</span> <span class="kw">c</span>(<span class="st">&quot;mm&quot;</span>))</a>
<a class="sourceLine" id="cb37-18" data-line-number="18"></a>
<a class="sourceLine" id="cb37-19" data-line-number="19">data_dir_all_csv_titrations_sel_forteplot_kdfit_combplot_pre2 &lt;-<span class="st"> </span>ggpubr<span class="op">::</span><span class="kw">ggarrange</span>(data_dir_sensorloads_sel_plot, data_dir_sensorloads_sel_plot, <span class="dt">common.legend =</span> <span class="ot">TRUE</span>, <span class="dt">nrow =</span> <span class="dv">2</span>, <span class="dt">ncol =</span> <span class="dv">1</span>,<span class="dt">legend =</span> <span class="st">&quot;none&quot;</span>)</a>
<a class="sourceLine" id="cb37-20" data-line-number="20"><span class="kw">ggsave</span>(<span class="dt">file=</span><span class="st">&quot;data_dir_all_csv_titrations_sel_forteplot_kdfit_combplot_pre2.jpeg&quot;</span>, <span class="dt">plot=</span>data_dir_all_csv_titrations_sel_forteplot_kdfit_combplot_pre2,<span class="dt">device=</span><span class="st">&quot;jpeg&quot;</span>, <span class="dt">width =</span> <span class="dv">80</span>, <span class="dt">height =</span> <span class="dv">60</span>, <span class="dt">units =</span> <span class="kw">c</span>(<span class="st">&quot;mm&quot;</span>))</a>
<a class="sourceLine" id="cb37-21" data-line-number="21"></a>
<a class="sourceLine" id="cb37-22" data-line-number="22"></a>
<a class="sourceLine" id="cb37-23" data-line-number="23"></a>
<a class="sourceLine" id="cb37-24" data-line-number="24">data_dir_all_csv_titrations_sel_forteplot_kdfit_combplot_new &lt;-<span class="st"> </span>ggpubr<span class="op">::</span><span class="kw">ggarrange</span>(forte_evil_fits_combined_plot, data_pall_csv_conc_titrations_ligand_eq_fit_kd_plot_selected, data_dir_sensorloads_sel_plot, plotdistr_tib_Kdkoff_log10_plot, data_dir_all_csv_titrations_sel_forteplot_kdfit_combplot_pre1, <span class="dt">common.legend =</span> <span class="ot">TRUE</span>, <span class="dt">nrow =</span> <span class="dv">2</span>, <span class="dt">ncol =</span> <span class="dv">4</span>, <span class="dt">legend =</span> <span class="st">&quot;none&quot;</span>, <span class="dt">heights =</span> <span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">3</span>), <span class="dt">widths =</span> <span class="kw">c</span>(<span class="fl">2.5</span>, <span class="fl">1.5</span>, <span class="fl">1.5</span>, <span class="fl">2.5</span>))</a>
<a class="sourceLine" id="cb37-25" data-line-number="25"></a>
<a class="sourceLine" id="cb37-26" data-line-number="26"><span class="kw">print</span>(data_dir_all_csv_titrations_sel_forteplot_kdfit_combplot_new)</a></code></pre></div>
<p><img src="index_files/figure-html/assembledbestdatafigures-1.png" width="672" /></p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb38-1" data-line-number="1"><span class="kw">ggsave</span>(<span class="dt">file=</span><span class="st">&quot;ggplot_ligand_titrations_kdfit_combplot_new.jpeg&quot;</span>, <span class="dt">plot=</span>data_dir_all_csv_titrations_sel_forteplot_kdfit_combplot_new,<span class="dt">device=</span><span class="st">&quot;jpeg&quot;</span>, <span class="dt">width =</span> <span class="dv">140</span>, <span class="dt">height =</span> <span class="dv">140</span>, <span class="dt">units =</span> <span class="kw">c</span>(<span class="st">&quot;mm&quot;</span>))</a>
<a class="sourceLine" id="cb38-2" data-line-number="2"></a>
<a class="sourceLine" id="cb38-3" data-line-number="3"><span class="kw">ggsave</span>(<span class="dt">file=</span><span class="st">&quot;ggplot_ligand_titrations_kdfit_combplot_new.ps&quot;</span>, <span class="dt">plot=</span>data_dir_all_csv_titrations_sel_forteplot_kdfit_combplot_new,<span class="dt">device=</span><span class="st">&quot;ps&quot;</span>, <span class="dt">width =</span> <span class="dv">140</span>, <span class="dt">height =</span> <span class="dv">140</span>, <span class="dt">units =</span> <span class="kw">c</span>(<span class="st">&quot;mm&quot;</span>))</a></code></pre></div>
<div id="assembledbestdatafiguresCaption" class="figure-box">
<p>This is the almost final figure that was used to generate Figures 3B and supplemental Figure 2A.</p>
</div>
</div>
<div id="loooking-at-expected-maximum-responses-bases-on-ligandanalyte-mw-ratios" class="section level2">
<h2><span class="header-section-number">1.11</span> Loooking at expected maximum responses bases on ligand/analyte MW ratios</h2>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb39-1" data-line-number="1">pull_KDpars_f &lt;-<span class="st"> </span><span class="cf">function</span>(df){</a>
<a class="sourceLine" id="cb39-2" data-line-number="2">  df_mod &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(., kd_stats <span class="op">==</span><span class="st"> </span>kd_stats) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(kd_term, kd_stats_value) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pivot_wider</span>(., <span class="dt">names_from =</span> <span class="kw">c</span>(<span class="st">&quot;kd_stats&quot;</span>, <span class="st">&quot;kd_term&quot;</span>), <span class="dt">names_sep =</span> <span class="st">&quot;_&quot;</span>, <span class="dt">values_from =</span><span class="kw">c</span>(<span class="st">&quot;kd_stats_value&quot;</span>))</a>
<a class="sourceLine" id="cb39-3" data-line-number="3">  <span class="kw">return</span>(df_mod)</a>
<a class="sourceLine" id="cb39-4" data-line-number="4">}</a>
<a class="sourceLine" id="cb39-5" data-line-number="5"></a>
<a class="sourceLine" id="cb39-6" data-line-number="6">response_ratios_Rmax &lt;-<span class="st"> </span>data_pall_csv_conc_titrations_ligand_eq_fit_pars_table <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(., sample, rec, exprun_digit,kd_pars_long_names) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(., <span class="dt">kd_pars_ratio =</span> purrr<span class="op">::</span><span class="kw">map</span>(kd_pars_long_names, <span class="op">~</span>dplyr<span class="op">::</span><span class="kw">filter</span>(., kd_stats <span class="op">==</span><span class="st"> &quot;estimate&quot;</span>)) ) </a>
<a class="sourceLine" id="cb39-7" data-line-number="7"></a>
<a class="sourceLine" id="cb39-8" data-line-number="8">response_ratios_Rmax_join &lt;-<span class="st"> </span>response_ratios_Rmax <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(., <span class="op">-</span>kd_pars_long_names) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">unnest</span>(., <span class="kw">c</span>(<span class="st">&quot;kd_pars_ratio&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(., exprun_digit <span class="op">&gt;</span><span class="st"> </span><span class="dv">802</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(sample, kd_term, kd_stats_value) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(., kd_term <span class="op">==</span><span class="st"> &quot;R&quot;</span>)</a>
<a class="sourceLine" id="cb39-9" data-line-number="9"></a>
<a class="sourceLine" id="cb39-10" data-line-number="10">response_ratios &lt;-<span class="st"> </span>data_dir_sensors_raw_xls_longer_sensorloads_unnested <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(., exprun_digit <span class="op">&gt;</span><span class="st"> </span><span class="dv">802</span>) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(., sample, rec, exprun_digit, sensor, diff_id1) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(sample) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">summarize</span>(., <span class="dt">mean_load =</span> <span class="kw">mean</span>(diff_id1),<span class="dt">mean_sd =</span> <span class="kw">sd</span>(diff_id1)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">left_join</span>(., response_ratios_Rmax_join) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(., <span class="dt">Rratio =</span> kd_stats_value<span class="op">/</span>mean_load)</a>
<a class="sourceLine" id="cb39-11" data-line-number="11"></a>
<a class="sourceLine" id="cb39-12" data-line-number="12">response_ratios_kable &lt;-<span class="st"> </span>response_ratios <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(., <span class="dt">sensor_load =</span> <span class="kw">round</span>(mean_load, <span class="dv">2</span>), <span class="dt">sensor_load_sd =</span> <span class="kw">round</span>(mean_sd, <span class="dv">2</span>), <span class="dt">bound_max =</span> <span class="kw">round</span>(kd_stats_value, <span class="dv">2</span>), <span class="dt">load_signal_ratio =</span> <span class="kw">round</span>(Rratio, <span class="dv">1</span>)) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(., sensor_load, sensor_load_sd, bound_max, load_signal_ratio)</a>
<a class="sourceLine" id="cb39-13" data-line-number="13"></a>
<a class="sourceLine" id="cb39-14" data-line-number="14"><span class="kw">kable</span>(response_ratios_kable, <span class="dt">caption =</span> <span class="st">&quot;**Calculated maximum response versus load ratios.**&quot;</span>)</a></code></pre></div>
<table>
<caption>
<span id="tab:ResponseRatios">Table 1.1: </span><strong>Calculated maximum response versus load ratios.</strong>
</caption>
<thead>
<tr>
<th style="text-align:right;">
sensor_load
</th>
<th style="text-align:right;">
sensor_load_sd
</th>
<th style="text-align:right;">
bound_max
</th>
<th style="text-align:right;">
load_signal_ratio
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
0.18
</td>
<td style="text-align:right;">
0.01
</td>
<td style="text-align:right;">
0.38
</td>
<td style="text-align:right;">
2.1
</td>
</tr>
<tr>
<td style="text-align:right;">
0.18
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.35
</td>
<td style="text-align:right;">
2.0
</td>
</tr>
</tbody>
</table>
<div id="ResponseRatiosTab" class="table-box">
<p>MW-based response estimation is typically applied to obtain estimates about active ligand concentrations as well as ligand acitivity of SPR data <span class="citation">(Merwe 2003)</span>. This relation is not established for BLI and was therefore not mentioned in the ms. However, it is interesting to note that the response/load ratio of 2 closely matches the theoretically expected ratio based on the MW of Ty1 and RBD with MW of 14 and 25 kDa, respectively.</p>
</div>
</div>
</div>
<div id="analysis-of-itc-data" class="section level1">
<h1><span class="header-section-number">2</span> Analysis of ITC data</h1>
<p>Although the octet binding data clearly revealed specific binding, local fits and bayesian analysis indicated sensor surface related deviations from a perfect 1:1 binding. Therefore we also established in solution ITC measurements in order to exclude any surface-related artifacts of the determined affinity values.
Data and binding parameters were analyzed using the MicroCal PeakITC software (Malvern), applying the 1:1 binding model with following equations as described in detalil in the <a href="https://www.malvernpanalytical.com/en/learn/knowledge-center/user-manuals/MAN0576EN">software manual</a>:
The two most important equations for analysis are re-written in the following.
<span class="math display" id="eq:itc">\[\begin{equation}
Q = \frac{nM_t\Delta HV_0}{2}[1+\frac{X_t}{nM_t}+\frac{1}{nKM_t}-\sqrt{(1+\frac{X_t}{nM_t}+\frac{1}{nKM_t})^2-\frac{4X_t}{nM_t}}
\tag{2.1}
\end{equation}\]</span>
This expression for the heat change Q only applies to the liquid contained in volume <span class="math inline">\(V_0\)</span> of the cell. Therefore, the equation is corrected for the displaced volume after each injection:
<span class="math display" id="eq:itc2">\[\begin{equation}
\Delta Q(i)=Q(i)+\frac{dV_i}{V_0}(\frac{Q(i)+Q(i-1)}{2})-Q(i-1)
\tag{2.2}
\end{equation}\]</span></p>
<p>with K: binding constant, n: number of sites, M: free concentration of macromolecule in active volume (NTF2 dimer), X: free concentration of ligand (USP or CAP), <span class="math inline">\(\Delta H\)</span>: molar heat of binding.</p>
<p>The software also gives out the Gibbs enery from <span class="math inline">\(\Delta G = -RTlnK\)</span> and the entropy cost (-T<span class="math inline">\(\Delta S\)</span>) from <span class="math inline">\(\Delta G = \Delta H - T\Delta S\)</span>.</p>
<div id="importing-itc-data" class="section level2">
<h2><span class="header-section-number">2.1</span> importing ITC data</h2>
<p>The processed data were exported from MicroCal PeakITC software (Malvern) as csv files and imported using following code.</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb40-1" data-line-number="1">filelist_itc =<span class="st"> </span><span class="kw">list.files</span>(<span class="dt">path =</span> <span class="st">&quot;./data_itc/&quot;</span>, <span class="dt">pattern =</span> <span class="st">&quot;*.csv&quot;</span>)</a>
<a class="sourceLine" id="cb40-2" data-line-number="2">filelist_itc.dat &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">folder =</span> <span class="kw">c</span>(<span class="kw">rep</span>(<span class="st">&quot;./data_itc/&quot;</span>, <span class="kw">length</span>(filelist_itc))), <span class="dt">files =</span> filelist_itc)</a>
<a class="sourceLine" id="cb40-3" data-line-number="3">filelist_itc.dat<span class="op">$</span>read &lt;-<span class="st"> </span><span class="kw">paste</span>(filelist_itc.dat<span class="op">$</span>folder, filelist_itc.dat<span class="op">$</span>files, <span class="dt">sep =</span> <span class="st">&quot;&quot;</span>)</a>
<a class="sourceLine" id="cb40-4" data-line-number="4">filelist_itc.tib &lt;-<span class="st"> </span><span class="kw">as_tibble</span>(filelist_itc.dat)</a>
<a class="sourceLine" id="cb40-5" data-line-number="5">filelist_itcdata.tib &lt;-<span class="st"> </span>filelist_itc.tib <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(., <span class="dt">filetype =</span> <span class="kw">str_extract</span>(read, <span class="st">&quot;Raw|FitPars|FinalFigure|InjTab|NormalizedInjHeat&quot;</span>)) </a>
<a class="sourceLine" id="cb40-6" data-line-number="6"></a>
<a class="sourceLine" id="cb40-7" data-line-number="7">filelistdata_itctitrations.tib &lt;-<span class="st"> </span>filelist_itcdata.tib <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(., filetype <span class="op">==</span><span class="st"> &quot;FinalFigure&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(files,read)  <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">separate</span>(., files, <span class="kw">c</span>(<span class="st">&quot;filename&quot;</span>, <span class="st">&quot;filetype1&quot;</span>, <span class="st">&quot;filetype2&quot;</span>), <span class="dt">sep =</span> <span class="st">&quot;_&quot;</span>, <span class="dt">remove =</span> <span class="ot">FALSE</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">separate</span>(., filename, <span class="kw">c</span>(<span class="st">&quot;date&quot;</span>, <span class="st">&quot;cell&quot;</span>, <span class="st">&quot;syringe&quot;</span>, <span class="st">&quot;runid&quot;</span>), <span class="dt">sep =</span><span class="st">&quot;x&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(., <span class="dt">cell_corr =</span> <span class="kw">case_when</span>((cell <span class="op">==</span><span class="st"> &quot;RBB&quot;</span> <span class="op">&amp;</span><span class="st"> </span>filetype1 <span class="op">==</span><span class="st"> &quot;ctrl&quot;</span>) <span class="op">~</span><span class="st"> &quot;HBS&quot;</span>, (cell <span class="op">==</span><span class="st"> &quot;RBB&quot;</span> <span class="op">&amp;</span><span class="st"> </span>filetype1 <span class="op">==</span><span class="st"> &quot;sample&quot;</span>) <span class="op">~</span><span class="st"> &quot;RBD&quot;</span>, <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> </span>cell)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">data =</span> purrr<span class="op">::</span><span class="kw">map</span>(read,<span class="op">~</span><span class="kw">read_csv</span>(.,<span class="dt">col_names =</span> <span class="ot">TRUE</span>) )) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(., <span class="dt">data_mod =</span> purrr<span class="op">::</span><span class="kw">map</span>(data, <span class="op">~</span><span class="kw">gather</span>(.,<span class="st">&quot;Fit_X&quot;</span>, <span class="st">&quot;Fit_Y&quot;</span>,<span class="st">&quot;NDH_X&quot;</span>,<span class="st">&quot;NDH_Y&quot;</span>,<span class="dt">key=</span><span class="st">&quot;label&quot;</span>,<span class="dt">value=</span><span class="st">&quot;value&quot;</span>))) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(., <span class="dt">data_mod =</span> purrr<span class="op">::</span><span class="kw">map</span>(data_mod, <span class="op">~</span><span class="kw">separate</span>(.,label,<span class="kw">c</span>(<span class="st">&quot;type&quot;</span>,<span class="st">&quot;axis&quot;</span>), <span class="dt">sep=</span><span class="st">&quot;_&quot;</span>))) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(., <span class="dt">data_mod =</span> purrr<span class="op">::</span><span class="kw">map</span>(data_mod, <span class="op">~</span><span class="kw">spread</span>(.,<span class="dt">key=</span><span class="st">&quot;axis&quot;</span>,<span class="dt">value=</span><span class="st">&quot;value&quot;</span>))) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(., <span class="dt">data_fit =</span> purrr<span class="op">::</span><span class="kw">map</span>(data, <span class="op">~</span>dplyr<span class="op">::</span><span class="kw">select</span>(.,Fit_X, Fit_Y, NDH_X, NDH_Y))) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(., <span class="dt">filename =</span> files) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(., <span class="op">-</span>files)</a>
<a class="sourceLine" id="cb40-8" data-line-number="8"></a>
<a class="sourceLine" id="cb40-9" data-line-number="9"><span class="co">#1 kcal is 4184 J</span></a>
<a class="sourceLine" id="cb40-10" data-line-number="10"><span class="co"># R: 8.3145 </span></a>
<a class="sourceLine" id="cb40-11" data-line-number="11"><span class="co"># T (37+272)</span></a>
<a class="sourceLine" id="cb40-12" data-line-number="12"><span class="co"># RTlnK = dG</span></a>
<a class="sourceLine" id="cb40-13" data-line-number="13"></a>
<a class="sourceLine" id="cb40-14" data-line-number="14">filelistdata_itctable.tib &lt;-<span class="st"> </span>filelist_itcdata.tib <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(., filetype <span class="op">==</span><span class="st"> &quot;FitPars&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">data =</span> purrr<span class="op">::</span><span class="kw">map</span>(read,<span class="op">~</span><span class="kw">read_csv</span>(.,<span class="dt">col_names =</span> <span class="kw">c</span>(<span class="st">&quot;filename&quot;</span>, <span class="st">&quot;temp&quot;</span>, <span class="st">&quot;binding&quot;</span>, <span class="st">&quot;syr_conc&quot;</span>, <span class="st">&quot;cell_conc&quot;</span>, <span class="st">&quot;unknown&quot;</span>, <span class="st">&quot;fitted&quot;</span>, <span class="st">&quot;nsites&quot;</span>, <span class="st">&quot;kd&quot;</span>, <span class="st">&quot;dH&quot;</span>, <span class="st">&quot;dG&quot;</span>, <span class="st">&quot;mTdS&quot;</span>, <span class="st">&quot;offset&quot;</span>), <span class="dt">skip =</span> <span class="dv">1</span>) )) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">data =</span> purrr<span class="op">::</span><span class="kw">map</span>(data,<span class="op">~</span>dplyr<span class="op">::</span><span class="kw">select</span>(.,filename, syr_conc, cell_conc, nsites, kd, dH, dG, mTdS, offset))) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">data =</span> purrr<span class="op">::</span><span class="kw">map</span>(data,<span class="op">~</span>dplyr<span class="op">::</span><span class="kw">mutate</span>(.,filename, syr_conc, cell_conc, <span class="dt">nsites =</span> <span class="kw">as.numeric</span>(nsites), <span class="dt">kd =</span> <span class="kw">as.numeric</span>(kd), <span class="dt">dH =</span> <span class="kw">as.numeric</span>(dH), <span class="dt">dG =</span> <span class="kw">as.numeric</span>(dG), <span class="dt">mTdS =</span> <span class="kw">as.numeric</span>(mTdS), <span class="dt">offset =</span> <span class="kw">as.numeric</span>(offset)))) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(files, data) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">unnest</span>(., data) </a>
<a class="sourceLine" id="cb40-15" data-line-number="15"></a>
<a class="sourceLine" id="cb40-16" data-line-number="16"></a>
<a class="sourceLine" id="cb40-17" data-line-number="17">filelistdata_titrations_forplot &lt;-<span class="st"> </span>filelistdata_itctitrations.tib <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">ligand_id =</span> <span class="kw">paste</span>(syringe, cell_corr, <span class="dt">sep =</span> <span class="st">&quot;_&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(., <span class="dt">ligand_id =</span> <span class="kw">as.numeric</span>(runid)) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(., <span class="op">-</span>data) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(., <span class="dt">gglegend =</span> <span class="kw">paste</span>(cell_corr, syringe, <span class="dt">sep =</span> <span class="st">&quot;_&quot;</span>), <span class="dt">ggid =</span> <span class="kw">paste</span>(cell_corr, syringe, runid, <span class="dt">sep =</span> <span class="st">&quot;_&quot;</span>) ) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">data_mod =</span> purrr<span class="op">::</span><span class="kw">map</span>(data_mod, <span class="op">~</span>dplyr<span class="op">::</span><span class="kw">mutate</span>(., <span class="dt">DP_Y_base =</span> DP_Y <span class="op">-</span><span class="st"> </span>Baseline_Y))) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(., <span class="dt">plotorder =</span> <span class="kw">case_when</span>(syringe <span class="op">==</span><span class="st"> &quot;NBTY1&quot;</span> <span class="op">&amp;</span><span class="st"> </span>filetype1 <span class="op">==</span><span class="st"> &quot;sample&quot;</span> <span class="op">~</span><span class="st"> &quot;id2:nbTy1&quot;</span>, syringe <span class="op">==</span><span class="st"> &quot;NBVH52&quot;</span> <span class="op">&amp;</span><span class="st"> </span>filetype1 <span class="op">==</span><span class="st"> &quot;sample&quot;</span> <span class="op">~</span><span class="st"> &quot;id1:NP-VHH1&quot;</span>, syringe <span class="op">==</span><span class="st"> &quot;NBTY1&quot;</span> <span class="op">&amp;</span><span class="st"> </span>filetype1 <span class="op">==</span><span class="st"> &quot;ctrl&quot;</span> <span class="op">~</span><span class="st"> &quot;id3:nbTy1ctrl&quot;</span>, <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> &quot;none&quot;</span>))</a>
<a class="sourceLine" id="cb40-18" data-line-number="18"></a>
<a class="sourceLine" id="cb40-19" data-line-number="19">filelistictdata_raw.tib &lt;-<span class="st"> </span>filelist_itcdata.tib <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(., filetype <span class="op">==</span><span class="st"> &quot;Raw&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(files,read) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">data =</span> purrr<span class="op">::</span><span class="kw">map</span>(read,<span class="op">~</span><span class="kw">read_csv</span>(.), <span class="dt">skip =</span> <span class="dv">1</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">unnest</span>(data) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>files, <span class="op">-</span>read) </a>
<a class="sourceLine" id="cb40-20" data-line-number="20"></a>
<a class="sourceLine" id="cb40-21" data-line-number="21">filelistdata_raw_longer.tib &lt;-<span class="st"> </span>filelistictdata_raw.tib <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pivot_longer</span>(., <span class="dt">cols =</span> <span class="kw">everything</span>(), <span class="dt">names_to =</span> <span class="kw">c</span>(<span class="st">&quot;type&quot;</span>), <span class="dt">values_to =</span> <span class="kw">c</span>(<span class="st">&quot;value&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(., <span class="dt">filename =</span> <span class="kw">str_extract</span>(type, <span class="dt">pattern =</span> <span class="st">&quot;[:digit:]{8}x(RBD|RBB|HBS)x(NBTY1|NBVH52)&quot;</span>), <span class="dt">XY =</span> <span class="kw">str_extract</span>(type, <span class="dt">pattern =</span> <span class="st">&quot;_[XY]&quot;</span>), <span class="dt">controlq =</span> <span class="kw">str_detect</span>(type, <span class="dt">pattern =</span> <span class="st">&quot;ctrl&quot;</span>),  <span class="dt">sampleq =</span> <span class="kw">str_detect</span>(type, <span class="dt">pattern =</span> <span class="st">&quot;[:digit:]{2}_[XY]&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(., <span class="dt">XY =</span> <span class="kw">str_extract</span>(XY, <span class="dt">pattern =</span> <span class="st">&quot;[XY]&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(., <span class="dt">cell_corr =</span> <span class="kw">case_when</span>(controlq <span class="op">==</span><span class="st"> &quot;FALSE&quot;</span>  <span class="op">~</span><span class="st"> &quot;RBD&quot;</span>, controlq <span class="op">==</span><span class="st"> &quot;TRUE&quot;</span>  <span class="op">~</span><span class="st"> &quot;HBS&quot;</span>,  <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> &quot;none&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(., <span class="dt">runid =</span> <span class="kw">str_extract</span>(type, <span class="dt">pattern =</span> <span class="st">&quot;x[:digit:]{2}&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(., <span class="dt">runid =</span> <span class="kw">as.numeric</span>(<span class="kw">str_extract</span>(runid, <span class="dt">pattern =</span> <span class="st">&quot;[:digit:]{2}&quot;</span>))) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pivot_wider</span>(., <span class="dt">id_cols =</span> <span class="kw">c</span>(<span class="st">&quot;filename&quot;</span>,<span class="st">&quot;cell_corr&quot;</span>, <span class="st">&quot;runid&quot;</span>), <span class="dt">names_from =</span> <span class="kw">c</span>(<span class="st">&quot;XY&quot;</span>), <span class="dt">values_from =</span> <span class="kw">c</span>(<span class="st">&quot;value&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">unnest</span>(., <span class="dt">cols =</span> <span class="kw">c</span>(<span class="st">&quot;X&quot;</span>, <span class="st">&quot;Y&quot;</span>)) </a></code></pre></div>
</div>
<div id="itc-primary-plots" class="section level2">
<h2><span class="header-section-number">2.2</span> ITC primary plots</h2>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb41-1" data-line-number="1">filelistdata_titrations_forplot1 &lt;-<span class="st"> </span>filelistdata_titrations_forplot <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(., (filetype1 <span class="op">==</span><span class="st"> &quot;sample&quot;</span> <span class="op">|</span><span class="st"> </span>filetype1 <span class="op">==</span><span class="st"> &quot;ctrl&quot;</span>) <span class="op">&amp;</span><span class="st"> </span>(syringe <span class="op">==</span><span class="st"> &quot;NBTY1&quot;</span> <span class="op">&amp;</span><span class="st"> </span>ligand_id <span class="op">&gt;</span><span class="st"> </span><span class="dv">1</span> <span class="op">|</span><span class="st"> </span>syringe <span class="op">==</span><span class="st"> &quot;NBVH52&quot;</span>))  <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">unnest</span>(., <span class="dt">cols =</span> <span class="kw">c</span>(<span class="st">&quot;data_mod&quot;</span>))</a>
<a class="sourceLine" id="cb41-2" data-line-number="2"></a>
<a class="sourceLine" id="cb41-3" data-line-number="3">filelistdata_titrations_forplot1_colourscales &lt;-<span class="st"> </span>filelistdata_titrations_forplot1 <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">summarize</span>(., <span class="dt">colour_min =</span> <span class="kw">round</span>(<span class="kw">min</span>(DP_Y), <span class="dv">2</span>)<span class="op">-</span><span class="fl">0.01</span>, <span class="dt">colour_max =</span> <span class="kw">round</span>(<span class="kw">max</span>(DP_Y),<span class="dv">2</span>)<span class="op">+</span><span class="fl">0.01</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pivot_longer</span>(., <span class="dt">cols =</span> <span class="kw">contains</span>(<span class="st">&quot;colour&quot;</span>) ) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(., value) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pull</span>()</a>
<a class="sourceLine" id="cb41-4" data-line-number="4"></a>
<a class="sourceLine" id="cb41-5" data-line-number="5">itc_ggplot &lt;-<span class="st"> </span>filelistdata_titrations_forplot <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(., (filetype1 <span class="op">==</span><span class="st"> &quot;sample&quot;</span> <span class="op">|</span><span class="st"> </span>filetype1 <span class="op">==</span><span class="st"> &quot;ctrl&quot;</span>) <span class="op">&amp;</span><span class="st"> </span>(syringe <span class="op">==</span><span class="st"> &quot;NBTY1&quot;</span> <span class="op">&amp;</span><span class="st"> </span>ligand_id <span class="op">&gt;</span><span class="st"> </span><span class="dv">1</span> <span class="op">|</span><span class="st"> </span>syringe <span class="op">==</span><span class="st"> &quot;NBVH52&quot;</span>))  <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">unnest</span>(., <span class="dt">cols =</span> <span class="kw">c</span>(<span class="st">&quot;data_mod&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(., <span class="dt">DP_Y_absval =</span> (DP_Y<span class="op">^</span><span class="dv">2</span>)<span class="op">^</span><span class="fl">0.5</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> DP_X, <span class="dt">y =</span> DP_Y, <span class="dt">colour =</span> DP_Y)) <span class="op">+</span></a>
<a class="sourceLine" id="cb41-6" data-line-number="6"><span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">size=</span><span class="fl">0.75</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb41-7" data-line-number="7"><span class="st">  </span><span class="kw">theme_light</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb41-8" data-line-number="8"><span class="st">  </span><span class="kw">scale_colour_gradient2</span>(<span class="dt">low =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">mid =</span> <span class="st">&quot;grey&quot;</span>, <span class="dt">high =</span> <span class="st">&quot;blue&quot;</span>, <span class="dt">space =</span> <span class="st">&quot;Lab&quot;</span>, <span class="dt">midpoint =</span> <span class="dv">0</span>, <span class="dt">limits =</span> filelistdata_titrations_forplot1_colourscales) <span class="op">+</span></a>
<a class="sourceLine" id="cb41-9" data-line-number="9"><span class="st">  </span><span class="co">#scale_color_aaas() +</span></a>
<a class="sourceLine" id="cb41-10" data-line-number="10"><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="st">&quot;time: min&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb41-11" data-line-number="11"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="st">&quot;heat/inj: ucal/s&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb41-12" data-line-number="12"><span class="st">  </span><span class="kw">facet_grid</span>(plotorder <span class="op">+</span><span class="st"> </span>ligand_id <span class="op">~</span><span class="st"> </span>.) <span class="op">+</span></a>
<a class="sourceLine" id="cb41-13" data-line-number="13"><span class="st">  </span><span class="kw">theme_minimal</span>()</a>
<a class="sourceLine" id="cb41-14" data-line-number="14">  <span class="kw">print</span>(itc_ggplot)</a></code></pre></div>
<p><img src="index_files/figure-html/itcplot1-1.png" width="672" /></p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb42-1" data-line-number="1">  <span class="kw">ggsave</span>(<span class="st">&quot;./itc_ggplot.jpeg&quot;</span>, <span class="dt">device =</span> <span class="st">&quot;jpeg&quot;</span>,<span class="dt">width =</span> <span class="dv">120</span>, <span class="dt">height =</span> <span class="dv">90</span>, <span class="dt">units =</span> <span class="kw">c</span>(<span class="st">&quot;mm&quot;</span>))</a>
<a class="sourceLine" id="cb42-2" data-line-number="2">  <span class="co">#ggsave(&quot;./itc_ggplot.ps&quot;, device = &quot;ps&quot;,width = 120, height = 90, units = c(&quot;mm&quot;))</span></a></code></pre></div>
<div id="itcplot1Caption" class="figure-box">
<p>Primary ITC data were plotted in panels, used for Figure 3C and supplemental Figure 2B in ms.</p>
</div>
</div>
<div id="itc-binding-isotherms-and-thermodynamic-signatures" class="section level2">
<h2><span class="header-section-number">2.3</span> ITC binding isotherms and thermodynamic signatures</h2>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb43-1" data-line-number="1">itc_fit_ggplot &lt;-<span class="st"> </span>filelistdata_titrations_forplot <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(., filetype1 <span class="op">==</span><span class="st"> &quot;sample&quot;</span> <span class="op">&amp;</span><span class="st"> </span>(syringe <span class="op">==</span><span class="st"> &quot;NBTY1&quot;</span> <span class="op">&amp;</span><span class="st"> </span>ligand_id <span class="op">&gt;</span><span class="st"> </span><span class="dv">1</span> <span class="op">|</span><span class="st"> </span>syringe <span class="op">==</span><span class="st"> &quot;NBVH52&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(., <span class="op">-</span>data_mod) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">unnest</span>(., <span class="kw">c</span>(<span class="st">&quot;data_fit&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Fit_X, <span class="dt">y =</span> Fit_Y, <span class="dt">group =</span> <span class="kw">factor</span>(filename))) <span class="op">+</span></a>
<a class="sourceLine" id="cb43-2" data-line-number="2"><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">colour =</span> plotorder), <span class="dt">size=</span><span class="dv">1</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb43-3" data-line-number="3"><span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">x =</span> NDH_X, <span class="dt">y =</span> NDH_Y, <span class="dt">colour =</span> plotorder), <span class="dt">size=</span><span class="dv">2</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb43-4" data-line-number="4"><span class="st">  </span><span class="kw">scale_color_aaas</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb43-5" data-line-number="5"><span class="st">  </span><span class="kw">theme_light</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb43-6" data-line-number="6"><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="st">&quot;molar ratio&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb43-7" data-line-number="7"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="st">&quot;DQ: kcal/mol&quot;</span>) </a>
<a class="sourceLine" id="cb43-8" data-line-number="8">  <span class="co">#theme(legend.position=&quot;none&quot;) </span></a>
<a class="sourceLine" id="cb43-9" data-line-number="9">  <span class="co">#facet_grid(. ~ cell_corr)</span></a>
<a class="sourceLine" id="cb43-10" data-line-number="10">  <span class="kw">print</span>(itc_fit_ggplot)</a></code></pre></div>
<p><img src="index_files/figure-html/plot2-1.png" width="672" /></p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb44-1" data-line-number="1"><span class="kw">ggsave</span>(<span class="st">&quot;./itc_fit_ggplot.jpeg&quot;</span>, <span class="dt">device =</span> <span class="st">&quot;jpeg&quot;</span>, <span class="dt">width =</span> <span class="dv">160</span>, <span class="dt">height =</span> <span class="dv">110</span>, <span class="dt">units =</span> <span class="kw">c</span>(<span class="st">&quot;mm&quot;</span>))</a>
<a class="sourceLine" id="cb44-2" data-line-number="2"><span class="co">#ggsave(&quot;./itc_fit_ggplot.ps&quot;, device = &quot;ps&quot;, width = 160, height = 110, units = c(&quot;mm&quot;))</span></a></code></pre></div>
<div id="plot2Caption" class="figure-box">
<p>Binding isotherms used for Figure 3C in ms.</p>
</div>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb45-1" data-line-number="1">itc_combplot &lt;-<span class="st"> </span>ggpubr<span class="op">::</span><span class="kw">ggarrange</span>(itc_ggplot, itc_fit_ggplot, <span class="dt">nrow =</span> <span class="dv">2</span>, <span class="dt">ncol =</span> <span class="dv">1</span>, <span class="dt">heights =</span> <span class="kw">c</span>(<span class="fl">1.2</span>,<span class="fl">0.8</span>))</a>
<a class="sourceLine" id="cb45-2" data-line-number="2"><span class="kw">ggsave</span>(<span class="dt">file=</span><span class="st">&quot;itc_combplot.jpeg&quot;</span>, <span class="dt">plot=</span>itc_combplot, <span class="dt">device=</span><span class="st">&quot;jpeg&quot;</span>, <span class="dt">width =</span> <span class="dv">80</span>, <span class="dt">height =</span> <span class="dv">70</span>, <span class="dt">units =</span> <span class="kw">c</span>(<span class="st">&quot;mm&quot;</span>))</a>
<a class="sourceLine" id="cb45-3" data-line-number="3"><span class="kw">ggsave</span>(<span class="dt">file=</span><span class="st">&quot;itc_combplot.ps&quot;</span>, <span class="dt">plot=</span>itc_combplot, <span class="dt">device=</span><span class="st">&quot;ps&quot;</span>, <span class="dt">width =</span> <span class="dv">80</span>, <span class="dt">height =</span> <span class="dv">70</span>, <span class="dt">units =</span> <span class="kw">c</span>(<span class="st">&quot;mm&quot;</span>))</a>
<a class="sourceLine" id="cb45-4" data-line-number="4"><span class="kw">print</span>(itc_combplot)</a></code></pre></div>
<p><img src="index_files/figure-html/itcplotsXarranged-1.png" width="672" />
::: {#itcplotsXarrangedCaption .figure-box}
The almost ready plot that was used for Figure 3C.
:::</p>
</div>
<div id="itc-raw-data-plots" class="section level2">
<h2><span class="header-section-number">2.4</span> ITC raw data plots</h2>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb46-1" data-line-number="1">itc_raw_ggplot &lt;-<span class="st"> </span>filelistdata_raw_longer.tib <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(., <span class="dt">syringe =</span> <span class="kw">str_extract</span>(filename, <span class="dt">pattern =</span> <span class="st">&quot;(NBTY1|NBVH52)&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> X, <span class="dt">y =</span> Y)) <span class="op">+</span></a>
<a class="sourceLine" id="cb46-2" data-line-number="2"><span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">size=</span><span class="fl">0.2</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb46-3" data-line-number="3"><span class="st">  </span><span class="kw">theme_light</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb46-4" data-line-number="4"><span class="st">  </span><span class="kw">scale_color_aaas</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb46-5" data-line-number="5"><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="st">&quot;time: min&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb46-6" data-line-number="6"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="st">&quot;heat/inj: ucal/s&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb46-7" data-line-number="7"><span class="st">  </span><span class="kw">facet_grid</span>(syringe<span class="op">+</span>runid <span class="op">~</span><span class="st"> </span>cell_corr, <span class="dt">scale =</span> <span class="st">&quot;free_y&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb46-8" data-line-number="8"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position=</span><span class="st">&quot;none&quot;</span>)</a>
<a class="sourceLine" id="cb46-9" data-line-number="9">  <span class="kw">print</span>(itc_raw_ggplot)</a></code></pre></div>
<p><img src="index_files/figure-html/plot5-1.png" width="672" /></p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb47-1" data-line-number="1">  <span class="kw">ggsave</span>(<span class="st">&quot;./itc_raw_ggplot.jpeg&quot;</span>, <span class="dt">device =</span> <span class="st">&quot;jpeg&quot;</span>,<span class="dt">width =</span> <span class="dv">120</span>, <span class="dt">height =</span> <span class="dv">90</span>, <span class="dt">units =</span> <span class="kw">c</span>(<span class="st">&quot;mm&quot;</span>))</a>
<a class="sourceLine" id="cb47-2" data-line-number="2">  <span class="kw">ggsave</span>(<span class="st">&quot;./itc_raw_ggplot.ps&quot;</span>, <span class="dt">device =</span> <span class="st">&quot;ps&quot;</span>,<span class="dt">width =</span> <span class="dv">120</span>, <span class="dt">height =</span> <span class="dv">90</span>, <span class="dt">units =</span> <span class="kw">c</span>(<span class="st">&quot;mm&quot;</span>))</a></code></pre></div>
<div id="plot4Caption" class="figure-box">
<p>Raw data that were used for the analysis and extraction of binding parameters. Not shown in ms.</p>
</div>
<p>Plots were saved as postscript files, and edited into publication-quality figures using Adobe Illustrator.</p>
<p>I am not a programmer, and this is most probably not efficient code, but the code was useful for data analysis and produced hopefully some understandable and visually appealing figures. If you spot errors please drop me a mail.</p>
<p>Note that the <code>echo = FALSE</code> parameter was added to the code chunk to prevent printing of the R code that generated the plot.</p>
</div>
</div>
<div id="references" class="section level1">
<h1><span class="header-section-number">3</span> References</h1>

<div id="refs" class="references">
<div id="ref-gadagkar_computational_2015">
<p>Gadagkar, Sudhindra R., and Gerald B. Call. 2015. “Computational Tools for Fitting the Hill Equation to Dose–Response Curves.” <em>Journal of Pharmacological and Toxicological Methods</em> 71 (January): 68–76. <a href="https://doi.org/10.1016/j.vascn.2014.08.006">https://doi.org/10.1016/j.vascn.2014.08.006</a>.</p>
</div>
<div id="ref-gorshkova_bayesian_2008">
<p>Gorshkova, Inna I., Juraj Svitel, Faezeh Razjouyan, and Peter Schuck. 2008. “Bayesian Analysis of Heterogeneity in the Distribution of Binding Properties of Immobilized Surface Sites.” <em>Langmuir : The ACS Journal of Surfaces and Colloids</em> 24 (20): 11577–86. <a href="https://doi.org/10.1021/la801186w">https://doi.org/10.1021/la801186w</a>.</p>
</div>
<div id="ref-van_der_merwe_surface_2003">
<p>Merwe, P.A. van der. 2003. “Surface Plasmon Resonance.” <a href="users.path.ox.ac.uk/~vdmerwe/internal/spr.pdf">users.path.ox.ac.uk/~vdmerwe/internal/spr.pdf</a>.</p>
</div>
<div id="ref-oshannessy_interpretation_1996">
<p>O’Shannessy, D J, and D J Winzor. 1996. “Interpretation of Deviations from Pseudo-First-Order Kinetic Behavior in the Characterization of Ligand Binding by Biosensor Technology.” <em>Analytical Biochemistry</em> 236 (2): 275–83. <a href="https://doi.org/10.1006/abio.1996.0167">https://doi.org/10.1006/abio.1996.0167</a>.</p>
</div>
<div id="ref-svitel_combined_2003">
<p>Svitel, Juraj, Andrea Balbo, Roy A Mariuzza, Noreen R Gonzales, and Peter Schuck. 2003. “Combined Affinity and Rate Constant Distributions of Ligand Populations from Experimental Surface Binding Kinetics and Equilibria.” <em>Biophysical Journal</em> 84 (6): 4062–77. <a href="https://doi.org/10.1016/S0006-3495(03)75132-7">https://doi.org/10.1016/S0006-3495(03)75132-7</a>.</p>
</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>


    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
